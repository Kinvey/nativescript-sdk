/**
 * kinvey-nativescript-sdk - Kinvey NativeScript SDK for developing NativeScript applications.
 * @version v3.11.0
 * @author Kinvey, Inc.
 * @link http://www.kinvey.com
 * @license Apache-2.0
 */
module.exports=function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=492)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseError=n;function n(e,t,r,n){this.name="BaseError";this.message=e||"An error occurred.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}n.prototype=Object.create(Error.prototype);n.prototype.constructor=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(213);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(214);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(215);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(216);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(217);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(0);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})});var c=r(218);Object.keys(c).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return c[e]}})});var f=r(219);Object.keys(f).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return f[e]}})});var l=r(220);Object.keys(l).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return l[e]}})});var h=r(221);Object.keys(h).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return h[e]}})});var d=r(222);Object.keys(d).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return d[e]}})});var p=r(223);Object.keys(p).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return p[e]}})});var v=r(224);Object.keys(v).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return v[e]}})});var y=r(225);Object.keys(y).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return y[e]}})});var b=r(226);Object.keys(b).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return b[e]}})});var _=r(227);Object.keys(_).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return _[e]}})});var g=r(228);Object.keys(g).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return g[e]}})});var m=r(229);Object.keys(m).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return m[e]}})});var w=r(230);Object.keys(w).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return w[e]}})});var O=r(231);Object.keys(O).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return O[e]}})});var k=r(232);Object.keys(k).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return k[e]}})});var P=r(233);Object.keys(P).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return P[e]}})});var E=r(234);Object.keys(E).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return E[e]}})});var j=r(235);Object.keys(j).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return j[e]}})});var S=r(236);Object.keys(S).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return S[e]}})});var C=r(237);Object.keys(C).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return C[e]}})});var M=r(238);Object.keys(M).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return M[e]}})});var T=r(239);Object.keys(T).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return T[e]}})});var A=r(240);Object.keys(A).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return A[e]}})});var x=r(241);Object.keys(x).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return x[e]}})});var R=r(242);Object.keys(R).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return R[e]}})});var I=r(243);Object.keys(I).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return I[e]}})});var N=r(244);Object.keys(N).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return N[e]}})});var D=r(245);Object.keys(D).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return D[e]}})});var q=r(246);Object.keys(q).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return q[e]}})});var U=r(247);Object.keys(U).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return U[e]}})});var K=r(248);Object.keys(K).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return K[e]}})});var L=r(249);Object.keys(L).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return L[e]}})});var F=r(250);Object.keys(F).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return F[e]}})});var B=r(251);Object.keys(B).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return B[e]}})})},function(e,t,r){(function(t,n){var i;(function(t,r){true?e.exports=r():typeof define==="function"&&define.amd?define(r):t.ES6Promise=r()})(this,function(){"use strict";function e(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function o(e){return typeof e==="function"}var u=undefined;if(Array.isArray){u=Array.isArray}else{u=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}var a=u;var s=0;var c=undefined;var f=undefined;var l=function e(t,r){P[s]=t;P[s+1]=r;s+=2;if(s===2){if(f){f(E)}else{S()}}};function h(e){f=e}function d(e){l=e}var p=typeof window!=="undefined"?window:undefined;var v=p||{};var y=v.MutationObserver||v.WebKitMutationObserver;var b=typeof self==="undefined"&&typeof t!=="undefined"&&{}.toString.call(t)==="[object process]";var _=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function g(){return function(){return t.nextTick(E)}}function m(){if(typeof c!=="undefined"){return function(){c(E)}}return k()}function w(){var e=0;var t=new y(E);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function O(){var e=new MessageChannel;e.port1.onmessage=E;return function(){return e.port2.postMessage(0)}}function k(){var e=setTimeout;return function(){return e(E,1)}}var P=new Array(1e3);function E(){for(var e=0;e<s;e+=2){var t=P[e];var r=P[e+1];t(r);P[e]=undefined;P[e+1]=undefined}s=0}function j(){try{var e=i;var t=r(170);c=t.runOnLoop||t.runOnContext;return m()}catch(e){return k()}}var S=undefined;if(b){S=g()}else if(y){S=w()}else if(_){S=O()}else if(p===undefined&&"function"==="function"){S=j()}else{S=k()}function C(e,t){var r=arguments;var n=this;var i=new this.constructor(A);if(i[T]===undefined){re(i)}var o=n._state;if(o){(function(){var e=r[o-1];l(function(){return X(o,i,e,n._result)})})()}else{V(n,i,e,t)}return i}function M(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var r=new t(A);G(r,e);return r}var T=Math.random().toString(36).substring(16);function A(){}var x=void 0;var R=1;var I=2;var N=new W;function D(){return new TypeError("You cannot resolve a promise with itself")}function q(){return new TypeError("A promises callback cannot return that same promise.")}function U(e){try{return e.then}catch(e){N.error=e;return N}}function K(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function L(e,t,r){l(function(e){var n=false;var i=K(r,t,function(r){if(n){return}n=true;if(t!==r){G(e,r)}else{z(e,r)}},function(t){if(n){return}n=true;Q(e,t)},"Settle: "+(e._label||" unknown promise"));if(!n&&i){n=true;Q(e,i)}},e)}function F(e,t){if(t._state===R){z(e,t._result)}else if(t._state===I){Q(e,t._result)}else{V(t,undefined,function(t){return G(e,t)},function(t){return Q(e,t)})}}function B(e,t,r){if(t.constructor===e.constructor&&r===C&&t.constructor.resolve===M){F(e,t)}else{if(r===N){Q(e,N.error);N.error=null}else if(r===undefined){z(e,t)}else if(o(r)){L(e,t,r)}else{z(e,t)}}}function G(t,r){if(t===r){Q(t,D())}else if(e(r)){B(t,r,U(r))}else{z(t,r)}}function H(e){if(e._onerror){e._onerror(e._result)}$(e)}function z(e,t){if(e._state!==x){return}e._result=t;e._state=R;if(e._subscribers.length!==0){l($,e)}}function Q(e,t){if(e._state!==x){return}e._state=I;e._result=t;l(H,e)}function V(e,t,r,n){var i=e._subscribers;var o=i.length;e._onerror=null;i[o]=t;i[o+R]=r;i[o+I]=n;if(o===0&&e._state){l($,e)}}function $(e){var t=e._subscribers;var r=e._state;if(t.length===0){return}var n=undefined,i=undefined,o=e._result;for(var u=0;u<t.length;u+=3){n=t[u];i=t[u+r];if(n){X(r,n,i,o)}else{i(o)}}e._subscribers.length=0}function W(){this.error=null}var Y=new W;function J(e,t){try{return e(t)}catch(e){Y.error=e;return Y}}function X(e,t,r,n){var i=o(r),u=undefined,a=undefined,s=undefined,c=undefined;if(i){u=J(r,n);if(u===Y){c=true;a=u.error;u.error=null}else{s=true}if(t===u){Q(t,q());return}}else{u=n;s=true}if(t._state!==x){}else if(i&&s){G(t,u)}else if(c){Q(t,a)}else if(e===R){z(t,u)}else if(e===I){Q(t,u)}}function Z(e,t){try{t(function t(r){G(e,r)},function t(r){Q(e,r)})}catch(t){Q(e,t)}}var ee=0;function te(){return ee++}function re(e){e[T]=ee++;e._state=undefined;e._result=undefined;e._subscribers=[]}function ne(e,t){this._instanceConstructor=e;this.promise=new e(A);if(!this.promise[T]){re(this.promise)}if(a(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){z(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0){z(this.promise,this._result)}}}else{Q(this.promise,ie())}}function ie(){return new Error("Array Methods must be provided an Array")}ne.prototype._enumerate=function(e){for(var t=0;this._state===x&&t<e.length;t++){this._eachEntry(e[t],t)}};ne.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;var n=r.resolve;if(n===M){var i=U(e);if(i===C&&e._state!==x){this._settledAt(e._state,t,e._result)}else if(typeof i!=="function"){this._remaining--;this._result[t]=e}else if(r===fe){var o=new r(A);B(o,e,i);this._willSettleAt(o,t)}else{this._willSettleAt(new r(function(t){return t(e)}),t)}}else{this._willSettleAt(n(e),t)}};ne.prototype._settledAt=function(e,t,r){var n=this.promise;if(n._state===x){this._remaining--;if(e===I){Q(n,r)}else{this._result[t]=r}}if(this._remaining===0){z(n,this._result)}};ne.prototype._willSettleAt=function(e,t){var r=this;V(e,undefined,function(e){return r._settledAt(R,t,e)},function(e){return r._settledAt(I,t,e)})};function oe(e){return new ne(this,e).promise}function ue(e){var t=this;if(!a(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(r,n){var i=e.length;for(var o=0;o<i;o++){t.resolve(e[o]).then(r,n)}})}}function ae(e){var t=this;var r=new t(A);Q(r,e);return r}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ce(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function fe(e){this[T]=te();this._result=this._state=undefined;this._subscribers=[];if(A!==e){typeof e!=="function"&&se();this instanceof fe?Z(this,e):ce()}}fe.all=oe;fe.race=ue;fe.resolve=M;fe.reject=ae;fe._setScheduler=h;fe._setAsap=d;fe._asap=l;fe.prototype={constructor:fe,then:C,catch:function e(t){return this.then(null,t)}};function le(){var e=undefined;if(typeof n!=="undefined"){e=n}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(r==="[object Promise]"&&!t.cast){return}}e.Promise=fe}fe.polyfill=le;fe.Promise=fe;return fe})}).call(t,r(169),r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(106);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(107);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(389);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(390);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(108);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})})},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"};e.exports=t["default"]},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Client=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(256);var o=_(i);var u=r(20);var a=_(u);var s=r(10);var c=_(s);var f=r(30);var l=_(f);var h=r(257);var d=_(h);var p=r(1);var v=r(22);var y=r(3);var b=r(31);function _(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var m=6e4;var w="active_user";var O=null;var k=function(){function e(){g(this,e);this.memory=new o.default}n(e,[{key:"get",value:function e(t){if(!(0,c.default)(t)){throw new p.KinveyError("ActiveUserStorage key must be a string.")}try{return JSON.parse(this.memory.get(t))}catch(e){return null}}},{key:"set",value:function e(t,r){if(!(0,c.default)(t)){throw new p.KinveyError("ActiveUserStorage key must be a string.")}if((0,y.isDefined)(r)){this.memory.set(t,JSON.stringify(r))}else{this.memory.delete(t)}return r}}]);return e}();var P=t.Client=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};g(this,e);var r="https://baas.kinvey.com";var n="https://auth.kinvey.com";if(t.instanceId){var i=t.instanceId;if(!(0,c.default)(i)){throw new p.KinveyError("Instance ID must be a string.")}r="https://"+i+"-baas.kinvey.com";n="https://"+i+"-auth.kinvey.com"}else{if((0,c.default)(t.apiHostname)){r=/^https?:\/\//i.test(t.apiHostname)?t.apiHostname:"https://"+t.apiHostname}if((0,c.default)(t.micHostname)){n=/^https?:\/\//i.test(t.micHostname)?t.micHostname:"https://"+t.micHostname}}var o=a.default.parse(r);var u=a.default.parse(n);this.deviceId=(0,y.uuidv4)();this.apiProtocol=o.protocol;this.apiHost=o.host;this.micProtocol=u.protocol;this.micHost=u.host;this.appKey=t.appKey;this.appSecret=t.appSecret;this.masterSecret=t.masterSecret;this.encryptionKey=t.encryptionKey;this.appVersion=t.appVersion;this.defaultTimeout=(0,l.default)(t.defaultTimeout)&&t.defaultTimeout>=0?t.defaultTimeout:m;this.activeUserStorage=new k;this.storage=t.storage||b.StorageProvider.Memory}n(e,[{key:"getActiveUser",value:function e(){return this.activeUserStorage.get(this.appKey+"."+w)}},{key:"setActiveUser",value:function e(t){return this.activeUserStorage.set(this.appKey+"."+w,t)}},{key:"toPlainObject",value:function e(){return{deviceId:this.deviceId,apiHostname:this.apiHostname,apiProtocol:this.apiProtocol,apiHost:this.apiHost,micHostname:this.micHostname,micProtocol:this.micProtocol,micHost:this.micHost,appKey:this.appKey,appSecret:this.appSecret,masterSecret:this.masterSecret,encryptionKey:this.encryptionKey,appVersion:this.appVersion,storage:this.storage}}},{key:"apiHostname",get:function e(){return a.default.format({protocol:this.apiProtocol,host:this.apiHost})}},{key:"micHostname",get:function e(){return a.default.format({protocol:this.micProtocol,host:this.micHost})}},{key:"appVersion",get:function e(){return this._appVersion},set:function e(t){if(t&&!(0,c.default)(t)){t=String(t)}this._appVersion=t}},{key:"defaultTimeout",get:function e(){return this._defaultTimeout},set:function e(t){t=parseInt(t,10);if((0,l.default)(t)===false||(0,d.default)(t)){throw new p.KinveyError("Invalid timeout. Timeout must be a number.")}if(t<0){v.Log.info("Default timeout is less than 0. Setting default timeout to "+this.defaultTimeout+"ms.");t=this.defaultTimeout}this._defaultTimeout=t}},{key:"storage",get:function e(){return this._storage},set:function e(t){if(!(0,y.isValidStorageProviderValue)(t)){throw new p.KinveyError("Please provide a valid set of supported storage providers for this platform")}this._storage=t}}],[{key:"initialize",value:function e(){throw new p.KinveyError("Please use Client.init().")}},{key:"init",value:function t(r){O=new e(r);return O}},{key:"sharedInstance",value:function e(){if((0,y.isDefined)(O)===false){throw new p.KinveyError("You have not initialized the library. "+"Please call Kinvey.init() to initialize the library.")}return O}}]);return e}()},function(e,t,r){"use strict";function n(e){var t=[];Object.keys(e).forEach(function(e){return t.push(e)});return t}function i(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(e){return n(e).sort()}function u(e){var t=o(e);return t.map(function(t){return t+"="+i(e[t])}).join("&")}function a(e,t){return e.indexOf(t,this.length-t.length)!==-1}function s(){var e=void 0;var t=void 0;var r=new Promise(function(r,n){e=r;t=n});return{promise:r,reject:t,fulfill:e}}e.exports={signPamFromParams:u,endsWith:a,createPromise:s,encodeString:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(42);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(393);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(153);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(90);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(154);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(155);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})})},function(e,t,r){var n=r(19),i=r(6),o=r(14);var u="[object String]";function a(e){return typeof e=="string"||!i(e)&&o(e)&&n(e)==u}e.exports=a},function(e,t){function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}e.exports=r},function(e,t,r){var n=r(61),i=r(27),o=r(117),u=r(24),a=r(32),s=r(21);var c=Object.prototype;var f=c.hasOwnProperty;var l=o(function(e,t){if(a(t)||u(t)){i(t,s(t),e);return}for(var r in t){if(f.call(t,r)){n(e,r,t[r])}}});e.exports=l},function(e,t,r){var n=r(98);var i=typeof self=="object"&&self&&self.Object===Object&&self;var o=n||i||Function("return this")();e.exports=o},function(e,t){function r(e){return e!=null&&typeof e=="object"}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Query=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(252);var u=p(o);var a=r(33);var s=p(a);var c=r(119);var f=p(c);var l=r(1);var h=r(3);var d=r(22);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var y=["_id","_acl"];var b=["$nearSphere"];var _=function(){function e(t){v(this,e);t=(0,f.default)(t,{fields:[],filter:{},sort:null,limit:null,skip:0});this.fields=t.fields;this.filter=t.filter;this.sort=t.sort;this.limit=t.limit;this.skip=t.skip;this._parent=null}i(e,[{key:"isSupportedOffline",value:function e(){var t=this;return Object.keys(this.filter).reduce(function(e,r){if(e){var i=t.filter[r];return b.some(function(e){if(!i){return true}if((typeof i==="undefined"?"undefined":n(i))!=="object"){return true}return!Object.keys(i).some(function(t){return t===e})})}return e},true)}},{key:"hasSkip",value:function e(){return(0,h.isNumber)(this.skip)&&this.skip>0}},{key:"hasLimit",value:function e(){return(0,h.isNumber)(this.limit)}},{key:"equalTo",value:function e(t,r){return this.addFilter(t,r)}},{key:"contains",value:function e(t,r){if((0,h.isDefined)(r)===false){throw new l.QueryError("You must supply a value.")}if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$in",r)}},{key:"containsAll",value:function e(t,r){if((0,h.isDefined)(r)===false){throw new l.QueryError("You must supply a value.")}if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$all",r)}},{key:"greaterThan",value:function e(t,r){if((0,h.isNumber)(r)===false&&typeof r!=="string"){throw new l.QueryError("You must supply a number or string.")}return this.addFilter(t,"$gt",r)}},{key:"greaterThanOrEqualTo",value:function e(t,r){if((0,h.isNumber)(r)===false&&typeof r!=="string"){throw new l.QueryError("You must supply a number or string.")}return this.addFilter(t,"$gte",r)}},{key:"lessThan",value:function e(t,r){if((0,h.isNumber)(r)===false&&typeof r!=="string"){throw new l.QueryError("You must supply a number or string.")}return this.addFilter(t,"$lt",r)}},{key:"lessThanOrEqualTo",value:function e(t,r){if((0,h.isNumber)(r)===false&&typeof r!=="string"){throw new l.QueryError("You must supply a number or string.")}return this.addFilter(t,"$lte",r)}},{key:"notEqualTo",value:function e(t,r){return this.addFilter(t,"$ne",r)}},{key:"notContainedIn",value:function e(t,r){if(Array.isArray(r)===false){r=[r]}return this.addFilter(t,"$nin",r)}},{key:"and",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}return this.join("$and",r)}},{key:"nor",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}if((0,h.isDefined)(this._parent)&&Object.hasOwnProperty.call(this._parent.filter,"$and")){var i;return(i=this._parent).nor.apply(i,r)}return this.join("$nor",r)}},{key:"or",value:function e(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++){r[n]=arguments[n]}if((0,h.isDefined)(this._parent)){var i;return(i=this._parent).or.apply(i,r)}return this.join("$or",r)}},{key:"exists",value:function e(t,r){r=typeof r==="undefined"?true:r||false;return this.addFilter(t,"$exists",r)}},{key:"mod",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(typeof r==="string"){r=parseFloat(r)}if(typeof n==="string"){n=parseFloat(n)}if(!(0,h.isNumber)(r)){throw new l.QueryError("divisor must be a number")}if(!(0,h.isNumber)(n)){throw new l.QueryError("remainder must be a number")}return this.addFilter(t,"$mod",[r,n])}},{key:"matches",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=[];if(!(r instanceof RegExp)){r=new RegExp(r)}if(r.source.indexOf("^")!==0){throw new l.QueryError("regExp must have '^' at the beginning of the expression"+" to make it an anchored expression.")}if((r.ignoreCase||n.ignoreCase)&&n.ignoreCase!==false){throw new l.QueryError("ignoreCase flag is not supported")}if((r.multiline||n.multiline)&&n.multiline!==false){i.push("m")}if(n.extended===true){i.push("x")}if(n.dotMatchesAll===true){i.push("s")}if(i.length>0){this.addFilter(t,"$options",i.join(""))}return this.addFilter(t,"$regex",r.source)}},{key:"near",value:function e(t,r,n){if(!Array.isArray(r)||!(0,h.isNumber)(r[0])||!(0,h.isNumber)(r[1])){throw new l.QueryError("coord must be a [number, number]")}var i=this.addFilter(t,"$nearSphere",[r[0],r[1]]);if((0,h.isNumber)(n)){this.addFilter(t,"$maxDistance",n)}return i}},{key:"withinBox",value:function e(t,r,n){if(!Array.isArray(r)||!(0,h.isNumber)(r[0])||!(0,h.isNumber)(r[1])){throw new l.QueryError("bottomLeftCoord must be a [number, number]")}if(!Array.isArray(n)||!(0,h.isNumber)(n[0])||!(0,h.isNumber)(n[1])){throw new l.QueryError("upperRightCoord must be a [number, number]")}r[0]=parseFloat(r[0]);r[1]=parseFloat(r[1]);n[0]=parseFloat(n[0]);n[1]=parseFloat(n[1]);var i=[[r[0],r[1]],[n[0],n[1]]];return this.addFilter(t,"$within",{$box:i})}},{key:"withinPolygon",value:function e(t,r){if(Array.isArray(r)===false||r.length===0||r.length>3){throw new l.QueryError("coords must be a [[number, number]]")}r=r.map(function(e){if((0,h.isNumber)(e[0])===false||(0,h.isNumber)(e[1])===false){throw new l.QueryError("coords argument must be a [number, number]")}return[parseFloat(e[0]),parseFloat(e[1])]});return this.addFilter(t,"$within",{$polygon:r})}},{key:"size",value:function e(t,r){if(typeof r==="string"){r=parseFloat(r)}if(!(0,h.isNumber)(r)){throw new l.QueryError("size must be a number")}return this.addFilter(t,"$size",r)}},{key:"ascending",value:function e(t){if((0,h.isDefined)(this._parent)){this._parent.ascending(t)}else{this.sort[t]=1}return this}},{key:"descending",value:function e(t){if((0,h.isDefined)(this._parent)){this._parent.descending(t)}else{this.sort[t]=-1}return this}},{key:"addFilter",value:function e(t,r,n){if((0,h.isDefined)(r)&&((0,h.isDefined)(n)||arguments.length===3)){if(!(0,s.default)(this.filter[t])){this.filter[t]={}}this.filter[t][r]=n}else{this.filter[t]=r}return this}},{key:"join",value:function t(r,n){var i=this;var o=this;var u={};n=n.map(function(t){if(!(t instanceof e)){if((0,s.default)(t)){t=new e(t)}else{throw new l.QueryError("query argument must be of type: Kinvey.Query[] or Object[].")}}return t.toPlainObject().filter});if(n.length===0){o=new e;n=[o.toPlainObject().filter];o._parent=this}var a=Object.keys(this.filter);a.forEach(function(e){u[e]=i.filter[e];delete i.filter[e]});this.filter[r]=[u].concat(n);return o}},{key:"process",value:function e(t){if(!this.isSupportedOffline()){var r="This query is not able to run locally. The following filters are not supported"+" locally:";b.forEach(function(e){r=r+" "+e});d.Log.error(r);throw new l.QueryError(r)}if(!Array.isArray(t)){throw new l.QueryError("data argument must be of type: Array.")}d.Log.debug("Data length before processiong query",t.length);var n=this.toPlainObject();t=(0,u.default)(n.filter,t);d.Log.debug("Data length after applying query filter",n.filter,t.length);if((0,h.isDefined)(n.sort)){d.Log.debug("Sorting data",n.sort);t.sort(function(e,t){for(var r in n.sort){if(n.sort.hasOwnProperty(r)){var i=(0,h.nested)(e,r);var o=(0,h.nested)(t,r);var u=n.sort[r];if((0,h.isDefined)(i)&&(0,h.isDefined)(o)===false){return 1*u}else if((0,h.isDefined)(i)===false&&(0,h.isDefined)(o)){return-1*u}else if(typeof i==="undefined"&&o===null){return 0}else if(i===null&&typeof o==="undefined"){return 0}else if(i!==o){return(i<o?-1:1)*u}}}return 0})}if(Array.isArray(n.fields)&&n.fields.length>0){var i=[].concat(n.fields,y);d.Log.debug("Removing fields from data",n.fields);t=t.map(function(e){var t=Object.keys(e);t.forEach(function(t){if(i.indexOf(t)===-1){delete e[t]}});return e})}if((0,h.isNumber)(n.skip)){if((0,h.isNumber)(n.limit)&&n.limit>0){d.Log.debug("Skipping and limiting data",n.skip,n.limit);return t.slice(n.skip,n.skip+n.limit)}d.Log.debug("Skipping data",n.skip);return t.slice(n.skip)}return t}},{key:"toPlainObject",value:function e(){if((0,h.isDefined)(this._parent)){return this._parent.toPlainObject()}var t={fields:this.fields,filter:this.filter,sort:this.sort,skip:this.skip,limit:this.limit};return t}},{key:"toQueryString",value:function e(){var t={};if(Object.keys(this.filter).length>0){t.query=this.filter}if(this.fields.length>0){t.fields=this.fields.join(",")}if((0,h.isNumber)(this.limit)){t.limit=this.limit}if((0,h.isNumber)(this.skip)&&this.skip>0){t.skip=this.skip}if(Object.keys(this.sort).length>0){t.sort=this.sort}var r=Object.keys(t);r.forEach(function(e){t[e]=typeof t[e]==="string"?t[e]:JSON.stringify(t[e])});return t}},{key:"toString",value:function e(){return JSON.stringify(this.toQueryString())}},{key:"fields",get:function e(){return this._fields},set:function e(t){t=t||[];if(!Array.isArray(t)){throw new l.QueryError("fields must be an Array")}if((0,h.isDefined)(this._parent)){this._parent.fields=t}else{this._fields=t}}},{key:"filter",get:function e(){return this._filter},set:function e(t){this._filter=t}},{key:"sort",get:function e(){return this._sort},set:function e(t){if(t&&!(0,s.default)(t)){throw new l.QueryError("sort must an Object")}if((0,h.isDefined)(this._parent)){this._parent.sort=t}else{this._sort=t||{}}}},{key:"limit",get:function e(){return this._limit},set:function e(t){if(typeof t==="string"){t=parseFloat(t)}if((0,h.isDefined)(t)&&(0,h.isNumber)(t)===false){throw new l.QueryError("limit must be a number")}if(this._parent){this._parent.limit=t}else{this._limit=t}}},{key:"skip",get:function e(){return this._skip},set:function e(t){if(typeof t==="string"){t=parseFloat(t)}if((0,h.isNumber)(t)===false){throw new l.QueryError("skip must be a number")}if((0,h.isDefined)(this._parent)){this._parent.skip=t}else{this._skip=t}}}]);return e}();t.Query=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(374);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(375);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(87);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(137);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(138);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(141);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(383);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(140);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})})},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t,r){var n=r(29),i=r(171),o=r(172);var u="[object Null]",a="[object Undefined]";var s=n?n.toStringTag:undefined;function c(e){if(e==null){return e===undefined?a:u}return s&&s in Object(e)?i(e):o(e)}e.exports=c},function(e,t,r){"use strict";var n=r(173);var i=r(174);t.parse=w;t.resolve=k;t.resolveObject=P;t.format=O;t.Url=o;function o(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var u=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(c),l=["'"].concat(f),h=["%","/","?",";","#"].concat(l),d=["/","?","#"],p=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:true,"javascript:":true},_={javascript:true,"javascript:":true},g={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},m=r(175);function w(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;n.parse(e,t,r);return n}o.prototype.parse=function(e,t,r){if(!i.isString(e)){throw new TypeError("Parameter 'url' must be a string, not "+typeof e)}var o=e.indexOf("?"),a=o!==-1&&o<e.indexOf("#")?"?":"#",c=e.split(a),f=/\\/g;c[0]=c[0].replace(f,"/");e=c.join(a);var w=e;w=w.trim();if(!r&&e.split("#").length===1){var O=s.exec(w);if(O){this.path=w;this.href=w;this.pathname=O[1];if(O[2]){this.search=O[2];if(t){this.query=m.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(t){this.search="";this.query={}}return this}}var k=u.exec(w);if(k){k=k[0];var P=k.toLowerCase();this.protocol=P;w=w.substr(k.length)}if(r||k||w.match(/^\/\/[^@\/]+@[^@\/]+/)){var E=w.substr(0,2)==="//";if(E&&!(k&&_[k])){w=w.substr(2);this.slashes=true}}if(!_[k]&&(E||k&&!g[k])){var j=-1;for(var S=0;S<d.length;S++){var C=w.indexOf(d[S]);if(C!==-1&&(j===-1||C<j))j=C}var M,T;if(j===-1){T=w.lastIndexOf("@")}else{T=w.lastIndexOf("@",j)}if(T!==-1){M=w.slice(0,T);w=w.slice(T+1);this.auth=decodeURIComponent(M)}j=-1;for(var S=0;S<h.length;S++){var C=w.indexOf(h[S]);if(C!==-1&&(j===-1||C<j))j=C}if(j===-1)j=w.length;this.host=w.slice(0,j);w=w.slice(j);this.parseHost();this.hostname=this.hostname||"";var A=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!A){var x=this.hostname.split(/\./);for(var S=0,R=x.length;S<R;S++){var I=x[S];if(!I)continue;if(!I.match(v)){var N="";for(var D=0,q=I.length;D<q;D++){if(I.charCodeAt(D)>127){N+="x"}else{N+=I[D]}}if(!N.match(v)){var U=x.slice(0,S);var K=x.slice(S+1);var L=I.match(y);if(L){U.push(L[1]);K.unshift(L[2])}if(K.length){w="/"+K.join(".")+w}this.hostname=U.join(".");break}}}}if(this.hostname.length>p){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!A){this.hostname=n.toASCII(this.hostname)}var F=this.port?":"+this.port:"";var B=this.hostname||"";this.host=B+F;this.href+=this.host;if(A){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(w[0]!=="/"){w="/"+w}}}if(!b[P]){for(var S=0,R=l.length;S<R;S++){var G=l[S];if(w.indexOf(G)===-1)continue;var H=encodeURIComponent(G);if(H===G){H=escape(G)}w=w.split(G).join(H)}}var z=w.indexOf("#");if(z!==-1){this.hash=w.substr(z);w=w.slice(0,z)}var Q=w.indexOf("?");if(Q!==-1){this.search=w.substr(Q);this.query=w.substr(Q+1);if(t){this.query=m.parse(this.query)}w=w.slice(0,Q)}else if(t){this.search="";this.query={}}if(w)this.pathname=w;if(g[P]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var F=this.pathname||"";var V=this.search||"";this.path=F+V}this.href=this.format();return this};function O(e){if(i.isString(e))e=w(e);if(!(e instanceof o))return o.prototype.format.call(e);return e.format()}o.prototype.format=function(){var e=this.auth||"";if(e){e=encodeURIComponent(e);e=e.replace(/%3A/i,":");e+="@"}var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=false,u="";if(this.host){o=e+this.host}else if(this.hostname){o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){o+=":"+this.port}}if(this.query&&i.isObject(this.query)&&Object.keys(this.query).length){u=m.stringify(this.query)}var a=this.search||u&&"?"+u||"";if(t&&t.substr(-1)!==":")t+=":";if(this.slashes||(!t||g[t])&&o!==false){o="//"+(o||"");if(r&&r.charAt(0)!=="/")r="/"+r}else if(!o){o=""}if(n&&n.charAt(0)!=="#")n="#"+n;if(a&&a.charAt(0)!=="?")a="?"+a;r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)});a=a.replace("#","%23");return t+o+r+a+n};function k(e,t){return w(e,false,true).resolve(t)}o.prototype.resolve=function(e){return this.resolveObject(w(e,false,true)).format()};function P(e,t){if(!e)return t;return w(e,false,true).resolveObject(t)}o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,false,true);e=t}var r=new o;var n=Object.keys(this);for(var u=0;u<n.length;u++){var a=n[u];r[a]=this[a]}r.hash=e.hash;if(e.href===""){r.href=r.format();return r}if(e.slashes&&!e.protocol){var s=Object.keys(e);for(var c=0;c<s.length;c++){var f=s[c];if(f!=="protocol")r[f]=e[f]}if(g[r.protocol]&&r.hostname&&!r.pathname){r.path=r.pathname="/"}r.href=r.format();return r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){var l=Object.keys(e);for(var h=0;h<l.length;h++){var d=l[h];r[d]=e[d]}r.href=r.format();return r}r.protocol=e.protocol;if(!e.host&&!_[e.protocol]){var p=(e.pathname||"").split("/");while(p.length&&!(e.host=p.shift()));if(!e.host)e.host="";if(!e.hostname)e.hostname="";if(p[0]!=="")p.unshift("");if(p.length<2)p.unshift("");r.pathname=p.join("/")}else{r.pathname=e.pathname}r.search=e.search;r.query=e.query;r.host=e.host||"";r.auth=e.auth;r.hostname=e.hostname||e.host;r.port=e.port;if(r.pathname||r.search){var v=r.pathname||"";var y=r.search||"";r.path=v+y}r.slashes=r.slashes||e.slashes;r.href=r.format();return r}var b=r.pathname&&r.pathname.charAt(0)==="/",m=e.host||e.pathname&&e.pathname.charAt(0)==="/",w=m||b||r.host&&e.pathname,O=w,k=r.pathname&&r.pathname.split("/")||[],p=e.pathname&&e.pathname.split("/")||[],P=r.protocol&&!g[r.protocol];if(P){r.hostname="";r.port=null;if(r.host){if(k[0]==="")k[0]=r.host;else k.unshift(r.host)}r.host="";if(e.protocol){e.hostname=null;e.port=null;if(e.host){if(p[0]==="")p[0]=e.host;else p.unshift(e.host)}e.host=null}w=w&&(p[0]===""||k[0]==="")}if(m){r.host=e.host||e.host===""?e.host:r.host;r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname;r.search=e.search;r.query=e.query;k=p}else if(p.length){if(!k)k=[];k.pop();k=k.concat(p);r.search=e.search;r.query=e.query}else if(!i.isNullOrUndefined(e.search)){if(P){r.hostname=r.host=k.shift();var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(E){r.auth=E.shift();r.host=r.hostname=E.shift()}}r.search=e.search;r.query=e.query;if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.href=r.format();return r}if(!k.length){r.pathname=null;if(r.search){r.path="/"+r.search}else{r.path=null}r.href=r.format();return r}var j=k.slice(-1)[0];var S=(r.host||e.host||k.length>1)&&(j==="."||j==="..")||j==="";var C=0;for(var M=k.length;M>=0;M--){j=k[M];if(j==="."){k.splice(M,1)}else if(j===".."){k.splice(M,1);C++}else if(C){k.splice(M,1);C--}}if(!w&&!O){for(;C--;C){k.unshift("..")}}if(w&&k[0]!==""&&(!k[0]||k[0].charAt(0)!=="/")){k.unshift("")}if(S&&k.join("/").substr(-1)!=="/"){k.push("")}var T=k[0]===""||k[0]&&k[0].charAt(0)==="/";if(P){r.hostname=r.host=T?"":k.length?k.shift():"";var E=r.host&&r.host.indexOf("@")>0?r.host.split("@"):false;if(E){r.auth=E.shift();r.host=r.hostname=E.shift()}}w=w||r.host&&k.length;if(w&&!T){k.unshift("")}if(!k.length){r.pathname=null;r.path=null}else{r.pathname=k.join("/")}if(!i.isNull(r.pathname)||!i.isNull(r.search)){r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")}r.auth=e.auth||r.auth;r.slashes=r.slashes||e.slashes;r.href=r.format();return r};o.prototype.parseHost=function(){var e=this.host;var t=a.exec(e);if(t){t=t[0];if(t!==":"){this.port=t.substr(1)}e=e.substr(0,e.length-t.length)}if(e)this.hostname=e}},function(e,t,r){var n=r(101),i=r(103),o=r(24);function u(e){return o(e)?n(e):i(e)}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Log=undefined;var n=r(255);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}i.default.setDefaultLevel(i.default.levels.SILENT);var u=i.default.methodFactory;i.default.methodFactory=function e(t,r,n){var i=u(t,r,n);return function e(t){t="Kinvey: "+t;for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++){n[o-1]=arguments[o]}if(n.length>0){i(t,n)}else{i(t)}}};t.Log=i.default},function(e,t,r){var n=r(199),i=r(202);function o(e,t){var r=i(e,t);return n(r)?r:undefined}e.exports=o},function(e,t,r){var n=r(25),i=r(67);function o(e){return e!=null&&i(e.length)&&!n(e)}e.exports=o},function(e,t,r){var n=r(19),i=r(11);var o="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function c(e){if(!i(e)){return false}var t=n(e);return t==u||t==a||t==o||t==s}e.exports=c},function(e,t,r){var n=r(103),i=r(34),o=r(59),u=r(6),a=r(24),s=r(43),c=r(32),f=r(66);var l="[object Map]",h="[object Set]";var d=Object.prototype;var p=d.hasOwnProperty;function v(e){if(e==null){return true}if(a(e)&&(u(e)||typeof e=="string"||typeof e.splice=="function"||s(e)||f(e)||o(e))){return!e.length}var t=i(e);if(t==l||t==h){return!e.size}if(c(e)){return!n(e).length}for(var r in e){if(p.call(e,r)){return false}}return true}e.exports=v},function(e,t,r){var n=r(61),i=r(75);function o(e,t,r,o){var u=!r;r||(r={});var a=-1,s=t.length;while(++a<s){var c=t[a];var f=o?o(r[c],e[c],c,r,e):undefined;if(f===undefined){f=e[c]}if(u){i(r,c,f)}else{n(r,c,f)}}return r}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(82);var o=a(i);var u=r(4);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){var r=t.setup,n=t.db;s(this,e);this._db=n;this.instanceId="pn-"+o.default.createUUID();this.secretKey=r.secretKey||r.secret_key;this.subscribeKey=r.subscribeKey||r.subscribe_key;this.publishKey=r.publishKey||r.publish_key;this.sdkName=r.sdkName;this.sdkFamily=r.sdkFamily;this.partnerId=r.partnerId;this.setAuthKey(r.authKey);this.setCipherKey(r.cipherKey);this.setFilterExpression(r.filterExpression);this.origin=r.origin||"pubsub.pndsn.com";this.secure=r.ssl||false;this.restore=r.restore||false;this.proxy=r.proxy;this.keepAlive=r.keepAlive;this.keepAliveSettings=r.keepAliveSettings;this.autoNetworkDetection=r.autoNetworkDetection||false;this.dedupeOnSubscribe=r.dedupeOnSubscribe||false;this.maximumCacheSize=r.maximumCacheSize||100;this.customEncrypt=r.customEncrypt;this.customDecrypt=r.customDecrypt;if(typeof location!=="undefined"&&location.protocol==="https:"){this.secure=true}this.logVerbosity=r.logVerbosity||false;this.suppressLeaveEvents=r.suppressLeaveEvents||false;this.announceFailedHeartbeats=r.announceFailedHeartbeats||true;this.announceSuccessfulHeartbeats=r.announceSuccessfulHeartbeats||false;this.useInstanceId=r.useInstanceId||false;this.useRequestId=r.useRequestId||false;this.requestMessageCountThreshold=r.requestMessageCountThreshold;this.setTransactionTimeout(r.transactionalRequestTimeout||15*1e3);this.setSubscribeTimeout(r.subscribeRequestTimeout||310*1e3);this.setSendBeaconConfig(r.useSendBeacon||true);this.setPresenceTimeout(r.presenceTimeout||300);if(r.heartbeatInterval!=null){this.setHeartbeatInterval(r.heartbeatInterval)}this.setUUID(this._decideUUID(r.uuid))}n(e,[{key:"getAuthKey",value:function e(){return this.authKey}},{key:"setAuthKey",value:function e(t){this.authKey=t;return this}},{key:"setCipherKey",value:function e(t){this.cipherKey=t;return this}},{key:"getUUID",value:function e(){return this.UUID}},{key:"setUUID",value:function e(t){if(this._db&&this._db.set)this._db.set(this.subscribeKey+"uuid",t);this.UUID=t;return this}},{key:"getFilterExpression",value:function e(){return this.filterExpression}},{key:"setFilterExpression",value:function e(t){this.filterExpression=t;return this}},{key:"getPresenceTimeout",value:function e(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function e(t){this._presenceTimeout=t;this.setHeartbeatInterval(this._presenceTimeout/2-1);return this}},{key:"setProxy",value:function e(t){this.proxy=t}},{key:"getHeartbeatInterval",value:function e(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function e(t){this._heartbeatInterval=t;return this}},{key:"getSubscribeTimeout",value:function e(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function e(t){this._subscribeRequestTimeout=t;return this}},{key:"getTransactionTimeout",value:function e(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function e(t){this._transactionalRequestTimeout=t;return this}},{key:"isSendBeaconEnabled",value:function e(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function e(t){this._useSendBeacon=t;return this}},{key:"getVersion",value:function e(){return"4.20.2"}},{key:"_decideUUID",value:function e(t){if(t){return t}if(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")){return this._db.get(this.subscribeKey+"uuid")}return"pn-"+o.default.createUUID()}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,r){var n=r(13);var i=n.Symbol;e.exports=i},function(e,t,r){var n=r(19),i=r(14);var o="[object Number]";function u(e){return typeof e=="number"||i(e)&&n(e)==o}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(74);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(150);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(388);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(77);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(36);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(65);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})});var c=r(37);Object.keys(c).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return c[e]}})});var f=r(17);Object.keys(f).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return f[e]}})});var l=r(57);Object.keys(l).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return l[e]}})})},function(e,t){var r=Object.prototype;function n(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||r;return e===n}e.exports=n},function(e,t,r){var n=r(19),i=r(70),o=r(14);var u="[object Object]";var a=Function.prototype,s=Object.prototype;var c=a.toString;var f=s.hasOwnProperty;var l=c.call(Object);function h(e){if(!o(e)||n(e)!=u){return false}var t=i(e);if(t===null){return true}var r=f.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&c.call(r)==l}e.exports=h},function(e,t,r){var n=r(198),i=r(73),o=r(203),u=r(204),a=r(205),s=r(19),c=r(114);var f="[object Map]",l="[object Object]",h="[object Promise]",d="[object Set]",p="[object WeakMap]";var v="[object DataView]";var y=c(n),b=c(i),_=c(o),g=c(u),m=c(a);var w=s;if(n&&w(new n(new ArrayBuffer(1)))!=v||i&&w(new i)!=f||o&&w(o.resolve())!=h||u&&w(new u)!=d||a&&w(new a)!=p){w=function(e){var t=s(e),r=t==l?e.constructor:undefined,n=r?c(r):"";if(n){switch(n){case y:return v;case b:return f;case _:return h;case g:return d;case m:return p}}return t}}e.exports=w},function(e,t){function r(e,t){return e===t||e!==e&&t!==t}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(368);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(369);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(136);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(86);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(144);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(384);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.webSqlDatabaseSize=t.webSqlCollectionsMaster=t.sqliteCollectionsMaster=t.browserStorageCollectionsMaster=t.inedxedDbTransctionMode=undefined;t.domStringListToStringArray=u;var n=r(115);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=[];(0,i.default)(e.length,function(r){t.push(e[r])});return t}var a=t.inedxedDbTransctionMode={readWrite:"readwrite",readOnly:"readonly"};var s=t.browserStorageCollectionsMaster="__master__";var c=t.sqliteCollectionsMaster="sqlite_master";var f=t.webSqlCollectionsMaster="sqlite_master";var l=t.webSqlDatabaseSize=2*1024*1024},function(e,t,r){var n=r(179),i=r(186);var o=i(n);e.exports=o},function(e,t,r){var n=r(45);var i=1/0;function o(e){if(typeof e=="string"||n(e)){return e}var t=e+"";return t=="0"&&1/e==-i?"-0":t}e.exports=o},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Headers=t.kinveyRequestStartHeader=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(99);var o=l(i);var u=r(10);var a=l(u);var s=r(33);var c=l(s);var f=r(3);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=t.kinveyRequestStartHeader="X-Kinvey-Request-Start";var p=t.Headers=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};h(this,e);this.headers={};this.addAll(t)}n(e,[{key:"get",value:function e(t){if(t){if((0,a.default)(t)===false){t=String(t)}var r=this.headers;return r[t.toLowerCase()]}return undefined}},{key:"set",value:function e(t,r){if((0,f.isDefined)(t)===false||(0,f.isDefined)(r)===false){throw new Error("A name and value must be provided to set a header.")}if((0,a.default)(t)===false){t=String(t)}var n=this.headers;t=t.toLowerCase();if((0,a.default)(r)===false){n[t]=JSON.stringify(r)}else{n[t]=r}this.headers=n;return this}},{key:"has",value:function e(t){return!!this.get(t)}},{key:"add",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this.set(t.name,t.value)}},{key:"addAll",value:function t(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(n instanceof e){n=n.toPlainObject()}if((0,c.default)(n)===false){throw new Error("Headers argument must be an object.")}var i=Object.keys(n);(0,o.default)(i,function(e){try{r.set(e,n[e])}catch(e){}});return this}},{key:"remove",value:function e(t){if(t){if((0,a.default)(t)===false){t=String(t)}var r=this.headers;delete r[t.toLowerCase()];this.headers=r}return this}},{key:"clear",value:function e(){this.headers={};return this}},{key:"toPlainObject",value:function e(){return this.headers}},{key:"toString",value:function e(){return JSON.stringify(this.toPlainObject())}},{key:"requestStart",get:function e(){return this.get(d)}}]);return e}()},function(e,t,r){(function(e){var n=r(13),i=r(183);var o=typeof t=="object"&&t&&!t.nodeType&&t;var u=o&&typeof e=="object"&&e&&!e.nodeType&&e;var a=u&&u.exports===o;var s=a?n.Buffer:undefined;var c=s?s.isBuffer:undefined;var f=c||i;e.exports=f}).call(t,r(41)(e))},function(e,t){function r(e){return e}e.exports=r},function(e,t,r){var n=r(19),i=r(14);var o="[object Symbol]";function u(e){return typeof e=="symbol"||i(e)&&n(e)==o}e.exports=u},function(e,t,r){var n=r(101),i=r(253),o=r(24);function u(e){return o(e)?n(e,true):i(e)}e.exports=u},function(e,t,r){var n=r(258),i=r(259),o=r(260),u=r(261),a=r(262);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(35);function i(e,t){var r=e.length;while(r--){if(n(e[r][0],t)){return r}}return-1}e.exports=i},function(e,t,r){var n=r(23);var i=n(Object,"create");e.exports=i},function(e,t,r){var n=r(276);function i(e,t){var r=e.__data__;return n(t)?r[typeof t=="string"?"string":"hash"]:r.map}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LiveService=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();t.isValidReceiver=_;t.isValidChannelName=g;t.getLiveService=O;var i=r(2);var o=r(302);var u=y(o);var a=r(25);var s=y(a);var c=r(336);var f=y(c);var l=r(7);var h=r(9);var d=r(1);var p=r(3);var v=r(129);function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e){if(!e){return false}var t=e.onMessage,r=e.onError,n=e.onStatus;return(0,s.default)(t)||(0,s.default)(r)||(0,s.default)(n)}function g(e){return(0,p.isNonemptyString)(e)}var m=t.LiveService=function(){function e(t){b(this,e);this._client=t||l.Client.sharedInstance();this._pubnubClient=undefined;this._pubnubListener=undefined;this._userChannelGroup=undefined;this._pubnubConfig=undefined;this._registeredUser=undefined}n(e,[{key:"fullInitialization",value:function e(t){var r=this;return this.registerUser(t).then(function(e){var t=new u.default(e);var n=new v.PubNubListener;r.initialize(t,n)})}},{key:"fullUninitialization",value:function e(){var t=this;return this.unregisterUser().then(function(e){t.uninitialize();return e})}},{key:"isInitialized",value:function e(){return!!this.__pubnubClient&&!!this.__pubnubListener&&!!this._registeredUser}},{key:"registerUser",value:function e(t){var r=this;if(!t||!t.isActive()){return i.Promise.reject(new d.ActiveUserError("Missing or invalid active user"))}if(this.isInitialized()){return i.Promise.reject(new d.KinveyError("Live service already initialized"))}return this._makeRegisterRequest(t._id).then(function(e){r._registeredUser=t;r._userChannelGroup=e.userChannelGroup;var n=(0,f.default)({ssl:true,authKey:r._registeredUser._kmd.authtoken},e);return n})}},{key:"initialize",value:function e(t,r){if(this.isInitialized()){throw new d.KinveyError("Live service already initialized")}this._pubnubListener=r;this._pubnubClient=t;this._pubnubClient.addListener(this._pubnubListener);this._subscribeToUserChannelGroup()}},{key:"uninitialize",value:function e(){this._unsubscribeFromAll();this._pubnubClient=null;this._pubnubListener=null}},{key:"onConnectionStatusUpdates",value:function e(t){this._pubnubListener.on(v.PubNubListener.unclassifiedEvents,t);this._pubnubListener.on(this._userChannelGroup,t)}},{key:"offConnectionStatusUpdates",value:function e(t){if(t){this._pubnubListener.removeListener(v.PubNubListener.unclassifiedEvents,t);this._pubnubListener.removeListener(this._userChannelGroup,t)}else{this._pubnubListener.removeAllListeners(v.PubNubListener.unclassifiedEvents);this._pubnubListener.removeAllListeners(this._userChannelGroup)}}},{key:"publishToChannel",value:function e(t,r){if(!this.isInitialized()){return i.Promise.reject(new d.KinveyError("Live service is not initialized"))}var n=this._validatePublishData(t,r);if(n){return i.Promise.reject(n)}return this._pubnubClient.publish({message:r,channel:t}).catch(function(e){e=e.status&&e.status.errorData;var t=new h.Response({data:e,statusCode:e.status,headers:e.response&&e.response.headers});return i.Promise.reject(t)})}},{key:"subscribeToChannel",value:function e(t,r){var n=this._validateSubscribeData(t,r);if(n){throw n}this._subscribeToListener(t,r)}},{key:"unsubscribeFromChannel",value:function e(t){this._unsubscribeFromListener(t)}},{key:"unregisterUser",value:function e(){var t=this;if(!this._registeredUser){var r="Cannot unregister when no user has been registered for live service";return i.Promise.reject(new d.KinveyError(r))}var n=this._registeredUser._id;return this._makeUnregisterRequst(n).then(function(e){t._registeredUser=null;return e})}},{key:"_unsubscribeFromAll",value:function e(){this._pubnubClient.unsubscribeAll();this._pubnubListener.removeAllListeners()}},{key:"_validatePublishData",value:function e(t,r){var n=null;if(!g(t)){n=new d.KinveyError("Invalid channel name")}if(r===undefined){n=new d.KinveyError("Missing or invalid message")}return n}},{key:"_validateSubscribeData",value:function e(t,r){var n=null;if(!g(t)){n=new d.KinveyError("Invalid channel name")}if(!r||!_(r)){n=new d.KinveyError("Missing or invalid receiver")}return n}},{key:"_subscribeToUserChannelGroup",value:function e(){this._pubnubClient.subscribe({channelGroups:[this._userChannelGroup]})}},{key:"_subscribeToListener",value:function e(t,r){if((0,s.default)(r.onMessage)){this._pubnubListener.on(t,r.onMessage)}if((0,s.default)(r.onError)||(0,s.default)(r.onStatus)){this._pubnubListener.on(""+v.PubNubListener.statusPrefix+t,function(e){var t=e.error?r.onError:r.onStatus;if((0,s.default)(t)){t.call(r,e)}})}}},{key:"_unsubscribeFromListener",value:function e(t){this._pubnubListener.removeAllListeners(t);this._pubnubListener.removeAllListeners(""+v.PubNubListener.statusPrefix+t)}},{key:"_makeRegisterRequest",value:function e(t){return this._makeUserManagementRequest(t,"register-realtime")}},{key:"_makeUnregisterRequst",value:function e(t){return this._makeUserManagementRequest(t,"unregister-realtime")}},{key:"_makeUserManagementRequest",value:function e(t,r){return h.KinveyRequest.execute({method:h.RequestMethod.POST,pathname:"/user/"+this._client.appKey+"/"+t+"/"+r,body:{deviceId:this._client.deviceId}},this._client)}},{key:"_throwNotInitializedError",value:function e(){throw new d.KinveyError("Live service has not been initialized")}},{key:"_pubnubClient",get:function e(){if(!this.__pubnubClient){this._throwNotInitializedError()}return this.__pubnubClient},set:function e(t){this.__pubnubClient=t}},{key:"_pubnubListener",set:function e(t){this.__pubnubListener=t},get:function e(){if(!this.__pubnubListener){this._throwNotInitializedError()}return this.__pubnubListener}}]);return e}();var w=void 0;function O(e){if(!w){w=new m(e)}return w}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"};e.exports=t["default"]},function(e,t,r){var n=r(120);var i=4;function o(e){return n(e,i)}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.testSupportCollection=undefined;t.buildCollectionUrl=u;t.applyQueryToDataset=a;t.applyAggregationToDataset=s;var n=r(7);var i=r(16);var o=t.testSupportCollection="__testSupport__";function u(e,t,r){e=(0,i.stripTagFromCollectionName)(e);var o="appdata/"+n.Client.sharedInstance().appKey+"/"+e;if(t){o+="/"+t}if(r){o+="/"+r}return o}function a(e,t){if(!t){return e}return t.process(e)}function s(e,t){return t.process(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o={};var u=t.KeyValuePersister=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;i(this,e);this._cacheEnabled=t;this._ttl=r}n(e,[{key:"read",value:function e(t){var r=this;if(this._cacheEnabled&&o[t]){return Promise.resolve(o[t])}return this._readFromPersistance(t).then(function(e){if(r._cacheEnabled){o[t]=e}return e})}},{key:"write",value:function e(t,r){var n=this;this._invalidateCache(t);return this._writeToPersistance(t,r).then(function(e){if(n._cacheEnabled&&n._ttl<Infinity){setTimeout(function(){n._invalidateCache(t)},n._ttl)}return e})}},{key:"delete",value:function e(t){var r=this;return this._deleteFromPersistance(t).then(function(e){r._invalidateCache(t);return e})}},{key:"getKeys",value:function e(){this._throwNotImplementedError()}},{key:"_throwNotImplementedError",value:function e(){throw new Error("Abstract method not implemented")}},{key:"_readFromPersistance",value:function e(t){this._throwNotImplementedError(t)}},{key:"_writeToPersistance",value:function e(t,r){this._throwNotImplementedError(t,r)}},{key:"_deleteFromPersistance",value:function e(t){this._throwNotImplementedError(t)}},{key:"_invalidateCache",value:function e(t){if(this._cacheEnabled){delete o[t]}}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.queryCacheCollectionName=undefined;t.getCachedQuery=p;t.createCachedQuery=v;t.updateCachedQuery=y;t.deleteCachedQuery=b;t.clearQueryCache=_;var n=r(2);var i=r(30);var o=l(i);var u=r(26);var a=l(u);var s=r(15);var c=r(17);var f=r(16);function l(e){return e&&e.__esModule?e:{default:e}}var h=t.queryCacheCollectionName="_QueryCache";function d(e){if(e&&((0,o.default)(e.skip)&&e.skip>0||(0,o.default)(e.limit))){return null}var t=e?e.toQueryString():{};return t&&!(0,a.default)(t)?JSON.stringify(t):""}function p(e,t){var r=d(t);if(!r&&r!==""){return n.Promise.resolve(null)}return c.repositoryProvider.getOfflineRepository().then(function(t){var n=(new s.Query).equalTo("collectionName",e).and().equalTo("query",r);return t.read(h,n).then(function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(t.length>0){return t[0]}return{_id:(0,f.generateEntityId)(),collectionName:e,query:r}})})}function v(e,t){var r=d(t);if(!r){return n.Promise.resolve(null)}return c.repositoryProvider.getOfflineRepository().then(function(t){var n={_id:(0,f.generateEntityId)(),collectionName:e,query:r};return t.create(h,n)})}function y(e){if(!e){return n.Promise.resolve(null)}return c.repositoryProvider.getOfflineRepository().then(function(t){return t.update(h,e)})}function b(e){if(!e){return n.Promise.resolve(null)}return c.repositoryProvider.getOfflineRepository().then(function(t){return t.deleteById(h,e._id)})}function _(e){return c.repositoryProvider.getOfflineRepository().then(function(t){var r=(new s.Query).equalTo("collectionName",e);return t.delete(h,r)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(145);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(147);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(149);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(387);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Middleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=a(i);var u=r(404);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=t.Middleware=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Middleware";s(this,e);this.name=t}n(e,[{key:"handle",value:function e(){return o.default.reject(new Error("A subclass middleware must override the handle function."))}},{key:"cancel",value:function e(){return o.default.resolve()}},{key:"generateTree",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var r={value:this.name,level:t,nodes:[]};return r}},{key:"toString",value:function e(){var t=this.generateTree();return u.AsciiTree.generate(t)}}]);return e}()},function(e,t,r){var n=r(182),i=r(14);var o=Object.prototype;var u=o.hasOwnProperty;var a=o.propertyIsEnumerable;var s=n(function(){return arguments}())?n:function(e){return i(e)&&u.call(e,"callee")&&!a.call(e,"callee")};e.exports=s},function(e,t){var r=9007199254740991;var n=/^(?:0|[1-9]\d*)$/;function i(e,t){var i=typeof e;t=t==null?r:t;return!!t&&(i=="number"||i!="symbol"&&n.test(e))&&(e>-1&&e%1==0&&e<t)}e.exports=i},function(e,t,r){var n=r(75),i=r(35);var o=Object.prototype;var u=o.hasOwnProperty;function a(e,t,r){var o=e[t];if(!(u.call(e,t)&&i(o,r))||r===undefined&&!(t in e)){n(e,t,r)}}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyObservable=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();t.wrapInObservable=O;var o=r(2);var u=d(o);var a=r(109);var s=r(110);var c=r(72);var f=r(25);var l=d(f);var h=r(3);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function y(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var b={closed:true,next:function e(){},error:function e(t){throw t},complete:function e(){},status:function e(){},presence:function e(){}};var _=function(e){y(t,e);function t(e,r,n,i,o,u){p(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));var s=void 0;var c=a;a._parentSubscriber=e;if((0,l.default)(r)){s=r}else if(r){s=r.next;n=r.error;i=r.complete;if(r!==b){c=Object.create(r);if((0,l.default)(c.unsubscribe)){a.add(c.unsubscribe.bind(c))}c.unsubscribe=a.unsubscribe.bind(a)}}a._context=c;a._next=s;a._error=n;a._complete=i;a._status=o;a._presence=u;return a}i(t,[{key:"next",value:function e(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._next,t)}else if(this.__tryOrSetError(r,this._next,t)){this.unsubscribe()}}}},{key:"error",value:function e(t){if(!this.isStopped){var r=this._parentSubscriber;if(this._error){if(!r.syncErrorThrowable){this.__tryOrUnsub(this._error,t);this.unsubscribe()}else{this.__tryOrSetError(r,this._error,t);this.unsubscribe()}}else if(!r.syncErrorThrowable){this.unsubscribe();throw t}else{r.syncErrorValue=t;r.syncErrorThrown=true;this.unsubscribe()}}}},{key:"complete",value:function e(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var n=function e(){return t._complete.call(t._context)};if(!r.syncErrorThrowable){this.__tryOrUnsub(n);this.unsubscribe()}else{this.__tryOrSetError(r,n);this.unsubscribe()}}else{this.unsubscribe()}}}},{key:"status",value:function e(t){if(!this.isStopped&&this._status){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._status,t)}else if(this.__tryOrSetError(r,this._status,t)){this.unsubscribe()}}}},{key:"presence",value:function e(t){if(!this.isStopped&&this._presence){var r=this._parentSubscriber;if(!r.syncErrorThrowable){this.__tryOrUnsub(this._presence,t)}else if(this.__tryOrSetError(r,this._presence,t)){this.unsubscribe()}}}},{key:"__tryOrUnsub",value:function e(t,r){try{t.call(this._context,r)}catch(e){this.unsubscribe();throw e}}},{key:"__tryOrSetError",value:function e(t,r,n){try{r.call(this._context,n)}catch(e){t.syncErrorValue=e;t.syncErrorThrown=true;return true}return false}},{key:"_unsubscribe",value:function e(){var t=this._parentSubscriber;this._context=null;this._parentSubscriber=null;t.unsubscribe()}}]);return t}(s.Subscriber);var g=function(e){y(t,e);function t(e,r,i,o,u){p(this,t);var a=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,i));switch(arguments.length){case 0:a.destination=b;break;case 1:if((0,h.isDefined)(e)===false){a.destination=b;break}if((typeof e==="undefined"?"undefined":n(e))==="object"){if(e instanceof s.Subscriber){a.destination=e;a.destination.add(a)}else{a.syncErrorThrowable=true;a.destination=new _(a,e)}break}default:a.syncErrorThrowable=true;a.destination=new _(a,e,r,i,o,u);break}return a}i(t,[{key:"status",value:function e(t){if(!this.isStopped){this._status(t)}}},{key:"presence",value:function e(t){if(!this.isStopped){this._presence(t)}}},{key:"_status",value:function e(t){this.destination.status(t)}},{key:"_presence",value:function e(t){this.destination.presence(t)}}]);return t}(s.Subscriber);function m(e,t,r,n,i){if(e){if(e instanceof g){return e}if(e[c.rxSubscriber]){return e[c.rxSubscriber]()}}if(!e&&!t&&!r&&!n&&!i){return new g(b)}return new g(e,t,r,n,i)}var w=t.KinveyObservable=function(e){y(t,e);function t(){p(this,t);return v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"subscribe",value:function e(t,r,n,i,o){var u=this.operator;var a=m(t,r,n,i,o);if(u){u.call(a,this.source)}else{a.add(this._trySubscribe(a))}if(a.syncErrorThrowable){a.syncErrorThrowable=false;if(a.syncErrorThrown){throw a.syncErrorValue}}return a}},{key:"toPromise",value:function e(){var t=this;return new u.default(function(e,r){var n=void 0;t.subscribe(function(e){n=e},r,function(){e(n)})})}}],[{key:"create",value:function e(r){return new t(r)}}]);return t}(a.Observable);function O(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var r=(0,h.isPromiseLike)(e);var n=w.create(function(n){var i=void 0;if(r){i=e}else{var o=e(n);i=(0,h.wrapInPromise)(o)}i.then(function(e){if(r){n.next(e)}if(t){n.complete()}}).catch(function(e){return n.error(e)})});return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Aggregation=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(12);var o=g(i);var u=r(99);var a=g(u);var s=r(10);var c=g(s);var f=r(11);var l=g(f);var h=r(25);var d=g(h);var p=r(159);var v=g(p);var y=r(1);var b=r(3);var _=r(15);function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=t.Aggregation=function(){function e(t){m(this,e);t=(0,o.default)({query:null,initial:{},key:{},reduceFn:function(){}.toString()},t);this.query=t.query;this.initial=t.initial;this.key=t.key;this.reduceFn=t.reduceFn}n(e,[{key:"by",value:function e(t){this.key[t]=true;return this}},{key:"process",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var r=this.toPlainObject();var n=Object.keys(r.key);var i=r.reduceFn.replace(/function[\s\S]*?\([\s\S]*?\)/,"");r.reduce=new Function(["doc","out"],i);if(this.query){t=this.query.process(t)}if(n.length>0){var u=[];n.forEach(function(e){var n={};t.forEach(function(t){var i=t[e];var o=(0,b.isDefined)(n[i])?n[i]:(0,v.default)(r.initial);var u=r.reduce(t,o);if((0,b.isDefined)(u)){o=u}n[i]=o});Object.keys(n).forEach(function(t){var r={};r[e]=t;r=(0,o.default)({},r,n[t]);u.push(r)})});return u}var s=(0,v.default)(r.initial);(0,a.default)(t,function(e){var t=r.reduce(e,s);if((0,b.isDefined)(t)){s=t}});return s}},{key:"toPlainObject",value:function e(){return{key:this.key,initial:this.initial,reduce:this.reduceFn,reduceFn:this.reduceFn,condition:this.query?this.query.toPlainObject().filter:{},query:this.query?this.query.toPlainObject():null}}},{key:"initial",get:function e(){return(0,v.default)(this._initial)},set:function e(t){if(!(0,l.default)(t)){throw new y.KinveyError("initial must be an Object.")}this._initial=t}},{key:"query",get:function e(){return this._query},set:function e(t){if((0,b.isDefined)(t)&&!(t instanceof _.Query)){throw new y.KinveyError("Invalid query. It must be an instance of the Query class.")}this._query=t}},{key:"reduceFn",get:function e(){return this._reduceFn},set:function e(t){if((0,d.default)(t)){t=t.toString()}if(!(0,c.default)(t)){throw new y.KinveyError("fn argument must be of type function or string.")}this._reduceFn=t}}],[{key:"count",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.by(r);n.initial={count:0};n.reduceFn=""+"function(doc, out) {"+"  out.count += 1;"+"  return out;"+"}";return n}},{key:"sum",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={sum:0};n.reduceFn=""+"function(doc, out) {"+('  out.sum += doc["'+r+'"];')+"  return out;"+"}";return n}},{key:"min",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={min:Infinity};n.reduceFn=""+"function(doc, out) {"+('  out.min = Math.min(out.min, doc["'+r+'"]);')+"  return out;"+"}";return n}},{key:"max",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={max:-Infinity};n.reduceFn=""+"function(doc, out) {"+('  out.max = Math.max(out.max, doc["'+r+'"]);')+"  return out;"+"}";return n}},{key:"average",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";r=r.replace("'","\\'");var n=new e;n.initial={count:0,average:0};n.reduceFn=""+"function(doc, out) {"+('  out.average = (out.average * out.count + doc["'+r+'"]) / (out.count + 1);')+"  out.count += 1;"+"  return out;"+"}";return n}}]);return e}()},function(e,t,r){var n=r(342),i=r(355),o=r(44),u=r(6),a=r(364);function s(e){if(typeof e=="function"){return e}if(e==null){return o}if(typeof e=="object"){return u(e)?i(e[0],e[1]):n(e)}return a(e)}e.exports=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(38);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(55);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(377);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(88);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(378);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})});var s=r(382);Object.keys(s).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return s[e]}})})},function(e,t,r){var n=r(184),i=r(68),o=r(69);var u=o&&o.isTypedArray;var a=u?i(u):n;e.exports=a},function(e,t){var r=9007199254740991;function n(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=r}e.exports=n},function(e,t){function r(e){return function(t){return e(t)}}e.exports=r},function(e,t,r){(function(e){var n=r(98);var i=typeof t=="object"&&t&&!t.nodeType&&t;var o=i&&typeof e=="object"&&e&&!e.nodeType&&e;var u=o&&o.exports===i;var a=u&&n.process;var s=function(){try{return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(t,r(41)(e))},function(e,t,r){var n=r(104);var i=n(Object.getPrototypeOf,Object);e.exports=i},function(e,t,r){"use strict";(function(e){var r=typeof window!=="undefined"&&window;var n=typeof self!=="undefined"&&typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope&&self;var i=typeof e!=="undefined"&&e;var o=r||i||n;t.root=o;(function(){if(!o){throw new Error("RxJS could not find any global context (window, self, global)")}})()}).call(t,r(18))},function(e,t,r){"use strict";var n=r(71);var i=n.root.Symbol;t.rxSubscriber=typeof i==="function"&&typeof i.for==="function"?i.for("rxSubscriber"):"@@rxSubscriber";t.$$rxSubscriber=t.rxSubscriber},function(e,t,r){var n=r(23),i=r(13);var o=n(i,"Map");e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CacheStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(2);var u=r(12);var a=p(u);var s=r(3);var c=r(77);var f=r(36);var l=r(37);var h=r(57);var d=r(16);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function y(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=t.CacheStore=function(e){b(t,e);function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};v(this,t);e=(0,d.formTaggedCollectionName)(e,n.tag);var i=r||l.processorFactory.getCacheOfflineDataProcessor();var o=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));o.ttl=n.ttl||undefined;o.syncManager=h.syncManagerProvider.getSyncManager();o.useDeltaSet=n.useDeltaSet===true;return o}n(t,[{key:"removeById",value:function e(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(0,s.isDefined)(r)){return o.Promise.resolve({count:0})}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeById",this).call(this,r,n)}},{key:"clear",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this._validateQuery(t);if(n){return n}var i=this._buildOperationObject(f.OperationType.Clear,t);return this._executeOperation(i,r).then(function(e){return{count:e}})}},{key:"pendingSyncCount",value:function e(t){return this.syncManager.getSyncItemCountByEntityQuery(this.collection,t)}},{key:"pendingSyncEntities",value:function e(t){return this.syncManager.getSyncEntities(this.collection,t)}},{key:"push",value:function e(t,r){return this.syncManager.push(this.collection,t,r)}},{key:"pull",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};n=(0,a.default)({useDeltaSet:this.useDeltaSet},n);return this.syncManager.getSyncItemCountByEntityQuery(this.collection,t).then(function(e){if(e>0){var t=(0,d.getEntitiesPendingPushError)(e,"fetch the entities");return o.Promise.reject(t)}return o.Promise.resolve()}).then(function(){return r.syncManager.pull(r.collection,t,n)})}},{key:"sync",value:function e(t,r){var n=this;r=(0,a.default)({useDeltaSet:this.useDeltaSet},r);var i={};return this.push(t,r).then(function(e){i.push=e;return n.pull(t,r)}).then(function(e){i.pull=e;return i})}},{key:"clearSync",value:function e(t){return this.syncManager.clearSync(this.collection,t)}}]);return t}(c.NetworkStore)},function(e,t,r){var n=r(116);function i(e,t,r){if(t=="__proto__"&&n){n(e,t,{configurable:true,enumerable:true,value:r,writable:true})}else{e[t]=r}}e.exports=i},function(e,t,r){var n=r(35),i=r(24),o=r(60),u=r(11);function a(e,t,r){if(!u(r)){return false}var a=typeof t;if(a=="number"?i(r)&&o(t,r.length):a=="string"&&t in r){return n(r[t],e)}return false}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(10);var u=m(o);var a=r(6);var s=m(a);var c=r(12);var f=m(c);var l=r(1);var h=r(15);var d=r(7);var p=r(3);var v=r(62);var y=r(63);var b=r(92);var _=r(36);var g=r(37);function m(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var O=t.NetworkStore=function(){function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};w(this,e);this._processor=r||g.processorFactory.getNetworkProcessor();if(t&&!(0,u.default)(t)){throw new l.KinveyError("Collection must be a string.")}this.collection=t;this.client=n.client}n(e,[{key:"find",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this._validateQuery(t);if(n){return(0,v.wrapInObservable)(n)}r=(0,f.default)({useDeltaSet:this.useDeltaSet},r);var i=this._buildOperationObject(_.OperationType.Read,t);var o=this._executeOperation(i,r);return this._ensureObservable(o)}},{key:"findById",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return(0,v.wrapInObservable)(function(e){e.next(undefined)})}var n=this._buildOperationObject(_.OperationType.ReadById,null,null,t);var i=this._executeOperation(n,r);return this._ensureObservable(i)}},{key:"group",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this._validateAggregationQuery(t);if(n){return this._ensureObservable(n)}var i=this._buildOperationObject(_.OperationType.Group,t);var o=this._executeOperation(i,r);return this._ensureObservable(o)}},{key:"count",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this._validateQuery(t);if(n){return(0,v.wrapInObservable)(n)}var i=this._buildOperationObject(_.OperationType.Count,t);var o=this._executeOperation(i,r);return this._ensureObservable(o)}},{key:"create",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(0,p.isDefined)(t)){return i.Promise.resolve(null)}if((0,s.default)(t)){return i.Promise.reject(new l.KinveyError("Unable to create an array of entities.","Please create entities one by one."))}var n=this._buildOperationObject(_.OperationType.Create,null,t);return this._executeOperation(n,r)}},{key:"update",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(0,p.isDefined)(t)){return i.Promise.resolve(null)}if((0,s.default)(t)){var n=new l.KinveyError("Unable to update an array of entities.","Please update entities one by one.");return i.Promise.reject(n)}if(!(0,p.isDefined)(t._id)){var o="The entity provided does not contain an _id. An _id is required to update the entity.";return i.Promise.reject(new l.KinveyError(o,t))}var u=this._buildOperationObject(_.OperationType.Update,null,t);var a=this._executeOperation(u,r);return this._ensurePromise(a)}},{key:"save",value:function e(t,r){if(t._id){return this.update(t,r)}return this.create(t,r)}},{key:"remove",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=this._validateQuery(t);if(n){return n}var i=this._buildOperationObject(_.OperationType.Delete,t);var o=this._executeOperation(i,r).then(function(e){return{count:e}});return this._ensurePromise(o)}},{key:"removeById",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(0,p.isDefined)(t)){return i.Promise.resolve(undefined)}var n=this._buildOperationObject(_.OperationType.DeleteById,null,null,t);return this._executeOperation(n,r).then(function(e){return{count:e}})}},{key:"subscribe",value:function e(t){var r=(0,b.getLiveCollectionManager)();return r.subscribeCollection(this.collection,t)}},{key:"unsubscribe",value:function e(){var t=(0,b.getLiveCollectionManager)();return t.unsubscribeCollection(this.collection)}},{key:"_validateQuery",value:function e(t){if(t&&!(t instanceof h.Query)){return i.Promise.reject(new l.KinveyError("Invalid query. It must be an instance of the Query class."))}return null}},{key:"_validateAggregationQuery",value:function e(t){if(!(t instanceof y.Aggregation)){return i.Promise.reject(new l.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class."))}return null}},{key:"_buildOperationObject",value:function e(t,r,n,i){return new _.Operation(t,this.collection,r,n,i)}},{key:"_executeOperation",value:function e(t,r){return this._processor.process(t,r)}},{key:"_ensureObservable",value:function e(t){if((0,p.isPromiseLike)(t)){return(0,v.wrapInObservable)(t)}else if((0,p.isObservable)(t)){return t}throw new l.KinveyError("Unexpected result type.")}},{key:"_ensurePromise",value:function e(t){if((0,p.isPromiseLike)(t)){return t}throw new l.KinveyError("Unexpected result type.")}},{key:"client",get:function e(){if((0,p.isDefined)(this._client)){return this._client}return d.Client.sharedInstance()},set:function e(t){if(t instanceof d.Client){this._client=t}else{this._client=null}}},{key:"pathname",get:function e(){var t="/appdata/"+this.client.appKey;if(this.collection){t=t+"/"+this.collection}return t}}]);return e}()},function(e,t,r){var n=r(47),i=r(263),o=r(264),u=r(265),a=r(266),s=r(267);function c(e){var t=this.__data__=new n(e);this.size=t.size}c.prototype.clear=i;c.prototype["delete"]=o;c.prototype.get=u;c.prototype.has=a;c.prototype.set=s;e.exports=c},function(e,t,r){var n=r(268),i=r(275),o=r(277),u=r(278),a=r(279);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(285),i=r(121);var o=Object.prototype;var u=o.propertyIsEnumerable;var a=Object.getOwnPropertySymbols;var s=!a?i:function(e){if(e==null){return[]}e=Object(e);return n(a(e),function(t){return u.call(e,t)})};e.exports=s},function(e,t,r){var n=r(125);function i(e){var t=new e.constructor(e.byteLength);new n(t).set(new n(e));return t}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(304);var i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}t.default={createUUID:function e(){if(i.default.uuid){return i.default.uuid()}else{return(0,i.default)()}}};e.exports=t["default"]},function(e,t){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}e.exports=r;r.EventEmitter=r;r.prototype._events=undefined;r.prototype._maxListeners=undefined;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};r.prototype.emit=function(e){var t,r,i,a,s,c;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var f=new Error('Uncaught, unspecified "error" event. ('+t+")");f.context=t;throw f}}}r=this._events[e];if(u(r))return false;if(n(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(o(r)){a=Array.prototype.slice.call(arguments,1);c=r.slice();i=c.length;for(s=0;s<i;s++)c[s].apply(this,a)}return true};r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,n(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(o(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(o(this._events[e])&&!this._events[e].warned){if(!u(this._maxListeners)){i=this._maxListeners}else{i=r.defaultMaxListeners}if(i&&i>0&&this._events[e].length>i){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var r=false;function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};r.prototype.removeListener=function(e,t){var r,i,u,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];u=r.length;i=-1;if(r===t||n(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(o(r)){for(a=u;a-- >0;){if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(n(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};r.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(n(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;else if(t)return t.length}return 0};r.listenerCount=function(e,t){return e.listenerCount(t)};function n(e){return typeof e==="function"}function i(e){return typeof e==="number"}function o(e){return typeof e==="object"&&e!==null}function u(e){return e===void 0}},function(e,t,r){var n=r(6),i=r(85),o=r(357),u=r(360);function a(e,t){if(n(e)){return e}return i(e,t)?[e]:o(u(e))}e.exports=a},function(e,t,r){var n=r(6),i=r(45);var o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;function a(e,t){if(n(e)){return false}var r=typeof e;if(r=="number"||r=="symbol"||r=="boolean"||e==null||i(e)){return true}return u.test(e)||!o.test(e)||t!=null&&e in Object(t)}e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OfflineDataProcessor=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(2);var u=r(53);var a=p(u);var s=r(36);var c=r(17);var f=r(142);var l=r(16);var h=r(3);var d=r(56);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function y(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var _=t.OfflineDataProcessor=function(e){b(t,e);function t(e){v(this,t);var r=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r._syncManager=e;return r}n(t,[{key:"process",value:function e(r,n){if(r.type===s.OperationType.Clear){return this._processClear(r.collection,r.query,n)}return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"process",this).call(this,r,n)}},{key:"_getRepository",value:function e(){if(!this._repoPromise){this._repoPromise=c.repositoryProvider.getOfflineRepository()}return this._repoPromise}},{key:"_deleteEntityAndHandleOfflineState",value:function e(r,n,o){var u=this;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processDeleteById",this).call(this,r,n._id,o).then(function(e){if(!e){return e}return u._syncManager.addDeleteEvent(r,n).then(function(){return e})})}},{key:"_deleteEntitiesAndHandleOfflineState",value:function e(r,n,o,u){var a=this;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processDelete",this).call(this,r,o,u).then(function(e){return a._syncManager.addDeleteEvent(r,n).then(function(){return e})})}},{key:"_processUpdate",value:function e(r,n,o){var u=this;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processUpdate",this).call(this,r,n,o).then(function(e){return u._syncManager.addUpdateEvent(r,e).then(function(){return e})})}},{key:"_processClear",value:function e(t,r,n){var i=this;return this._syncManager.clearSync(t,r).then(function(){return(0,d.clearQueryCache)(t)}).then(function(){return i._getRepository()}).then(function(e){return e.delete(t,r,n)})}},{key:"_processDelete",value:function e(t,r,n){var i=this;return this._getRepository().then(function(e){return e.read(t,r,n)}).then(function(e){if((0,l.isEmpty)(e)){return o.Promise.resolve(0)}return i._deleteEntitiesAndHandleOfflineState(t,e,r,n)})}},{key:"_processCreate",value:function e(r,n,o){var u=this;n=this._addMetadataToEntities(n);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processCreate",this).call(this,r,n,o).then(function(e){return u._syncManager.addCreateEvent(r,e).then(function(){return e})})}},{key:"_processDeleteById",value:function e(t,r,n){var i=this;return this._getRepository().then(function(e){return e.readById(t,r)}).then(function(e){return i._deleteEntityAndHandleOfflineState(t,e,n)})}},{key:"_addOfflineMetadataToEntity",value:function e(t){var r=t._kmd||{};r.local=true;t._kmd=r;t._id=(0,l.generateEntityId)()}},{key:"_addMetadataToEntities",value:function e(t){var r=this;var n=!Array.isArray(t);var i=(0,h.ensureArray)(t).map(function(e){if(!(0,h.isDefined)(e._id)){e=(0,a.default)(e);r._addOfflineMetadataToEntity(e)}return e});return n?i[0]:i}}]);return t}(f.DataProcessor)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=t.Repository=function(){function e(){i(this,e)}n(e,[{key:"_throwNotImplementedError",value:function e(){throw new Error("Repository class abstract method not implemented")}},{key:"create",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"read",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"readById",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"count",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"update",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"delete",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"deleteById",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"group",value:function e(t,r){this._throwNotImplementedError(r)}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KeyValueStorePersister=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(7);var u=r(1);var a=r(55);function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=t.KeyValueStorePersister=function(e){f(t,e);function t(){s(this,t);return c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"readEntity",value:function e(t,r){var n=this;return this._readEntityFromPersistance(t,r).then(function(e){if(!e){return i.Promise.reject(n._getEntityNotFoundError(t,r))}return e})}},{key:"writeEntities",value:function e(t,r){var n=this;return this._writeEntitiesToPersistance(t,r).then(function(){n._invalidateCache(t);return true})}},{key:"deleteEntity",value:function e(t,r){var n=this;return this._deleteEntityFromPersistance(t,r).then(function(e){n._invalidateCache(t);if(e===0){return i.Promise.reject(n._getEntityNotFoundError(t,r))}if(e>1){return i.Promise.reject(new u.KinveyError("Delete by id matched more than one entity"))}return true})}},{key:"_readEntityFromPersistance",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"_writeEntitiesToPersistance",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"_deleteEntityFromPersistance",value:function e(t,r){this._throwNotImplementedError(r)}},{key:"_getEntityNotFoundError",value:function e(t,r){return new u.NotFoundError("An entity with _id = "+r+" was not found in the "+t+(" collection on the "+this._storeName+" database."))}},{key:"_storeName",get:function e(){return o.Client.sharedInstance().appKey}}]);return t}(a.KeyValuePersister)},function(e,t,r){"use strict";var n=r(391);var i=r(392);var o=r(152);e.exports={formats:o,parse:i,stringify:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyResponse=t.Response=t.StatusCode=undefined;var n=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(12);var u=c(o);var a=r(42);var s=r(1);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=t.StatusCode={Ok:200,Created:201,Empty:204,MovedPermanently:301,Found:302,NotModified:304,TemporaryRedirect:307,PermanentRedirect:308,Unauthorized:401,Forbidden:403,NotFound:404,ServerError:500};Object.freeze(d);var p=t.Response=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};h(this,e);t=(0,u.default)({statusCode:d.Empty,headers:new a.Headers,data:null},t);this.statusCode=t.statusCode;this.headers=t.headers;this.data=t.data}i(e,[{key:"isSuccess",value:function e(){return this.statusCode>=200&&this.statusCode<300||this.statusCode===d.MovedPermanently||this.statusCode===d.Found||this.statusCode===d.NotModified||this.statusCode===d.TemporaryRedirect||this.statusCode===d.PermanentRedirect}},{key:"isServerError",value:function e(){return this.statusCode>=500&&this.statusCode<600}},{key:"isClientError",value:function e(){return this.statusCode>=400&&this.statusCode<500}},{key:"toPlainObject",value:function e(){return{statusCode:this.statusCode,headers:this.headers.toPlainObject(),data:this.data}}},{key:"headers",get:function e(){return this._headers},set:function e(t){if(!(t instanceof a.Headers)){t=new a.Headers(t)}this._headers=t}},{key:"error",get:function e(){if(this.isSuccess()){return null}var t=this.data||{};var r=t.message||t.description;var n=t.debug;var i=this.statusCode;var o=this.headers.get("X-Kinvey-Request-ID");var u=void 0;if(i===d.Unauthorized){u=new s.InsufficientCredentialsError(r,n,i,o)}else if(i===d.NotFound){u=new s.NotFoundError(r,n,i,o)}else if(i===d.ServerError){u=new s.ServerError(r,n,i,o)}else{u=new s.KinveyError(r,n,i,o)}return u}}]);return e}();var v=t.KinveyResponse=function(e){l(t,e);function t(){h(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}i(t,[{key:"error",get:function e(){if(this.isSuccess()){return null}var r=this.data||{};var i=r.name||r.error;var o=r.message||r.description;var u=r.debug;var a=this.statusCode;var c=this.headers.get("X-Kinvey-Request-ID");var f=void 0;if(i==="APIVersionNotAvailable"){f=new s.APIVersionNotAvailableError(o,u,a,c)}else if(i==="APIVersionNotImplemented"){f=new s.APIVersionNotImplementedError(o,u,a,c)}else if(i==="AppProblem"){f=new s.AppProblemError(o,u,a,c)}else if(i==="AppProblem"){f=new s.AppProblemError(o,u,a,c)}else if(i==="BadRequest"){f=new s.BadRequestError(o,u,a,c)}else if(i==="BLInternalError"||i==="BLRuntimeError"||i==="BLSyntaxError"||i==="BLTimeoutError"||i==="BLViolationError"){f=new s.BLError(o,u,a,c)}else if(i==="CORSDisabled"){f=new s.CORSDisabledError(o,u,a,c)}else if(i==="DuplicateEndUsers"){f=new s.DuplicateEndUsersError(o,u,a,c)}else if(i==="FeatureUnavailable"){f=new s.FeatureUnavailableError(o,u,a,c)}else if(i==="IncompleteRequestBody"){f=new s.IncompleteRequestBodyError(o,u,a,c)}else if(i==="IndirectCollectionAccessDisallowed"){f=new s.IndirectCollectionAccessDisallowedError(o,u,a,c)}else if(i==="InsufficientCredentials"){f=new s.InsufficientCredentialsError(o,u,a,c)}else if(i==="InvalidCredentials"){f=new s.InvalidCredentialsError(o,u,a,c)}else if(i==="InvalidIdentifier"){f=new s.InvalidIdentifierError(o,u,a,c)}else if(i==="InvalidQuerySyntax"){f=new s.InvalidQuerySyntaxError(o,u,a,c)}else if(i==="JSONParseError"){f=new s.JSONParseError(o,u,a,c)}else if(i==="KinveyInternalErrorRetry"){f=new s.KinveyInternalErrorRetry(o,u,a,c)}else if(i==="KinveyInternalErrorStop"){f=new s.KinveyInternalErrorStop(o,u,a,c)}else if(i==="MissingQuery"){f=new s.MissingQueryError(o,u,a,c)}else if(i==="MissingRequestHeader"){f=new s.MissingRequestHeaderError(o,u,a,c)}else if(i==="MissingRequestParameter"){f=new s.MissingRequestParameterError(o,u,a,c)}else if(i==="MissingConfiguration"){f=new s.MissingConfigurationError(o,u,a,c)}else if(i==="EntityNotFound"||i==="CollectionNotFound"||i==="AppNotFound"||i==="UserNotFound"||i==="BlobNotFound"||i==="DocumentNotFound"){f=new s.NotFoundError(o,u,a,c)}else if(i==="ParameterValueOutOfRange"){f=new s.ParameterValueOutOfRangeError(o,u,a,c)}else if(i==="ResultSetSizeExceeded"){f=new s.ResultSetSizeExceededError(o,u,a,c)}else if(i==="ServerError"){f=new s.ServerError(o,u,a,c)}else if(i==="StaleRequest"){f=new s.StaleRequestError(o,u,a,c)}else if(i==="UserAlreadyExists"){f=new s.UserAlreadyExistsError(o,u,a,c)}else if(i==="WritesToCollectionDisallowed"){f=new s.WritesToCollectionDisallowedError(o,u,a,c)}else{return n(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"error",this)}return f}}]);return t}(p)},function(e,t){function r(e,t){var r=-1,n=t.length,i=e.length;while(++r<n){e[i+r]=t[r]}return e}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(300);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(130);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(51);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(129);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})});var a=r(367);Object.keys(a).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return a[e]}})})},function(e,t,r){var n=r(84),i=r(40);function o(e,t){t=n(t,e);var r=0,o=t.length;while(e!=null&&r<o){e=e[i(t[r++])]}return r&&r==o?e:undefined}e.exports=o},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length,i=Array(n);while(++r<n){i[r]=t(e[r],r,e)}return i}e.exports=r},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(97);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(168);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.SocialIdentity={Kinvey:"kinvey",MobileIdentityConnect:"kinveyAuth"};Object.freeze(n)},function(e,t,r){(function(t){var r=typeof t=="object"&&t&&t.Object===Object&&t;e.exports=r}).call(t,r(18))},function(e,t,r){var n=r(100),i=r(39),o=r(105),u=r(6);function a(e,t){var r=u(e)?n:i;return r(e,o(t))}e.exports=a},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(t(e[r],r,e)===false){break}}return e}e.exports=r},function(e,t,r){var n=r(102),i=r(59),o=r(6),u=r(43),a=r(60),s=r(66);var c=Object.prototype;var f=c.hasOwnProperty;function l(e,t){var r=o(e),c=!r&&i(e),l=!r&&!c&&u(e),h=!r&&!c&&!l&&s(e),d=r||c||l||h,p=d?n(e.length,String):[],v=p.length;for(var y in e){if((t||f.call(e,y))&&!(d&&(y=="length"||l&&(y=="offset"||y=="parent")||h&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||a(y,v)))){p.push(y)}}return p}e.exports=l},function(e,t){function r(e,t){var r=-1,n=Array(e);while(++r<e){n[r]=t(r)}return n}e.exports=r},function(e,t,r){var n=r(32),i=r(185);var o=Object.prototype;var u=o.hasOwnProperty;function a(e){if(!n(e)){return i(e)}var t=[];for(var r in Object(e)){if(u.call(e,r)&&r!="constructor"){t.push(r)}}return t}e.exports=a},function(e,t){function r(e,t){return function(r){return e(t(r))}}e.exports=r},function(e,t,r){var n=r(44);function i(e){return typeof e=="function"?e:n}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isDefined=c;t.isNumber=f;t.nested=l;t.keyBy=h;t.isEmpty=d;var i=r(187);var o=s(i);var u=r(188);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e){return(0,a.default)(e)===false&&(0,o.default)(e)===false}function f(e){return!Number.isNaN(parseFloat(e))&&Number.isFinite(e)}function l(e,t,r){if(c(t)===false){e=r||e;return e}var n=t.split(".");var i=n.shift();while(i&&e){e=e[i];i=n.shift()}return r||e}function h(e,t){if(!e){return{}}return e.reduce(function(e,r){e[t]=r[t];return e},{})}function d(e){if(!c(e))return true;if(e.length>0)return false;if(e.length===0)return true;if((typeof e==="undefined"?"undefined":n(e))!=="object")return true;return Object.keys(e).reduce(function(t,r){if(!t)return false;if(Object.hasOwnProperty.call(e,r))return false;return true},true)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PromiseQueue=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=a(i);var u=r(108);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=t.PromiseQueue=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;s(this,e);this.pendingPromises=0;this.maxPendingPromises=t;this.maxQueuedPromises=r;this.queue=[]}n(e,[{key:"enqueue",value:function e(t){var r=this;return new o.default(function(e,n,i){if(r.queue.length>=r.maxQueuedPromises){n(new Error("Queue limit reached"));return}r.queue.push({promiseGenerator:t,resolve:e,reject:n,notify:i||u.noop});r._dequeue()})}},{key:"getPendingLength",value:function e(){return this.pendingPromises}},{key:"getQueueLength",value:function e(){return this.queue.length}},{key:"_dequeue",value:function e(){var t=this;if(this.pendingPromises>=this.maxPendingPromises){return false}var r=this.queue.shift();if(!r){return false}try{this.pendingPromises+=1;(0,u.wrapInPromise)(r.promiseGenerator()).then(function(e){t.pendingPromises-=1;r.resolve(e);t._dequeue()},function(e){t.pendingPromises-=1;r.reject(e);t._dequeue()},function(e){r.notify(e)})}catch(e){this.pendingPromises-=1;r.reject(e);this._dequeue()}return true}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.noop=y;t.isPromiseLike=b;t.isObservable=_;t.wrapInPromise=g;t.useIfDefined=m;t.ensureArray=w;t.isValidStorageProviderValue=O;t.forEachAsync=P;t.splitQueryIntoPages=E;var n=r(2);var i=r(109);var o=r(26);var u=v(o);var a=r(115);var s=v(a);var c=r(30);var f=v(c);var l=r(31);var h=r(107);var d=r(15);var p=r(1);function v(e){return e&&e.__esModule?e:{default:e}}function y(){}function b(e){return!!e&&typeof e.then==="function"&&typeof e.catch==="function"}function _(e){return e instanceof i.Observable}function g(e){if(b(e)){return e}return n.Promise.resolve(e)}function m(e,t){if(typeof e!=="undefined"){return e}return t}function w(e){e=m(e,[]);return Array.isArray(e)?e:[e]}function O(e){var t=l.repositoryProvider.getSupportedStorages();var r=w(e);return!!e&&r.length&&r.every(function(e){return t.some(function(t){return e===t})})}function k(e,t){var r=0;var i=e.length;if((0,u.default)(e)){return n.Promise.resolve()}return new n.Promise(function(n){var o=function e(){r+=1;if(r===i){n()}};e.forEach(function(e){t(e).then(o).catch(o)})})}function P(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:Infinity;var n=new h.PromiseQueue(r);return k(e,function(e){return n.enqueue(function(){return t(e)})})}function E(e,t,r){if(!(0,f.default)(t)||!(0,f.default)(r)){throw new p.KinveyError("Invalid page size or expected entity count parameter")}var n=Math.ceil(r/t);return(0,s.default)(n,function(n){var i=new d.Query(e);i.skip=e.skip+n*t;i.limit=Math.min(r-n*t,t);return i})}},function(e,t,r){"use strict";var n=r(71);var i=r(189);var o=r(195);var u=r(196);var a=function(){function e(e){this._isScalar=false;if(e){this._subscribe=e}}e.prototype.lift=function(t){var r=new e;r.source=this;r.operator=t;return r};e.prototype.subscribe=function(e,t,r){var n=this.operator;var o=i.toSubscriber(e,t,r);if(n){n.call(o,this.source)}else{o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o))}if(o.syncErrorThrowable){o.syncErrorThrowable=false;if(o.syncErrorThrown){throw o.syncErrorValue}}return o};e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=true;e.syncErrorValue=t;e.error(t)}};e.prototype.forEach=function(e,t){var r=this;if(!t){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){t=n.root.Rx.config.Promise}else if(n.root.Promise){t=n.root.Promise}}if(!t){throw new Error("no Promise impl found")}return new t(function(t,n){var i;i=r.subscribe(function(t){if(i){try{e(t)}catch(e){n(e);i.unsubscribe()}}else{e(t)}},n,t)})};e.prototype._subscribe=function(e){return this.source.subscribe(e)};e.prototype[o.observable]=function(){return this};e.prototype.pipe=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t-0]=arguments[t]}if(e.length===0){return this}return u.pipeFromArray(e)(this)};e.prototype.toPromise=function(e){var t=this;if(!e){if(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise){e=n.root.Rx.config.Promise}else if(n.root.Promise){e=n.root.Promise}}if(!e){throw new Error("no Promise impl found")}return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})};e.create=function(t){return new e(t)};return e}();t.Observable=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var i=r(111);var o=r(190);var u=r(113);var a=r(72);var s=function(e){n(t,e);function t(r,n,i){e.call(this);this.syncErrorValue=null;this.syncErrorThrown=false;this.syncErrorThrowable=false;this.isStopped=false;switch(arguments.length){case 0:this.destination=u.empty;break;case 1:if(!r){this.destination=u.empty;break}if(typeof r==="object"){if(r instanceof t){this.syncErrorThrowable=r.syncErrorThrowable;this.destination=r;this.destination.add(this)}else{this.syncErrorThrowable=true;this.destination=new c(this,r)}break}default:this.syncErrorThrowable=true;this.destination=new c(this,r,n,i);break}}t.prototype[a.rxSubscriber]=function(){return this};t.create=function(e,r,n){var i=new t(e,r,n);i.syncErrorThrowable=false;return i};t.prototype.next=function(e){if(!this.isStopped){this._next(e)}};t.prototype.error=function(e){if(!this.isStopped){this.isStopped=true;this._error(e)}};t.prototype.complete=function(){if(!this.isStopped){this.isStopped=true;this._complete()}};t.prototype.unsubscribe=function(){if(this.closed){return}this.isStopped=true;e.prototype.unsubscribe.call(this)};t.prototype._next=function(e){this.destination.next(e)};t.prototype._error=function(e){this.destination.error(e);this.unsubscribe()};t.prototype._complete=function(){this.destination.complete();this.unsubscribe()};t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,r=e._parents;this._parent=null;this._parents=null;this.unsubscribe();this.closed=false;this.isStopped=false;this._parent=t;this._parents=r;return this};return t}(o.Subscription);t.Subscriber=s;var c=function(e){n(t,e);function t(t,r,n,o){e.call(this);this._parentSubscriber=t;var a;var s=this;if(i.isFunction(r)){a=r}else if(r){a=r.next;n=r.error;o=r.complete;if(r!==u.empty){s=Object.create(r);if(i.isFunction(s.unsubscribe)){this.add(s.unsubscribe.bind(s))}s.unsubscribe=this.unsubscribe.bind(this)}}this._context=s;this._next=a;this._error=n;this._complete=o}t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;if(!t.syncErrorThrowable){this.__tryOrUnsub(this._next,e)}else if(this.__tryOrSetError(t,this._next,e)){this.unsubscribe()}}};t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error){if(!t.syncErrorThrowable){this.__tryOrUnsub(this._error,e);this.unsubscribe()}else{this.__tryOrSetError(t,this._error,e);this.unsubscribe()}}else if(!t.syncErrorThrowable){this.unsubscribe();throw e}else{t.syncErrorValue=e;t.syncErrorThrown=true;this.unsubscribe()}}};t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};if(!t.syncErrorThrowable){this.__tryOrUnsub(r);this.unsubscribe()}else{this.__tryOrSetError(t,r);this.unsubscribe()}}else{this.unsubscribe()}}};t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){this.unsubscribe();throw e}};t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){e.syncErrorValue=t;e.syncErrorThrown=true;return true}return false};t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null;this._parentSubscriber=null;e.unsubscribe()};return t}(s)},function(e,t,r){"use strict";function n(e){return typeof e==="function"}t.isFunction=n},function(e,t,r){"use strict";t.errorObject={e:{}}},function(e,t,r){"use strict";t.empty={closed:true,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t){var r=Function.prototype;var n=r.toString;function i(e){if(e!=null){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}e.exports=i},function(e,t,r){var n=r(102),i=r(105),o=r(206);var u=9007199254740991;var a=4294967295;var s=Math.min;function c(e,t){e=o(e);if(e<1||e>u){return[]}var r=a,c=s(e,a);t=i(t);e-=a;var f=n(c,t);while(++r<e){t(r)}return f}e.exports=c},function(e,t,r){var n=r(23);var i=function(){try{var e=n(Object,"defineProperty");e({},"",{});return e}catch(e){}}();e.exports=i},function(e,t,r){var n=r(118),i=r(76);function o(e){return n(function(t,r){var n=-1,o=r.length,u=o>1?r[o-1]:undefined,a=o>2?r[2]:undefined;u=e.length>3&&typeof u=="function"?(o--,u):undefined;if(a&&i(r[0],r[1],a)){u=o<3?undefined:u;o=1}t=Object(t);while(++n<o){var s=r[n];if(s){e(t,s,n,u)}}return t})}e.exports=o},function(e,t,r){var n=r(44),i=r(157),o=r(158);function u(e,t){return o(i(e,t,n),e+"")}e.exports=u},function(e,t,r){var n=r(118),i=r(35),o=r(76),u=r(46);var a=Object.prototype;var s=a.hasOwnProperty;var c=n(function(e,t){e=Object(e);var r=-1;var n=t.length;var c=n>2?t[2]:undefined;if(c&&o(t[0],t[1],c)){n=1}while(++r<n){var f=t[r];var l=u(f);var h=-1;var d=l.length;while(++h<d){var p=l[h];var v=e[p];if(v===undefined||i(v,a[p])&&!s.call(e,p)){e[p]=f[p]}}}return e});e.exports=c},function(e,t,r){var n=r(78),i=r(100),o=r(61),u=r(280),a=r(281),s=r(282),c=r(283),f=r(284),l=r(286),h=r(123),d=r(287),p=r(34),v=r(288),y=r(289),b=r(294),_=r(6),g=r(43),m=r(296),w=r(11),O=r(298),k=r(21);var P=1,E=2,j=4;var S="[object Arguments]",C="[object Array]",M="[object Boolean]",T="[object Date]",A="[object Error]",x="[object Function]",R="[object GeneratorFunction]",I="[object Map]",N="[object Number]",D="[object Object]",q="[object RegExp]",U="[object Set]",K="[object String]",L="[object Symbol]",F="[object WeakMap]";var B="[object ArrayBuffer]",G="[object DataView]",H="[object Float32Array]",z="[object Float64Array]",Q="[object Int8Array]",V="[object Int16Array]",$="[object Int32Array]",W="[object Uint8Array]",Y="[object Uint8ClampedArray]",J="[object Uint16Array]",X="[object Uint32Array]";var Z={};Z[S]=Z[C]=Z[B]=Z[G]=Z[M]=Z[T]=Z[H]=Z[z]=Z[Q]=Z[V]=Z[$]=Z[I]=Z[N]=Z[D]=Z[q]=Z[U]=Z[K]=Z[L]=Z[W]=Z[Y]=Z[J]=Z[X]=true;Z[A]=Z[x]=Z[F]=false;function ee(e,t,r,C,M,T){var A,I=t&P,N=t&E,q=t&j;if(r){A=M?r(e,C,M,T):r(e)}if(A!==undefined){return A}if(!w(e)){return e}var U=_(e);if(U){A=v(e);if(!I){return c(e,A)}}else{var K=p(e),L=K==x||K==R;if(g(e)){return s(e,I)}if(K==D||K==S||L&&!M){A=N||L?{}:b(e);if(!I){return N?l(e,a(A,e)):f(e,u(A,e))}}else{if(!Z[K]){return M?e:{}}A=y(e,K,I)}}T||(T=new n);var F=T.get(e);if(F){return F}T.set(e,A);if(O(e)){e.forEach(function(n){A.add(ee(n,t,r,n,e,T))});return A}if(m(e)){e.forEach(function(n,i){A.set(i,ee(n,t,r,i,e,T))});return A}var B=q?N?d:h:N?keysIn:k;var G=U?undefined:B(e);i(G||e,function(n,i){if(G){i=n;n=e[i]}o(A,i,ee(n,t,r,i,e,T))});return A}e.exports=ee},function(e,t){function r(){return[]}e.exports=r},function(e,t,r){var n=r(91),i=r(70),o=r(80),u=r(121);var a=Object.getOwnPropertySymbols;var s=!a?u:function(e){var t=[];while(e){n(t,o(e));e=i(e)}return t};e.exports=s},function(e,t,r){var n=r(124),i=r(80),o=r(21);function u(e){return n(e,o,i)}e.exports=u},function(e,t,r){var n=r(91),i=r(6);function o(e,t,r){var o=t(e);return i(e)?o:n(o,r(e))}e.exports=o},function(e,t,r){var n=r(13);var i=n.Uint8Array;e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(28);var o=s(i);var u=r(305);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t){var r=t.config;c(this,e);this._config=r;this._iv="0123456789012345";this._allowedKeyEncodings=["hex","utf8","base64","binary"];this._allowedKeyLengths=[128,256];this._allowedModes=["ecb","cbc"];this._defaultOptions={encryptKey:true,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}n(e,[{key:"HMACSHA256",value:function e(t){var r=a.default.HmacSHA256(t,this._config.secretKey);return r.toString(a.default.enc.Base64)}},{key:"SHA256",value:function e(t){return a.default.SHA256(t).toString(a.default.enc.Hex)}},{key:"_parseOptions",value:function e(t){var r=t||{};if(!r.hasOwnProperty("encryptKey"))r.encryptKey=this._defaultOptions.encryptKey;if(!r.hasOwnProperty("keyEncoding"))r.keyEncoding=this._defaultOptions.keyEncoding;if(!r.hasOwnProperty("keyLength"))r.keyLength=this._defaultOptions.keyLength;if(!r.hasOwnProperty("mode"))r.mode=this._defaultOptions.mode;if(this._allowedKeyEncodings.indexOf(r.keyEncoding.toLowerCase())===-1){r.keyEncoding=this._defaultOptions.keyEncoding}if(this._allowedKeyLengths.indexOf(parseInt(r.keyLength,10))===-1){r.keyLength=this._defaultOptions.keyLength}if(this._allowedModes.indexOf(r.mode.toLowerCase())===-1){r.mode=this._defaultOptions.mode}return r}},{key:"_decodeKey",value:function e(t,r){if(r.keyEncoding==="base64"){return a.default.enc.Base64.parse(t)}else if(r.keyEncoding==="hex"){return a.default.enc.Hex.parse(t)}else{return t}}},{key:"_getPaddedKey",value:function e(t,r){t=this._decodeKey(t,r);if(r.encryptKey){return a.default.enc.Utf8.parse(this.SHA256(t).slice(0,32))}else{return t}}},{key:"_getMode",value:function e(t){if(t.mode==="ecb"){return a.default.mode.ECB}else{return a.default.mode.CBC}}},{key:"_getIV",value:function e(t){return t.mode==="cbc"?a.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function e(t,r,n){if(this._config.customEncrypt){return this._config.customEncrypt(t)}else{return this.pnEncrypt(t,r,n)}}},{key:"decrypt",value:function e(t,r,n){if(this._config.customDecrypt){return this._config.customDecrypt(t)}else{return this.pnDecrypt(t,r,n)}}},{key:"pnEncrypt",value:function e(t,r,n){if(!r&&!this._config.cipherKey)return t;n=this._parseOptions(n);var i=this._getIV(n);var o=this._getMode(n);var u=this._getPaddedKey(r||this._config.cipherKey,n);var s=a.default.AES.encrypt(t,u,{iv:i,mode:o}).ciphertext;var c=s.toString(a.default.enc.Base64);return c||t}},{key:"pnDecrypt",value:function e(t,r,n){if(!r&&!this._config.cipherKey)return t;n=this._parseOptions(n);var i=this._getIV(n);var o=this._getMode(n);var u=this._getPaddedKey(r||this._config.cipherKey,n);try{var s=a.default.enc.Base64.parse(t);var c=a.default.AES.decrypt({ciphertext:s},u,{iv:i,mode:o}).toString(a.default.enc.Utf8);var f=JSON.parse(c);return f}catch(e){return null}}}]);return e}();t.default=f;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var o=r(52);var u=a(o);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(){s(this,e);this._listeners=[]}n(e,[{key:"addListener",value:function e(t){this._listeners.push(t)}},{key:"removeListener",value:function e(t){var r=[];this._listeners.forEach(function(e){if(e!==t)r.push(e)});this._listeners=r}},{key:"removeAllListeners",value:function e(){this._listeners=[]}},{key:"announcePresence",value:function e(t){this._listeners.forEach(function(e){if(e.presence)e.presence(t)})}},{key:"announceStatus",value:function e(t){this._listeners.forEach(function(e){if(e.status)e.status(t)})}},{key:"announceMessage",value:function e(t){this._listeners.forEach(function(e){if(e.message)e.message(t)})}},{key:"announceNetworkUp",value:function e(){var t={};t.category=u.default.PNNetworkUpCategory;this.announceStatus(t)}},{key:"announceNetworkDown",value:function e(){var t={};t.category=u.default.PNNetworkDownCategory;this.announceStatus(t)}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.getURL=s;t.getRequestTimeout=c;t.prepareParams=f;t.isAuthSupported=l;t.handleResponse=h;t.validateParams=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNTimeOperation}function s(){return"/time/0"}function c(e){var t=e.config;return t.getTransactionTimeout()}function f(){return{}}function l(){return false}function h(e,t){return{timetoken:t[0]}}function d(){}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PubNubListener=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(83);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function a(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var s="status:";var c="pubNubEventsNotRouted";var f=t.PubNubListener=function(e){a(t,e);function t(){o(this,t);return u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"message",value:function e(t){this.emit(t.channel,t.message)}},{key:"status",value:function e(r){var n=this;var i=this._getEventNamesFromStatus(r.affectedChannels,r.affectedChannelGroups);if(i.length){i.forEach(function(e){n.emit(""+t.statusPrefix+e,r)})}else{this.emit(t.unclassifiedEvents,r)}}},{key:"_getEventNamesFromStatus",value:function e(t,r){var n=t||[];var i=r||[];return n.concat(i)}}],[{key:"statusPrefix",get:function e(){return s}},{key:"unclassifiedEvents",get:function e(){return c}}]);return t}(i.EventEmitter)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(338);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(131);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamACL=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var o=f(i);var u=r(339);var a=f(u);var s=r(1);var c=r(3);function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h="Invalid ACL object value";var d=t.StreamACL=function(){function e(t){l(this,e);this.publishers=[];this.subscribers=[];this.publisherGroups=[];this.subscriberGroups=[];if(t){if(t instanceof e){t=t.toPlainObject()}this._parsePlainObject(t)}}n(e,[{key:"addPublishers",value:function e(t){this._addToAcl(this.publishers,t);return this}},{key:"addSubscribers",value:function e(t){this._addToAcl(this.subscribers,t);return this}},{key:"addPublisherGroups",value:function e(t){this._addToAcl(this.publisherGroups,t);return this}},{key:"addSubscriberGroups",value:function e(t){this._addToAcl(this.subscriberGroups,t);return this}},{key:"removePublishers",value:function e(t){this._removeFromAcl(this.publishers,t);return this}},{key:"removeSubscribers",value:function e(t){this._removeFromAcl(this.subscribers,t);return this}},{key:"removePublisherGroups",value:function e(t){this._removeFromAcl(this.publisherGroups,t);return this}},{key:"removeSubscriberGroups",value:function e(t){this._removeFromAcl(this.subscriberGroups,t);return this}},{key:"isNotEmpty",value:function e(){return this.publishers.length||this.subscribers.length||this.publisherGroups.length||this.subscriberGroups.length}},{key:"toPlainObject",value:function e(){var t={};if(this.subscribers.length){t.subscribe=this.subscribers.slice(0)}if(this.publishers.length){t.publish=this.publishers.slice(0)}if(this.subscriberGroups.length){t.groups=t.groups||{};t.groups.subscribe=this.addSubscriberGroups.slice(0)}if(this.publisherGroups.length){t.groups=t.groups||{};t.groups.publish=this.publisherGroups.slice(0)}return t}},{key:"_parsePlainObject",value:function e(t){if(t.subscribe){this.subscribers=this._ensureValidIdArray(t.subscribe)}if(t.publish){this.publishers=this._ensureValidIdArray(t.publish)}if(t.groups){if(t.groups.publish){this.publisherGroups=this._ensureValidIdArray(t.groups.publish)}if(t.groups.subscribe){this.subscriberGroups=this._ensureValidIdArray(t.groups.subscribe)}}}},{key:"_ensureValidIdArray",value:function e(t){var r=this._isValidIdArray(t);if(!r){throw new s.KinveyError(h)}return t}},{key:"_isValidIdArray",value:function e(t){var r=this;return(0,o.default)(t)&&(0,a.default)(t,function(e){var t=r._getAsId(e);return(0,c.isNonemptyString)(t)})}},{key:"_addToAcl",value:function e(t,r){var n=this;var i=(0,o.default)(r)?r:[r];var u=this._isValidIdArray(i);if(!u){throw new s.KinveyError(h)}i.forEach(function(e){var r=n._getAsId(e);t.push(r)})}},{key:"_removeFromAcl",value:function e(t,r){var n=this;var i=(0,o.default)(r)?r:[r];i.forEach(function(e){var r=n._getAsId(e);var i=t.indexOf(r);if(i>=0){t.splice(i,1)}})}},{key:"_getAsId",value:function e(t){return t&&t._id?t._id:t}}],[{key:"isValidACLObject",value:function t(r){try{var n=new e(r);return n.isNotEmpty()}catch(e){return false}}}]);return e}()},function(e,t,r){var n=r(344),i=r(14);function o(e,t,r,u,a){if(e===t){return true}if(e==null||t==null||!i(e)&&!i(t)){return e!==e&&t!==t}return n(e,t,r,u,o,a)}e.exports=o},function(e,t,r){var n=r(345),i=r(348),o=r(349);var u=1,a=2;function s(e,t,r,s,c,f){var l=r&u,h=e.length,d=t.length;if(h!=d&&!(l&&d>h)){return false}var p=f.get(e);if(p&&f.get(t)){return p==t}var v=-1,y=true,b=r&a?new n:undefined;f.set(e,t);f.set(t,e);while(++v<h){var _=e[v],g=t[v];if(s){var m=l?s(g,_,v,t,e,f):s(_,g,v,e,t,f)}if(m!==undefined){if(m){continue}y=false;break}if(b){if(!i(t,function(e,t){if(!o(b,t)&&(_===e||c(_,e,r,s,f))){return b.push(t)}})){y=false;break}}else if(!(_===g||c(_,g,r,s,f))){y=false;break}}f["delete"](e);f["delete"](t);return y}e.exports=s},function(e,t,r){var n=r(11);function i(e){return e===e&&!n(e)}e.exports=i},function(e,t){function r(e,t){return function(r){if(r==null){return false}return r[e]===t&&(t!==undefined||e in Object(r))}}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CacheOfflineDataProcessor=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(2);var u=r(53);var a=y(u);var s=r(15);var c=r(1);var f=r(86);var l=r(3);var h=r(62);var d=r(16);var p=r(143);var v=r(56);function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function g(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=t.CacheOfflineDataProcessor=function(e){g(t,e);function t(e,r){b(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._networkRepository=r;return n}n(t,[{key:"_deleteEntityAndHandleOfflineState",value:function e(r,n,o){var u=this;if((0,d.isLocalEntity)(n)){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_deleteEntityAndHandleOfflineState",this).call(this,r,n,o)}var a=void 0;return this._attemptDeleteByIdOverNetwork(r,n._id,o).then(function(e){a=e;if(a){return u._syncManager.removeSyncItemForEntityId(r,n._id).then(function(){return u._getRepository()}).then(function(e){return e.deleteById(r,n._id,o)})}return u._syncManager.addDeleteEvent(r,n).then(function(){return 0})})}},{key:"_processDelete",value:function e(t,r,n){var i=this;var o=void 0;return this._attemptDeleteOverNetwork(t,r,n).then(function(e){o=e;return i._getRepository()}).then(function(e){return e.read(t,r,n)}).then(function(e){if((0,d.isEmpty)(e)){return 0}if(o){return i._deleteEntitiesOffline(t,r,e,n)}return i._syncManager.addDeleteEvent(t,e).then(function(){return 0})})}},{key:"_processCreate",value:function e(r,n,o){var u=this;var s=void 0;n=(0,a.default)(n);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processCreate",this).call(this,r,n,o).then(function(e){s=e;return u._networkRepository.create(r,n,o)}).then(function(e){return u._replaceNetworkEntityOffline(r,s._id,e).then(function(){return u._syncManager.removeSyncItemForEntityId(r,s._id)}).then(function(){return e})})}},{key:"_processRead",value:function e(r,n){var u=this;var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var f=void 0;var l=a.useDeltaSet;return(0,h.wrapInObservable)(function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processRead",u).call(u,r,n,a).then(function(t){f=t;e.next(f);return u._ensureCountBeforeRead(r,"fetch the entities",n)}).then(function(){if(l){return(0,p.deltaSet)(r,n,a).catch(function(e){if(e instanceof c.InvalidCachedQuery){l=false;return(0,v.getCachedQuery)(r,n).then(function(e){return(0,v.deleteCachedQuery)(e)}).catch(function(e){if(e instanceof c.NotFoundError){return null}throw e}).then(function(){return u._networkRepository.read(r,n,Object.assign(a,{dataOnly:false}))})}throw e})}return u._networkRepository.read(r,n,Object.assign(a,{dataOnly:false}))}).then(function(e){return(0,v.getCachedQuery)(r,n).then(function(t){if(t&&e.headers){t.lastRequest=e.headers.requestStart;return(0,v.updateCachedQuery)(t)}return null}).then(function(){return e.data?e.data:e})}).then(function(e){if(l){var t=[];if(e.deleted.length>0){var n=new s.Query;n.contains("_id",e.deleted.map(function(e){return e._id}));t.push(u._deleteEntitiesOffline(r,n,e.deleted))}if(e.changed.length>0){t.push(u._replaceOfflineEntities(r,e.changed,e.changed))}return o.Promise.all(t)}return u._replaceOfflineEntities(r,f,e)}).then(function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processRead",u).call(u,r,n,a)}).then(function(t){e.next(t);return t})})}},{key:"_processReadById",value:function e(r,n,o){var u=this;var a=void 0;return(0,h.wrapInObservable)(function(e){var c=(new s.Query).equalTo("_id",n);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processReadById",u).call(u,r,n,o).catch(function(e){return u._catchNotFoundError(e)}).then(function(t){e.next(t);a=t;return u._ensureCountBeforeRead(r,"find the entity",c)}).then(function(){return u._networkRepository.readById(r,n,o)}).then(function(t){e.next(t);return u._replaceOfflineEntities(r,a,(0,l.ensureArray)(t))})})}},{key:"_processUpdate",value:function e(r,n,o){var u=this;return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processUpdate",this).call(this,r,n,o).then(function(){return u._networkRepository.update(r,n,o)}).then(function(e){return u._getRepository().then(function(t){return t.update(r,e,o)}).then(function(){return u._syncManager.removeSyncItemForEntityId(r,e._id)}).then(function(){return e})})}},{key:"_processCount",value:function e(r,n,o){var u=this;return(0,h.wrapInObservable)(function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processCount",u).call(u,r,n,o).then(function(t){e.next(t);return u._networkRepository.count(r,n,o)}).then(function(t){return e.next(t)})})}},{key:"_processGroup",value:function e(r,n,o){var u=this;return(0,h.wrapInObservable)(function(e){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processGroup",u).call(u,r,n,o).catch(function(){return[]}).then(function(t){e.next(t);return u._networkRepository.group(r,n,o)}).then(function(t){return e.next(t)})})}},{key:"_replaceNetworkEntityOffline",value:function e(t,r,n){return this._getRepository().then(function(e){var i=o.Promise.resolve();if(r){i=e.deleteById(t,r)}return i.then(function(){return e.create(t,n)})})}},{key:"_replaceOfflineEntities",value:function e(t,r,n){var i=this;var u=o.Promise.resolve();var a=(0,l.ensureArray)(r);if(r&&(0,d.isNotEmpty)(a)){var c=(new s.Query).contains("_id",a.map(function(e){return e._id}));u=this._getRepository().then(function(e){return e.delete(t,c)})}return u.then(function(){return i._getRepository()}).then(function(e){return e.create(t,n)})}},{key:"_attemptDeleteByIdOverNetwork",value:function e(t,r,n){var i=this;return new o.Promise(function(e){return i._networkRepository.deleteById(t,r,n).then(function(){return e(true)}).catch(function(t){if(t instanceof c.NotFoundError){e(true)}else{e(false)}})})}},{key:"_attemptDeleteOverNetwork",value:function e(t,r,n){var i=this;return new o.Promise(function(e){i._networkRepository.delete(t,r,n).then(function(){return e(true)}).catch(function(){return e(false)})})}},{key:"_deleteEntitiesOffline",value:function e(t,r,n,i){var o=this;return this._getRepository().then(function(e){return e.delete(t,r,i)}).then(function(e){return o._syncManager.removeSyncItemsForIds(t,n.map(function(e){return e._id})).then(function(){return e})})}},{key:"_ensureCountBeforeRead",value:function e(t,r,n){return this._syncManager.getSyncItemCountByEntityQuery(t,n).then(function(e){if(e===0){return e}return o.Promise.reject((0,d.getEntitiesPendingPushError)(e,r))})}},{key:"_catchNotFoundError",value:function e(t){if(t instanceof c.NotFoundError){return undefined}return o.Promise.reject(t)}}]);return t}(f.OfflineDataProcessor)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.StorageProvider={Memory:"Memory",WebSQL:"WebSQL",IndexedDB:"IndexedDB",LocalStorage:"LocalStorage",SessionStorage:"SessionStorage",SQLite:"SQLite"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(139);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(376);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InmemoryOfflineRepository=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(370);var u=l(o);var a=r(1);var s=r(140);var c=r(54);var f=r(3);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=t.InmemoryOfflineRepository=function(e){p(t,e);function t(e,r){h(this,t);var n=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._persister=e;n._queue=r;return n}n(t,[{key:"create",value:function e(t,r){var n=this;return this._enqueueCrudOperation(t,function(){return n._create(t,r).then(function(){return r})})}},{key:"read",value:function e(t,r){return this._readAll(t).then(function(e){if(r){return(0,c.applyQueryToDataset)(e,r)}return e})}},{key:"readById",value:function e(t,r){return this._readAll(t).then(function(e){var n=e.find(function(e){return e._id===r});if(!n){var o="An entity with id "+r+' was not found in the collection "'+t+'"';return i.Promise.reject(new a.NotFoundError(o))}return n})}},{key:"count",value:function e(t,r){return this._readAll(t).then(function(e){return(0,c.applyQueryToDataset)(e,r).length})}},{key:"update",value:function e(t,r){var n=this;return this._enqueueCrudOperation(t,function(){return n._update(t,r).then(function(){return r})})}},{key:"delete",value:function e(t,r){var n=this;return this._enqueueCrudOperation(t,function(){return n._delete(t,r)})}},{key:"deleteById",value:function e(t,r){var n=this;return this._enqueueCrudOperation(t,function(){return n._deleteById(t,r)})}},{key:"clear",value:function e(t){var r=this;var n=i.Promise.resolve(t);if(!t){n=this._getAllCollections()}return n.then(function(e){return r._clearCollections(e)})}},{key:"group",value:function e(t,r){return this._readAll(t).then(function(e){return(0,c.applyAggregationToDataset)(e,r)})}},{key:"_formCollectionKey",value:function e(t){var r=this._getAppKey();return r+"."+t}},{key:"_deleteMatchingEntitiesFromPersistance",value:function e(t,r,n){var o=(0,u.default)(n,"_id");var a=r.filter(function(e){return!o[e._id]});var s=r.length-a.length;if(s>0){return this._saveAll(t,a)}return i.Promise.resolve()}},{key:"_delete",value:function e(t,r){var n=this;return this._readAll(t).then(function(e){var i=(0,c.applyQueryToDataset)(e,r);return n._deleteMatchingEntitiesFromPersistance(t,e,i).then(function(){return i.length})})}},{key:"_deleteById",value:function e(t,r){var n=this;return this._readAll(t).then(function(e){var o=e.findIndex(function(e){return e._id===r});if(o>-1){e.splice(o,1);return n._saveAll(t,e).then(function(){return 1})}return i.Promise.resolve(0)})}},{key:"_getAllCollections",value:function e(){var t=this;return this._persister.getKeys().then(function(e){var r=[];e=e||[];e.forEach(function(e){if(t._keyBelongsToApp(e)){r.push(t._getCollectionFromKey(e))}});return r})}},{key:"_update",value:function e(t,r){var n=this;var i=(0,f.ensureArray)(r);var o=(0,u.default)(i,"_id");var a=i.length;return this._readAll(t).then(function(e){e.forEach(function(t,r){if(a>0&&o[t._id]){e[r]=o[t._id];delete o[t._id];a-=1}});if(a>0){Object.keys(o).forEach(function(t){e.push(o[t])})}return n._saveAll(t,e)})}},{key:"_readAll",value:function e(t){var r=this._formCollectionKey(t);return this._persister.read(r).then(function(e){return e||[]})}},{key:"_saveAll",value:function e(t,r){var n=this._formCollectionKey(t);return this._persister.write(n,r)}},{key:"_deleteAll",value:function e(t){var r=this._formCollectionKey(t);return this._persister.delete(r)}},{key:"_enqueueCrudOperation",value:function e(t,r){var n=this._formCollectionKey(t);return this._queue.enqueue(n,r)}},{key:"_keyBelongsToApp",value:function e(t){var r=this._getAppKey();return t.indexOf(r)===0}},{key:"_getCollectionFromKey",value:function e(t){var r=this._getAppKey();return t.substring((r+".").length)}},{key:"_clearCollections",value:function e(t){var r=this;var n=(0,f.ensureArray)(t).map(function(e){return r._enqueueCrudOperation(e,function(){return r._deleteAll(e)})});return i.Promise.all(n).then(function(){return true})}},{key:"_create",value:function e(t,r){var n=this;return this._readAll(t).then(function(e){e=e.concat(r);return n._saveAll(t,e)})}}]);return t}(s.OfflineRepository)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OfflineRepository=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(7);var o=r(87);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c=t.OfflineRepository=function(e){s(t,e);function t(){u(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"clear",value:function e(){this._throwNotImplementedError()}},{key:"_throwNotImplementedError",value:function e(){throw new Error("Method of OfflineRepository not implemented")}},{key:"_getAppKey",value:function e(){return i.Client.sharedInstance().appKey}}]);return t}(o.Repository)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkRepository=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(9);var u=r(63);var a=r(87);var s=r(3);var c=r(54);function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var d=t.NetworkRepository=function(e){h(t,e);function t(){f(this,t);return l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"read",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=this._buildRequestConfig(t,o.RequestMethod.GET,null,r,null,null,n);return this._makeHttpRequest(i,n.dataOnly)}},{key:"readById",value:function e(t,r,n){var i=this._buildRequestConfig(t,o.RequestMethod.GET,null,null,r,null,n);return this._makeHttpRequest(i)}},{key:"create",value:function e(t,r,n){return this._processBatch(t,o.RequestMethod.POST,r,null,n)}},{key:"update",value:function e(t,r,n){return this._processBatch(t,o.RequestMethod.PUT,r,n)}},{key:"deleteById",value:function e(t,r,n){var i=this._buildRequestConfig(t,o.RequestMethod.DELETE,null,null,r,null,n);return this._makeHttpRequest(i).then(function(e){return e.count})}},{key:"delete",value:function e(t,r,n){var i=this._buildRequestConfig(t,o.RequestMethod.DELETE,null,r,null,null,n);return this._makeHttpRequest(i).then(function(e){return e.count})}},{key:"count",value:function e(t,r,n){var i=this._buildRequestConfig(t,o.RequestMethod.GET,null,r,null,"_count",null,n);return this._makeHttpRequest(i,n.dataOnly).then(function(e){if(n.dataOnly===false){return e}return e.count})}},{key:"group",value:function e(t,r,n){var i=this._buildRequestConfig(t,o.RequestMethod.POST,null,r,null,"_group",null,n);return this._makeHttpRequest(i)}},{key:"_processBatch",value:function e(t,r,n,u){var a=this;var c=!Array.isArray(n);var f=(0,s.ensureArray)(n).map(function(e){var n=r===o.RequestMethod.PUT?e._id:null;var i=a._buildRequestConfig(t,r,e,null,n,null,u);return a._makeHttpRequest(i)});return i.Promise.all(f).then(function(e){return c?e&&e[0]:e})}},{key:"_makeHttpRequest",value:function e(t,r){return o.KinveyRequest.execute(t,null,r)}},{key:"_buildRequestConfig",value:function e(t,r,n,i,o,a,s){s=s||{};var f={method:r,pathname:(0,c.buildCollectionUrl)(t,o,a),timeout:s.timeout,properties:s.properties,trace:s.trace,skipBL:s.skipBL,kinveyFileTTL:s.kinveyFileTTL,kinveyFileTLS:s.kinveyFileTLS};if(n){f.body=n}if(i instanceof u.Aggregation){f.aggregation=i}else{f.query=i}return f}}]);return t}(a.Repository)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataProcessor=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(1);var u=r(36);var a=r(3);function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=t.DataProcessor=function(){function e(){s(this,e)}n(e,[{key:"_getRepository",value:function e(){throw new Error("_getRepository not implemented")}},{key:"process",value:function e(t,r){var n=t.collection,a=t.data,s=t.query,c=t.entityId;switch(t.type){case u.OperationType.Create:return this._processCreate(n,a,r);case u.OperationType.Read:return this._processRead(n,s,r);case u.OperationType.ReadById:return this._processReadById(n,c,r);case u.OperationType.Update:return this._processUpdate(n,a,r);case u.OperationType.Delete:return this._processDelete(n,s,r);case u.OperationType.DeleteById:return this._processDeleteById(n,c,r);case u.OperationType.Count:return this._processCount(n,s,r);case u.OperationType.Group:return this._processGroup(n,s,r);default:{var f=new o.KinveyError("Unexpected operation type: "+t.type);return i.Promise.reject(f)}}}},{key:"_processCreate",value:function e(t,r,n){return this._getRepository().then(function(e){return e.create(t,r,n)})}},{key:"_processRead",value:function e(t,r,n){return this._getRepository().then(function(e){return e.read(t,r,n)})}},{key:"_processReadById",value:function e(t,r,n){return this._getRepository().then(function(e){return e.readById(t,r,n)})}},{key:"_processUpdate",value:function e(t,r,n){return this._getRepository().then(function(e){return e.update(t,r,n)})}},{key:"_processDelete",value:function e(t,r,n){return this._getRepository().then(function(e){return e.delete(t,r,n)})}},{key:"_processDeleteById",value:function e(t,r,n){return this._getRepository().then(function(e){return e.deleteById(t,r,n)})}},{key:"_processCount",value:function e(t,r,n){return this._getRepository().then(function(e){return e.count(t,r,n)})}},{key:"_processGroup",value:function e(t,r,n){return this._getRepository().then(function(e){return e.group(t,r,n)})}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.deltaSet=c;var n=r(20);var i=r(9);var o=r(7);var u=r(1);var a=r(16);var s=r(56);function c(e,t,r){return(0,s.getCachedQuery)(e,t).then(function(s){if(!s||!s.lastRequest){throw new u.InvalidCachedQuery}var c=o.Client.sharedInstance();var f=new i.KinveyRequest({authType:i.AuthType.Default,method:i.RequestMethod.GET,url:(0,n.format)({protocol:c.apiProtocol,host:c.apiHost,pathname:(0,a.buildCollectionUrl)(e,null,"_deltaset"),query:{since:s.lastRequest}}),query:t,timeout:r.timeout,followRedirect:r.followRedirect,cache:r.cache,properties:r.properties,skipBL:r.skipBL,trace:r.trace,client:c});return f.execute().catch(function(e){if(e instanceof u.ParameterValueOutOfRangeError||e instanceof u.ResultSetSizeExceededError||e instanceof u.MissingConfigurationError){throw new u.InvalidCachedQuery}throw e})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkDataProcessor=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(142);var u=r(17);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=t.NetworkDataProcessor=function(e){c(t,e);function t(){a(this,t);return s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"_getRepository",value:function e(){if(!this._repoPromise){var t=u.repositoryProvider.getNetworkRepository();this._repoPromise=i.Promise.resolve(t)}return this._repoPromise}}]);return t}(o.DataProcessor)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncManager=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(53);var u=_(o);var a=r(22);var s=r(1);var c=r(162);var f=r(147);var l=r(148);var h=r(16);var d=r(17);var p=r(15);var v=r(3);var y=r(143);var b=r(56);function _(e){return e&&e.__esModule?e:{default:e}}function g(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=(0,c.getPlatformConfig)(),O=w.maxConcurrentPullRequests,k=w.maxConcurrentPushRequests;var P={};var E=t.SyncManager=function(){function e(t,r){m(this,e);this._networkRepo=t;this._syncStateManager=r}n(e,[{key:"push",value:function e(t,r){var n=this;if((0,h.isEmpty)(t)||!(0,v.isNonemptyString)(t)){return i.Promise.reject(new s.KinveyError("Invalid or missing collection name"))}if(this._pushIsInProgress(t)){return i.Promise.reject(new s.SyncError("Data is already being pushed to the backend."+" Please wait for it to complete before pushing new data to the backend."))}this._markPushStart(t);var o=i.Promise.resolve();if(r){o=this._getEntityIdsForQuery(t,r)}return o.then(function(e){return n._syncStateManager.getSyncItems(t,e)}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return n._processSyncItems(t,e)}).then(function(e){n._markPushEnd(t);return e}).catch(function(e){n._markPushEnd();return i.Promise.reject(e)})}},{key:"pull",value:function e(t,r){var n=this;var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return i.Promise.resolve().then(function(){if(!(0,v.isNonemptyString)(t)){throw new s.KinveyError("Invalid or missing collection name")}}).then(function(){if(o.useDeltaSet){return(0,y.deltaSet)(t,r,o).then(function(e){return(0,b.getCachedQuery)(t,r).then(function(t){if(t){t.lastRequest=e.headers.requestStart;return(0,b.updateCachedQuery)(t)}return null}).then(function(){return e.data})}).then(function(e){if(e.deleted.length>0){var r=new p.Query;r.contains("_id",e.deleted.map(function(e){return e._id}));return n._deleteOfflineEntities(t,r).then(function(){return e})}return e}).then(function(e){if(e.changed.length>0){return n._getOfflineRepo().then(function(r){return r.update(t,e.changed)}).then(function(){return e.changed.length})}return 0})}else if(o.autoPagination){return n._paginatedPull(t,r,o)}return n._fetchItemsFromServer(t,r,o).then(function(e){return(0,b.getCachedQuery)(t,r).then(function(t){if(t&&e.headers){t.lastRequest=e.headers.requestStart;return(0,b.updateCachedQuery)(t)}return null}).then(function(){return e.data?e.data:e})}).then(function(e){return n._replaceOfflineEntities(t,r,e).then(function(e){return e.length})})}).catch(function(e){if(e instanceof s.InvalidCachedQuery){return(0,b.getCachedQuery)(t,r).then(function(e){return(0,b.deleteCachedQuery)(e)}).catch(function(e){if(e instanceof s.NotFoundError){return null}throw e}).then(function(){return n.pull(t,r,Object.assign(o,{useDeltaSet:false}))})}throw e})}},{key:"getSyncItemCount",value:function e(t){if(!(0,v.isNonemptyString)(t)){return i.Promise.reject(new s.KinveyError("Invalid or missing collection name"))}return this._syncStateManager.getSyncItemCount(t)}},{key:"getSyncItemCountByEntityQuery",value:function e(t,r){var n=this;if(!r){return this._syncStateManager.getSyncItemCount(t)}return this._getOfflineRepo().then(function(e){return e.read(t,r)}).then(function(e){var r=e.map(function(e){return e._id});return n._syncStateManager.getSyncItemCount(t,r)})}},{key:"getSyncEntities",value:function e(t,r){var n=this;return this._getOfflineRepo().then(function(e){return e.read(t,r)}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return n._syncStateManager.getSyncItems(t,e.map(function(e){return e._id}))})}},{key:"clearSync",value:function e(t,r){var n=this;if(r){return this._getEntityIdsForQuery(t,r).then(function(e){return n._syncStateManager.removeSyncItemsForIds(t,e)})}return this._syncStateManager.removeAllSyncItems(t)}},{key:"addCreateEvent",value:function e(t,r){return this._addEvent(t,r,f.SyncOperation.Create)}},{key:"addDeleteEvent",value:function e(t,r){return this._addEvent(t,r,f.SyncOperation.Delete)}},{key:"addUpdateEvent",value:function e(t,r){return this._addEvent(t,r,f.SyncOperation.Update)}},{key:"removeSyncItemForEntityId",value:function e(t,r){return this._syncStateManager.removeSyncItemForEntityId(t,r)}},{key:"removeSyncItemsForIds",value:function e(t,r){return this._syncStateManager.removeSyncItemsForIds(t,r)}},{key:"_deleteOfflineEntities",value:function e(t,r){return this._getOfflineRepo().then(function(e){return e.delete(t,r)})}},{key:"_replaceOfflineEntities",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];if(r&&(r.hasSkip()||r.hasLimit())){return this._getOfflineRepo().then(function(e){return e.update(t,i)})}return this._deleteOfflineEntities(t,r).then(function(){return n._getOfflineRepo()}).then(function(e){return e.update(t,i)})}},{key:"_getPushOpResult",value:function e(t,r){var n={_id:t,operation:r};if(r!==f.SyncOperation.Delete){n.entity=null}return n}},{key:"_sanitizeOfflineEntity",value:function e(t){var r=(0,u.default)(t);delete r._id;return r}},{key:"_replaceOfflineEntityWithNetwork",value:function e(t,r,n){var i=void 0;return this._getOfflineRepo().then(function(e){i=e;return i.deleteById(t,r)}).then(function(){return i.create(t,n)})}},{key:"_pushCreate",value:function e(t,r){var n=this;var i=r;if(r._kmd&&r._kmd.local){i=this._sanitizeOfflineEntity(r)}var o=this._getPushOpResult(r._id,f.SyncOperation.Create);return this._networkRepo.create(t,i).then(function(e){o.entity=e;return n._replaceOfflineEntityWithNetwork(t,r._id,e)}).then(function(){return o}).catch(function(e){o.error=e;return o})}},{key:"_pushDelete",value:function e(t,r){var n=this._getPushOpResult(r,f.SyncOperation.Delete);return this._networkRepo.deleteById(t,r).then(function(){return n}).catch(function(e){n.error=e;return n})}},{key:"_pushUpdate",value:function e(t,r){var n=this;var i=this._getPushOpResult(r._id,f.SyncOperation.Update);return this._networkRepo.update(t,r).then(function(e){i.entity=e;return n._getOfflineRepo()}).then(function(e){return e.update(t,i.entity)}).then(function(){return i}).catch(function(e){i.entity=r;i.error=e;return i})}},{key:"_handlePushOp",value:function e(t,r,n){var i=r.state,o=r.entityId;var u=i.operation;switch(u){case f.SyncOperation.Create:return this._pushCreate(t,n);case f.SyncOperation.Delete:return this._pushDelete(t,o);case f.SyncOperation.Update:return this._pushUpdate(t,n);default:{var a=this._getPushOpResult(o,u);a.error=new s.SyncError("Unexpected sync operation: "+u);return a}}}},{key:"_pushItem",value:function e(t,r){var n=this;var o=r.entityId,u=r.state;return this._getOfflineRepo().then(function(e){return e.readById(t,o)}).catch(function(e){if(!(e instanceof s.NotFoundError)){return i.Promise.reject(e)}if(u.operation!==f.SyncOperation.Delete){return n._syncStateManager.removeSyncItemForEntityId(t,o).then(function(){return i.Promise.reject(e)})}return null}).then(function(e){return n._handlePushOp(t,r,e)})}},{key:"_processSyncItem",value:function e(t,r){var n=this;return this._pushItem(t,r).then(function(e){if(e.error){return e}return n._syncStateManager.removeSyncItemForEntityId(r.collection,r.entityId).then(function(){return e})}).catch(function(e){var t=n._getPushOpResult(r.entityId,r.state.operation);t.error=e;return t})}},{key:"_processSyncItems",value:function e(t,r){var n=this;var i=[];return(0,v.forEachAsync)(r,function(e){return n._processSyncItem(t,e).then(function(e){return i.push(e)})},k).then(function(){return i})}},{key:"_fetchItemsFromServer",value:function e(t,r,n){return this._networkRepo.read(t,r,Object.assign(n,{dataOnly:false}))}},{key:"_getOfflineRepo",value:function e(){if(!this._offlineRepoPromise){this._offlineRepoPromise=d.repositoryProvider.getOfflineRepository()}return this._offlineRepoPromise}},{key:"_pushIsInProgress",value:function e(t){return!!P[t]}},{key:"_markPushStart",value:function e(t){if(!this._pushIsInProgress(t)){P[t]=true}else{a.Log.debug("Marking push start, when push already started")}}},{key:"_markPushEnd",value:function e(t){if(this._pushIsInProgress(t)){delete P[t]}else{a.Log.debug("Marking push end, when push is NOT started")}}},{key:"_getEntityIdsForQuery",value:function e(t,r){return this._getOfflineRepo().then(function(e){return e.read(t,r)}).then(function(e){return e.map(function(e){return e._id})})}},{key:"_addEvent",value:function e(t,r,n){var i=this._validateCrudEventEntities(r);if(i){return i}return this._setState(t,r,n).then(function(){return r})}},{key:"_validateCrudEventEntities",value:function e(t){if(!t||(0,h.isEmpty)(t)){return i.Promise.reject(new s.SyncError("Invalid or missing entity/entities array."))}var r=(0,v.ensureArray)(t).find(function(e){return!e._id});if(r){var n="An entity is missing an _id. All entities must have an _id in order to be added to the sync table.";return i.Promise.reject(new s.SyncError(n,r))}return null}},{key:"_setState",value:function e(t,r,n){switch(n){case f.SyncOperation.Create:return this._syncStateManager.addCreateEvent(t,r);case f.SyncOperation.Update:return this._syncStateManager.addUpdateEvent(t,r);case f.SyncOperation.Delete:return this._syncStateManager.addDeleteEvent(t,r);default:return i.Promise.reject(new s.SyncError("Invalid sync event name"))}}},{key:"_getInternalPullQuery",value:function e(t,r){t=t||{};var n=t,i=n.filter,o=n.sort,u=n.fields;var a=new p.Query({filter:i,sort:o,fields:u});a.limit=r;if(!o||(0,h.isEmpty)(o)){a.sort=g({},l.defaultPullSortField,1)}return a}},{key:"_fetchAndUpdateEntities",value:function e(t,r,n){var i=this;return this._networkRepo.read(t,r,n).then(function(e){return i._getOfflineRepo().then(function(r){return r.update(t,e)})})}},{key:"_executePaginationQueries",value:function e(t,r,n){var i=this;var o=0;return(0,v.forEachAsync)(r,function(e){return i._fetchAndUpdateEntities(t,e,n).then(function(e){o+=e.length})},O).then(function(){return o})}},{key:"_getExpectedEntityCount",value:function e(t,r){var n=new p.Query({filter:r.filter});return this._networkRepo.count(t,n,{dataOnly:false}).then(function(e){return{lastRequest:e.headers?e.headers.requestStart:undefined,count:e.data?e.data.count:e}})}},{key:"_paginatedPull",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var o=void 0;r=r||new p.Query;return this._getExpectedEntityCount(t,r).then(function(e){var u=e.lastRequest,a=e.count;o=n._getInternalPullQuery(r,a);return n._deleteOfflineEntities(t).then(function(){var e=i.autoPagination&&i.autoPagination.pageSize;var r=e||l.maxEntityLimit;var u=(0,v.splitQueryIntoPages)(o,r,a);return n._executePaginationQueries(t,u,i)}).then(function(e){return(0,b.getCachedQuery)(t,r).then(function(e){if(e){e.lastRequest=u;return(0,b.updateCachedQuery)(e)}return null}).then(function(){return e})})})}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.platformName={nativeScript:"NativeScript",html5:"HTML5",nodeJs:"nodejs",phoneGap:"PhoneGap"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.SyncOperation={Create:"POST",Update:"PUT",Delete:"DELETE"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.syncCollectionName="kinvey_sync";var i=t.maxEntityLimit=1e4;var o=t.defaultPullSortField="_kmd.ect"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncStateManager=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(53);var u=d(o);var a=r(15);var s=r(57);var c=r(17);var f=r(148);var l=r(3);var h=r(16);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var v=t.SyncStateManager=function(){function e(){p(this,e)}n(e,[{key:"addCreateEvent",value:function e(t,r){var n=this._buildSyncItemsForEntities(t,r,s.SyncOperation.Create);return this._createSyncItems(t,n)}},{key:"addUpdateEvent",value:function e(t,r){var n=this._buildSyncItemsForEntities(t,r,s.SyncOperation.Update);return this._upsertSyncItems(t,n)}},{key:"addDeleteEvent",value:function e(t,r){var n=this._groupSyncItemDataForDeleteEvent(t,r);var o=i.Promise.resolve();if((0,h.isNotEmpty)(n.localEntityIds)){var u=this._getEntitiesFilter(t,n.localEntityIds);o=this._deleteSyncItems(t,u)}var a=i.Promise.resolve();if((0,h.isNotEmpty)(n.syncItemsToUpsert)){a=this._upsertSyncItems(t,n.syncItemsToUpsert,n.syncItemsToUpsertIds)}return i.Promise.all([o,a])}},{key:"getSyncItems",value:function e(t,r){var n=this;var i=this._getEntitiesFilter(t,r);return this._getRepository().then(function(e){return e.read(n._getSyncCollectionName(t),i)})}},{key:"getSyncItemCount",value:function e(t,r){var n=this;var i=this._getEntitiesFilter(t,r);return this._getRepository().then(function(e){return e.count(n._getSyncCollectionName(t),i)})}},{key:"removeSyncItemForEntityId",value:function e(t,r){var n=(new a.Query).equalTo("entityId",r);return this._deleteSyncItems(t,n)}},{key:"removeSyncItemsForIds",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var n=this._getEntitiesFilter(t,r);return this._deleteSyncItems(t,n)}},{key:"removeAllSyncItems",value:function e(t){var r=this._getCollectionFilter(t);return this._deleteSyncItems(t,r)}},{key:"_getRepository",value:function e(){if(!this._repoPromise){this._repoPromise=c.repositoryProvider.getOfflineRepository()}return this._repoPromise}},{key:"_deleteSyncItems",value:function e(t,r){var n=this;return this._getRepository().then(function(e){return e.delete(n._getSyncCollectionName(t),r)})}},{key:"_getSyncItemsByEntityIds",value:function e(t){var r=(new a.Query).contains("entityId",t);return this._getRepository().then(function(e){return e.read(f.syncCollectionName,r)})}},{key:"_getUpdatedSyncItem",value:function e(t,r){var n=(0,u.default)(t);n._id=r._id;return n}},{key:"_upsertSyncItems",value:function e(t,r,n){var i=this;if(!n){n=r.map(function(e){return e.entityId})}var o=(new a.Query).contains("entityId",n);return this._getRepository().then(function(e){return e.delete(i._getSyncCollectionName(t),o).then(function(){return e})}).then(function(e){return e.create(i._getSyncCollectionName(t),r)})}},{key:"_getEntitiesFilter",value:function e(t,r){var n=this._getCollectionFilter(t);if(r){n.and().contains("entityId",(0,l.ensureArray)(r))}return n}},{key:"_getCollectionFilter",value:function e(t){var r=new a.Query;r.equalTo("collection",t);if((0,h.collectionHasTag)(t)){r.or().equalTo("collection",(0,h.stripTagFromCollectionName)(t))}return r}},{key:"_buildSyncItem",value:function e(t,r,n){return{_id:(0,h.generateEntityId)(),collection:t,entityId:n,state:{operation:r}}}},{key:"_buildSyncItemsForEntities",value:function e(t,r,n){var i=this;return(0,l.ensureArray)(r).map(function(e){return i._buildSyncItem(t,n,e._id)})}},{key:"_groupSyncItemDataForDeleteEvent",value:function e(t,r){var n=this;var i=[];var o=[];var u=[];(0,l.ensureArray)(r).forEach(function(e){if((0,h.isLocalEntity)(e)){i.push(e._id)}else{var r=n._buildSyncItem(t,s.SyncOperation.Delete,e._id);o.push(r);u.push(e._id)}});return{localEntityIds:i,syncItemsToUpsert:o,syncItemsToUpsertIds:u}}},{key:"_createSyncItems",value:function e(t,r){var n=this;return this._getRepository().then(function(e){return e.create(n._getSyncCollectionName(t),r)})}},{key:"_getSyncCollectionName",value:function e(t){var r=(0,h.getTagFromCollectionName)(t);return(0,h.formTaggedCollectionName)(f.syncCollectionName,r)}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncStore=undefined;var n=r(74);var i=r(37);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function a(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var s=t.SyncStore=function(e){a(t,e);function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};o(this,t);var a=r||i.processorFactory.getOfflineProcessor();return u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a,n))}return t}(n.CacheStore)},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;var i=function(){var e=[];for(var t=0;t<256;++t){e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase())}return e}();var o=function e(t){var r;while(t.length){var n=t.pop();r=n.obj[n.prop];if(Array.isArray(r)){var i=[];for(var o=0;o<r.length;++o){if(typeof r[o]!=="undefined"){i.push(r[o])}}n.obj[n.prop]=i}}return r};t.arrayToObject=function e(t,r){var n=r&&r.plainObjects?Object.create(null):{};for(var i=0;i<t.length;++i){if(typeof t[i]!=="undefined"){n[i]=t[i]}}return n};t.merge=function e(r,i,o){if(!i){return r}if(typeof i!=="object"){if(Array.isArray(r)){r.push(i)}else if(typeof r==="object"){if(o.plainObjects||o.allowPrototypes||!n.call(Object.prototype,i)){r[i]=true}}else{return[r,i]}return r}if(typeof r!=="object"){return[r].concat(i)}var u=r;if(Array.isArray(r)&&!Array.isArray(i)){u=t.arrayToObject(r,o)}if(Array.isArray(r)&&Array.isArray(i)){i.forEach(function(e,i){if(n.call(r,i)){if(r[i]&&typeof r[i]==="object"){r[i]=t.merge(r[i],e,o)}else{r.push(e)}}else{r[i]=e}});return r}return Object.keys(i).reduce(function(e,r){var u=i[r];if(n.call(e,r)){e[r]=t.merge(e[r],u,o)}else{e[r]=u}return e},u)};t.assign=function e(t,r){return Object.keys(r).reduce(function(e,t){e[t]=r[t];return e},t)};t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}};t.encode=function e(t){if(t.length===0){return t}var r=typeof t==="string"?t:String(t);var n="";for(var o=0;o<r.length;++o){var u=r.charCodeAt(o);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122){n+=r.charAt(o);continue}if(u<128){n=n+i[u];continue}if(u<2048){n=n+(i[192|u>>6]+i[128|u&63]);continue}if(u<55296||u>=57344){n=n+(i[224|u>>12]+i[128|u>>6&63]+i[128|u&63]);continue}o+=1;u=65536+((u&1023)<<10|r.charCodeAt(o)&1023);n+=i[240|u>>18]+i[128|u>>12&63]+i[128|u>>6&63]+i[128|u&63]}return n};t.compact=function e(t){var r=[{obj:{o:t},prop:"o"}];var n=[];for(var i=0;i<r.length;++i){var u=r[i];var a=u.obj[u.prop];var s=Object.keys(a);for(var c=0;c<s.length;++c){var f=s[c];var l=a[f];if(typeof l==="object"&&l!==null&&n.indexOf(l)===-1){r.push({obj:a,prop:f});n.push(l)}}}return o(r)};t.isRegExp=function e(t){return Object.prototype.toString.call(t)==="[object RegExp]"};t.isBuffer=function e(t){if(t===null||typeof t==="undefined"){return false}return!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}},function(e,t,r){"use strict";var n=String.prototype.replace;var i=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,i,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Request=t.RequestMethod=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=g(i);var u=r(89);var a=g(u);var s=r(12);var c=g(s);var f=r(10);var l=g(f);var h=r(30);var d=g(h);var p=r(7);var v=r(1);var y=r(3);var b=r(90);var _=r(42);function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=t.RequestMethod={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};Object.freeze(w);var O=t.Request=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};m(this,e);t=(0,c.default)({followRedirect:true},t);this.id=(0,y.randomString)();this.client=t.client;this.method=t.method||w.GET;this.headers=t.headers||new _.Headers;this.url=t.url||"";this.body=t.body||t.data;this.timeout=(0,y.isDefined)(t.timeout)?t.timeout:this.client.defaultTimeout;this.followRedirect=t.followRedirect===true;this.cache=t.cache===true}n(e,[{key:"execute",value:function e(){if((0,y.isDefined)(this.rack)===false){Log.error("Unable to execute the request. Please provide a rack to execute the request.");return o.default.reject(new v.KinveyError("Unable to execute the request. Please provide a rack to execute the request."))}return this.rack.execute(this.toPlainObject()).then(function(e){if((0,y.isDefined)(e)===false){throw new v.NoResponseError}if(e instanceof b.Response===false){e=new b.Response({statusCode:e.statusCode,headers:e.headers,data:e.data})}return e})}},{key:"cancel",value:function e(){return this.rack.cancel()}},{key:"toPlainObject",value:function e(){return{id:this.id,method:this.method,headers:this.headers.toPlainObject(),url:this.url,body:this.body,timeout:this.timeout,followRedirect:this.followRedirect,encryptionKey:this.client.encryptionKey}}},{key:"client",get:function e(){return this._client||p.Client.sharedInstance()},set:function e(t){if(t){if(t instanceof p.Client===false){throw new v.KinveyError("client must be an instance of the Client class.")}}this._client=t}},{key:"method",get:function e(){return this._method},set:function e(t){if(!(0,l.default)(t)){t=String(t)}t=t.toUpperCase();switch(t){case w.GET:case w.POST:case w.PATCH:case w.PUT:case w.DELETE:this._method=t;break;default:throw new v.KinveyError("Invalid request method. Only GET, POST, PATCH, PUT, and DELETE are allowed.")}}},{key:"headers",get:function e(){return this._headers},set:function e(t){if(!(t instanceof _.Headers)){t=new _.Headers(t)}this._headers=t}},{key:"url",get:function e(){if(this.cache===true){return(0,y.appendQuery)(this._url,a.default.stringify({_:Math.random().toString(36).substr(2)}))}return this._url},set:function e(t){this._url=t}},{key:"data",get:function e(){return this.body},set:function e(t){this.body=t}},{key:"timeout",get:function e(){return this._timeout},set:function e(t){t=parseInt(t,10);if((0,d.default)(t)===false||isNaN(t)){throw new v.KinveyError("Invalid timeout. Timeout must be a number.")}this._timeout=t}},{key:"followRedirect",get:function e(){return this._followRedirect},set:function e(t){this._followRedirect=!!t}},{key:"cache",get:function e(){return this._cache},set:function e(t){this._cache=!!t}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkRack=t.Rack=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var o=r(2);var u=y(o);var a=r(398);var s=y(a);var c=r(25);var f=y(c);var l=r(401);var h=y(l);var d=r(3);var p=r(22);var v=r(155);function y(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function g(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var m=t.Rack=function(e){g(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Rack";b(this,t);var r=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.middlewares=[];r.canceled=false;r.activeMiddleware=undefined;return r}n(t,[{key:"use",value:function e(t){if((0,d.isDefined)(t)){if(t instanceof v.Middleware){this.middlewares.push(t);return}throw new Error("Unable to use the middleware. It must be an instance of Middleware.")}}},{key:"reset",value:function e(){this.middlewares=[]}},{key:"execute",value:function e(t){var r=this;if((0,d.isDefined)(t)===false){return u.default.reject(new Error("Request is undefined. Please provide a valid request."))}return(0,s.default)((0,h.default)(this.middlewares),function(e,n){return e.then(function(e){var i=e.request,o=e.response;if(r.canceled){return u.default.reject(new Error("Cancelled"))}r.activeMiddleware=n;return n.handle(i||t,o)})},u.default.resolve({request:t})).then(function(e){var t=e.response;if(r.canceled===true){return u.default.reject(new Error("Cancelled"))}r.canceled=false;r.activeMiddleware=undefined;return t}).catch(function(e){r.canceled=false;r.activeMiddleware=undefined;throw e})}},{key:"cancel",value:function e(){this.canceled=true;if((0,d.isDefined)(this.activeMiddleware)&&(0,f.default)(this.activeMiddleware.cancel)){return this.activeMiddleware.cancel()}return u.default.resolve()}},{key:"handle",value:function e(t){return this.execute(t)}},{key:"generateTree",value:function e(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var n=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generateTree",this).call(this,r);(0,h.default)(this.middlewares).forEach(function(e){n.nodes.push(e.generateTree(r+1))});return n}}]);return t}(v.Middleware);var w=function(e){g(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Network Rack";b(this,t);var r=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.use(new v.SerializeMiddleware);r.use(new v.HttpMiddleware);r.use(new v.ParseMiddleware);return r}n(t,[{key:"useHttpMiddleware",value:function e(t){this.reset();this.use(new v.SerializeMiddleware);this.use(t);this.use(new v.ParseMiddleware)}},{key:"execute",value:function e(r){p.Log.debug("Executing network request",r);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",this).call(this,r).then(function(e){p.Log.debug("Received response for network request: "+r.id,e);return e}).catch(function(e){p.Log.error("Received error for network request id: "+r.id,e);throw e})}}]);return t}(m);var O=new w;t.NetworkRack=O},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(403);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(58);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(405);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})});var u=r(406);Object.keys(u).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return u[e]}})})},,function(e,t,r){var n=r(209);var i=Math.max;function o(e,t,r){t=i(t===undefined?e.length-1:t,0);return function(){var o=arguments,u=-1,a=i(o.length-t,0),s=Array(a);while(++u<a){s[u]=o[t+u]}u=-1;var c=Array(t+1);while(++u<t){c[u]=o[u]}c[t]=r(s);return n(e,this,c)}}e.exports=o},function(e,t,r){var n=r(210),i=r(212);var o=i(n);e.exports=o},function(e,t,r){var n=r(120);var i=1,o=4;function u(e){return n(e,i|o)}e.exports=u},function(e,t){e.exports=require("http")},function(e,t,r){var n=r(362),i=r(363);function o(e,t){return e!=null&&i(e,t,n)}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(146);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(385);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(410);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Acl=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(33);var o=h(i);var u=r(6);var a=h(u);var s=r(12);var c=h(s);var f=r(1);var l=r(3);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var p=t.Acl=function(){function e(t){d(this,e);if((0,o.default)(t)===false){throw new f.KinveyError("entity argument must be an object")}t._acl=t._acl||{};this.entity=t}n(e,[{key:"addReader",value:function e(t){var r=this.readers;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.r=r;return this}},{key:"addReaderGroup",value:function e(t){var r=this.readerGroups;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{r:r});return this}},{key:"addWriter",value:function e(t){var r=this.writers;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.w=r;return this}},{key:"addWriterGroup",value:function e(t){var r=this.writerGroups;if(r.indexOf(t)===-1){r.push(t)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{w:r});return this}},{key:"isGloballyReadable",value:function e(){if(this.entity._acl.gr===true){return this.entity._acl.gr}return false}},{key:"isGloballyWritable",value:function e(){if(this.entity._acl.gw===true){return this.entity._acl.gw}return false}},{key:"removeReader",value:function e(t){var r=this.readers;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.r=r;return this}},{key:"removeReaderGroup",value:function e(t){var r=this.readerGroups;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{r:r});return this}},{key:"removeWriter",value:function e(t){var r=this.writers;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.w=r;return this}},{key:"removeWriterGroup",value:function e(t){var r=this.writerGroups;var n=r.indexOf(t);if(n!==-1){r.splice(n,1)}this.entity._acl.groups=(0,c.default)({},this.entity._acl.groups,{w:r});return this}},{key:"toPlainObject",value:function e(){return this.entity._acl}},{key:"creator",get:function e(){return this.entity._acl.creator}},{key:"readers",get:function e(){return(0,a.default)(this.entity._acl.r)?this.entity._acl.r:[]}},{key:"writers",get:function e(){return(0,a.default)(this.entity._acl.w)?this.entity._acl.w:[]}},{key:"readerGroups",get:function e(){return(0,l.isDefined)(this.entity._acl.groups)&&(0,a.default)(this.entity._acl.groups.r)?this.entity._acl.groups.r:[]}},{key:"writerGroups",get:function e(){return(0,l.isDefined)(this.entity._acl.groups)&&(0,a.default)(this.entity._acl.groups.w)?this.entity._acl.groups.w:[]}},{key:"globallyReadable",set:function e(t){if(t===true){this.entity._acl.gr=t}else{this.entity._acl.gr=false}}},{key:"globallyWritable",set:function e(t){if(t===true){this.entity._acl.gw=t}else{this.entity._acl.gw=false}}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Metadata=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(33);var o=s(i);var u=r(1);var a=r(3);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=t.Metadata=function(){function e(t){c(this,e);if((0,o.default)(t)===false){throw new u.KinveyError("entity argument must be an object")}t._kmd=t._kmd||{};this.entity=t}n(e,[{key:"isLocal",value:function e(){return this.entity._kmd.local===true}},{key:"toPlainObject",value:function e(){return this.entity._kmd}},{key:"createdAt",get:function e(){if((0,a.isDefined)(this.entity._kmd.ect)){return new Date(this.entity._kmd.ect)}return undefined}},{key:"ect",get:function e(){return this.createdAt}},{key:"emailVerification",get:function e(){if((0,a.isDefined)(this.entity._kmd.emailVerification)){return this.entity._kmd.emailVerification.status}return undefined}},{key:"lastModified",get:function e(){if((0,a.isDefined)(this.entity._kmd.lmt)){return new Date(this.entity._kmd.lmt)}return undefined}},{key:"lmt",get:function e(){return this.lastModified}},{key:"authtoken",get:function e(){return this.entity._kmd.authtoken}}]);return e}()},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileIdentityConnect=t.AuthorizationGrant=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=_(i);var u=r(10);var a=_(u);var s=r(20);var c=_(s);var f=r(178);var l=_(f);var h=r(9);var d=r(1);var p=r(3);var v=r(407);var y=r(408);var b=r(97);function _(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function w(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var O=v.Popup;var k=t.AuthorizationGrant={AuthorizationCodeLoginPage:"AuthorizationCodeLoginPage",AuthorizationCodeAPI:"AuthorizationCodeAPI"};Object.freeze(k);var P=t.MobileIdentityConnect=function(e){w(t,e);function t(){g(this,t);return m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"isSupported",value:function e(){return true}},{key:"_getMicPath",value:function e(t){var r="/oauth/auth";var n=3;if(t.version){n=t.version}if((0,a.default)(n)===false){n=String(n)}return(0,l.default)(n.indexOf("v")===0?n:"v"+n,r)}},{key:"login",value:function e(r){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:k.AuthorizationCodeLoginPage;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!(0,a.default)(r)){return o.default.reject(new d.KinveyError("A redirectUri is required and must be a string."))}var s=this.client.appKey;if((0,a.default)(u.micId)){s=s+"."+u.micId}var c=o.default.resolve().then(function(){if(i===k.AuthorizationCodeLoginPage){return n.requestCodeWithPopup(s,r,u)}else if(i===k.AuthorizationCodeAPI){return n.requestTempLoginUrl(s,r,u).then(function(e){return n.requestCodeWithUrl(e,s,r,u)})}throw new d.KinveyError("The authorization grant "+i+" is unsupported. "+"Please use a supported authorization grant.")}).then(function(e){return n.requestToken(e,s,r,u)}).then(function(e){e.identity=t.identity;e.client_id=s;e.redirect_uri=r;e.protocol=n.client.micProtocol;e.host=n.client.micHost;return e});return c}},{key:"refresh",value:function e(r,n,i){var u=this;var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};return o.default.resolve().then(function(){return u.refreshToken(r,n,i,a)}).then(function(e){e.identity=t.identity;e.client_id=n;e.redirect_uri=i;e.protocol=u.client.micProtocol;e.host=u.client.micHost;return e})}},{key:"requestTempLoginUrl",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:this._getMicPath(n)}),properties:n.properties,body:{client_id:t,redirect_uri:r,response_type:"code"}});return i.execute().then(function(e){return e.data.temp_login_uri})}},{key:"requestCodeWithPopup",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var u=o.default.resolve().then(function(){var e=new O;return e.open(c.default.format({protocol:n.client.micProtocol,host:n.client.micHost,pathname:n._getMicPath(i),query:{client_id:t,redirect_uri:r,response_type:"code",scope:"openid"}}))}).then(function(e){var t=new o.default(function(t,n){var i=false;function o(n){try{if(n.url&&n.url.indexOf(r)===0&&i===false){i=true;e.removeAllListeners();e.close();t(c.default.parse(n.url,true).query.code)}}catch(e){}}function u(o){try{if(o.url&&o.url.indexOf(r)===0&&i===false){i=true;e.removeAllListeners();e.close();t(c.default.parse(o.url,true).query.code)}else if(i===false){e.removeAllListeners();e.close();n(new d.KinveyError(o.message,"",o.code))}}catch(e){}}function a(){if(i===false){e.removeAllListeners();n(new d.KinveyError("Login has been cancelled."))}}e.on("loadstart",o);e.on("loadstop",o);e.on("error",u);e.on("exit",a)});return t});return u}},{key:"requestCodeWithUrl",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var u=o.default.resolve().then(function(){var e=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:t,properties:i.properties,body:{client_id:r,redirect_uri:n,response_type:"code",username:i.username,password:i.password,scope:"openid"},followRedirect:false});return e.execute()}).then(function(e){var t=e.headers.get("location");if(t){return c.default.parse(t,true).query.code}throw new d.MobileIdentityConnectError("Unable to authorize user with username "+i.username+".","A location header was not provided with a code to exchange for an auth token.")});return u}},{key:"requestToken",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:h.AuthType.Client,url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),properties:i.properties,body:{grant_type:"authorization_code",client_id:r,redirect_uri:n,code:t},clientId:r});return o.execute().then(function(e){return e.data})}},{key:"refreshToken",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o=new h.KinveyRequest({method:h.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:h.AuthType.Client,url:c.default.format({protocol:this.client.micProtocol,host:this.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:r,redirect_uri:n,refresh_token:t},clientId:r,properties:i.properties,timeout:i.timeout});return o.execute().then(function(e){return e.data})}},{key:"logout",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return o.default.resolve()}},{key:"identity",get:function e(){return b.SocialIdentity.MobileIdentityConnect}}],[{key:"isSupported",value:function e(){return true}},{key:"usePopupClass",value:function e(t){if((0,p.isDefined)(t)){O=t}}},{key:"identity",get:function e(){return b.SocialIdentity.MobileIdentityConnect}}]);return t}(y.Identity)},function(e,t){var r=e.exports={};var n;var i;function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=o}}catch(e){n=o}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=u}}catch(e){i=u}})();function a(e){if(n===setTimeout){return setTimeout(e,0)}if((n===o||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function s(e){if(i===clearTimeout){return clearTimeout(e)}if((i===u||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var c=[];var f=false;var l;var h=-1;function d(){if(!f||!l){return}f=false;if(l.length){c=l.concat(c)}else{h=-1}if(c.length){p()}}function p(){if(f){return}var e=a(d);f=true;var t=c.length;while(t){l=c;c=[];while(++h<t){if(l){l[h].run()}}h=-1;t=c.length}l=null;f=false;s(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}c.push(new v(e,t));if(c.length===1&&!f){a(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function y(){}r.on=y;r.addListener=y;r.once=y;r.off=y;r.removeListener=y;r.removeAllListeners=y;r.emit=y;r.prependListener=y;r.prependOnceListener=y;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t){},function(e,t,r){var n=r(29);var i=Object.prototype;var o=i.hasOwnProperty;var u=i.toString;var a=n?n.toStringTag:undefined;function s(e){var t=o.call(e,a),r=e[a];try{e[a]=undefined;var n=true}catch(e){}var i=u.call(e);if(n){if(t){e[a]=r}else{delete e[a]}}return i}e.exports=s},function(e,t){var r=Object.prototype;var n=r.toString;function i(e){return n.call(e)}e.exports=i},function(e,t,r){(function(e,n){var i;(function(o){var u=typeof t=="object"&&t&&!t.nodeType&&t;var a=typeof e=="object"&&e&&!e.nodeType&&e;var s=typeof n=="object"&&n;if(s.global===s||s.window===s||s.self===s){o=s}var c,f=2147483647,l=36,h=1,d=26,p=38,v=700,y=72,b=128,_="-",g=/^xn--/,m=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=l-h,P=Math.floor,E=String.fromCharCode,j;function S(e){throw new RangeError(O[e])}function C(e,t){var r=e.length;var n=[];while(r--){n[r]=t(e[r])}return n}function M(e,t){var r=e.split("@");var n="";if(r.length>1){n=r[0]+"@";e=r[1]}e=e.replace(w,".");var i=e.split(".");var o=C(i,t).join(".");return n+o}function T(e){var t=[],r=0,n=e.length,i,o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function A(e){return C(e,function(e){var t="";if(e>65535){e-=65536;t+=E(e>>>10&1023|55296);e=56320|e&1023}t+=E(e);return t}).join("")}function x(e){if(e-48<10){return e-22}if(e-65<26){return e-65}if(e-97<26){return e-97}return l}function R(e,t){return e+22+75*(e<26)-((t!=0)<<5)}function I(e,t,r){var n=0;e=r?P(e/v):e>>1;e+=P(e/t);for(;e>k*d>>1;n+=l){e=P(e/k)}return P(n+(k+1)*e/(e+p))}function N(e){var t=[],r=e.length,n,i=0,o=b,u=y,a,s,c,p,v,g,m,w,O;a=e.lastIndexOf(_);if(a<0){a=0}for(s=0;s<a;++s){if(e.charCodeAt(s)>=128){S("not-basic")}t.push(e.charCodeAt(s))}for(c=a>0?a+1:0;c<r;){for(p=i,v=1,g=l;;g+=l){if(c>=r){S("invalid-input")}m=x(e.charCodeAt(c++));if(m>=l||m>P((f-i)/v)){S("overflow")}i+=m*v;w=g<=u?h:g>=u+d?d:g-u;if(m<w){break}O=l-w;if(v>P(f/O)){S("overflow")}v*=O}n=t.length+1;u=I(i-p,n,p==0);if(P(i/n)>f-o){S("overflow")}o+=P(i/n);i%=n;t.splice(i++,0,o)}return A(t)}function D(e){var t,r,n,i,o,u,a,s,c,p,v,g=[],m,w,O,k;e=T(e);m=e.length;t=b;r=0;o=y;for(u=0;u<m;++u){v=e[u];if(v<128){g.push(E(v))}}n=i=g.length;if(i){g.push(_)}while(n<m){for(a=f,u=0;u<m;++u){v=e[u];if(v>=t&&v<a){a=v}}w=n+1;if(a-t>P((f-r)/w)){S("overflow")}r+=(a-t)*w;t=a;for(u=0;u<m;++u){v=e[u];if(v<t&&++r>f){S("overflow")}if(v==t){for(s=r,c=l;;c+=l){p=c<=o?h:c>=o+d?d:c-o;if(s<p){break}k=s-p;O=l-p;g.push(E(R(p+k%O,0)));s=P(k/O)}g.push(E(R(s,0)));o=I(r,w,n==i);r=0;++n}}++r;++t}return g.join("")}function q(e){return M(e,function(e){return g.test(e)?N(e.slice(4).toLowerCase()):e})}function U(e){return M(e,function(e){return m.test(e)?"xn--"+D(e):e})}c={version:"1.4.1",ucs2:{decode:T,encode:A},decode:N,encode:D,toASCII:U,toUnicode:q};if(true){!(i=function(){return c}.call(t,r,t,e),i!==undefined&&(e.exports=i))}else if(u&&a){if(e.exports==u){a.exports=c}else{for(j in c){c.hasOwnProperty(j)&&(u[j]=c[j])}}}else{o.punycode=c}})(this)}).call(t,r(41)(e),r(18))},function(e,t,r){"use strict";e.exports={isString:function(e){return typeof e==="string"},isObject:function(e){return typeof e==="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}},function(e,t,r){"use strict";t.decode=t.parse=r(176);t.encode=t.stringify=r(177)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&";r=r||"=";var u={};if(typeof e!=="string"||e.length===0){return u}var a=/\+/g;e=e.split(t);var s=1e3;if(o&&typeof o.maxKeys==="number"){s=o.maxKeys}var c=e.length;if(s>0&&c>s){c=s}for(var f=0;f<c;++f){var l=e[f].replace(a,"%20"),h=l.indexOf(r),d,p,v,y;if(h>=0){d=l.substr(0,h);p=l.substr(h+1)}else{d=l;p=""}v=decodeURIComponent(d);y=decodeURIComponent(p);if(!n(u,v)){u[v]=y}else if(i(u[v])){u[v].push(y)}else{u[v]=[u[v],y]}}return u};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){t=t||"&";r=r||"=";if(e===null){e=undefined}if(typeof e==="object"){return o(u(e),function(u){var a=encodeURIComponent(n(u))+r;if(i(e[u])){return o(e[u],function(e){return a+encodeURIComponent(n(e))}).join(t)}else{return a+encodeURIComponent(n(e[u]))}}).join(t)}if(!a)return"";return encodeURIComponent(n(a))+r+encodeURIComponent(n(e))};var i=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function o(e,t){if(e.map)return e.map(t);var r=[];for(var n=0;n<e.length;n++){r.push(t(e[n],n))}return r}var u=Object.keys||function(e){var t=[];for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t.push(r)}return t}},function(e,t,r){var n,i;(function(o,u,a){if(typeof e!=="undefined"&&e.exports)e.exports=a();else if(true)!(n=a,i=typeof n==="function"?n.call(t,r,t,e):n,i!==undefined&&(e.exports=i));else u[o]=a()})("urljoin",this,function(){function e(e,t){return e.substr(0,t.length)===t}function t(t,r){if(e(t,"file://")){t=t.replace(/(\/{0,3})\/*/g,"$1")}else{t=t.replace(/:\//g,"://");t=t.replace(/([^:\s\%\3\A])\/+/g,"$1/")}t=t.replace(/\/(\?|&|#[^!])/g,"$1");t=t.replace(/(\?.+)\?/g,"$1&");return t}return function(){var e=arguments;var r={};if(typeof arguments[0]==="object"){e=arguments[0];r=arguments[1]||{}}var n=[].slice.call(e,0).join("/");return t(n,r)}})},function(e,t,r){var n=r(180),i=r(21);function o(e,t){return e&&n(e,t,i)}e.exports=o},function(e,t,r){var n=r(181);var i=n();e.exports=i},function(e,t){function r(e){return function(t,r,n){var i=-1,o=Object(t),u=n(t),a=u.length;while(a--){var s=u[e?a:++i];if(r(o[s],s,o)===false){break}}return t}}e.exports=r},function(e,t,r){var n=r(19),i=r(14);var o="[object Arguments]";function u(e){return i(e)&&n(e)==o}e.exports=u},function(e,t){function r(){return false}e.exports=r},function(e,t,r){var n=r(19),i=r(67),o=r(14);var u="[object Arguments]",a="[object Array]",s="[object Boolean]",c="[object Date]",f="[object Error]",l="[object Function]",h="[object Map]",d="[object Number]",p="[object Object]",v="[object RegExp]",y="[object Set]",b="[object String]",_="[object WeakMap]";var g="[object ArrayBuffer]",m="[object DataView]",w="[object Float32Array]",O="[object Float64Array]",k="[object Int8Array]",P="[object Int16Array]",E="[object Int32Array]",j="[object Uint8Array]",S="[object Uint8ClampedArray]",C="[object Uint16Array]",M="[object Uint32Array]";var T={};T[w]=T[O]=T[k]=T[P]=T[E]=T[j]=T[S]=T[C]=T[M]=true;T[u]=T[a]=T[g]=T[s]=T[m]=T[c]=T[f]=T[l]=T[h]=T[d]=T[p]=T[v]=T[y]=T[b]=T[_]=false;function A(e){return o(e)&&i(e.length)&&!!T[n(e)]}e.exports=A},function(e,t,r){var n=r(104);var i=n(Object.keys,Object);e.exports=i},function(e,t,r){var n=r(24);function i(e,t){return function(r,i){if(r==null){return r}if(!n(r)){return e(r,i)}var o=r.length,u=t?o:-1,a=Object(r);while(t?u--:++u<o){if(i(a[u],u,a)===false){break}}return r}}e.exports=i},function(e,t){function r(e){return e===null}e.exports=r},function(e,t){function r(e){return e===undefined}e.exports=r},function(e,t,r){"use strict";var n=r(110);var i=r(72);var o=r(113);function u(e,t,r){if(e){if(e instanceof n.Subscriber){return e}if(e[i.rxSubscriber]){return e[i.rxSubscriber]()}}if(!e&&!t&&!r){return new n.Subscriber(o.empty)}return new n.Subscriber(e,t,r)}t.toSubscriber=u},function(e,t,r){"use strict";var n=r(191);var i=r(192);var o=r(111);var u=r(193);var a=r(112);var s=r(194);var c=function(){function e(e){this.closed=false;this._parent=null;this._parents=null;this._subscriptions=null;if(e){this._unsubscribe=e}}e.prototype.unsubscribe=function(){var e=false;var t;if(this.closed){return}var r=this,c=r._parent,l=r._parents,h=r._unsubscribe,d=r._subscriptions;this.closed=true;this._parent=null;this._parents=null;this._subscriptions=null;var p=-1;var v=l?l.length:0;while(c){c.remove(this);c=++p<v&&l[p]||null}if(o.isFunction(h)){var y=u.tryCatch(h).call(this);if(y===a.errorObject){e=true;t=t||(a.errorObject.e instanceof s.UnsubscriptionError?f(a.errorObject.e.errors):[a.errorObject.e])}}if(n.isArray(d)){p=-1;v=d.length;while(++p<v){var b=d[p];if(i.isObject(b)){var y=u.tryCatch(b.unsubscribe).call(b);if(y===a.errorObject){e=true;t=t||[];var _=a.errorObject.e;if(_ instanceof s.UnsubscriptionError){t=t.concat(f(_.errors))}else{t.push(_)}}}}}if(e){throw new s.UnsubscriptionError(t)}};e.prototype.add=function(t){if(!t||t===e.EMPTY){return e.EMPTY}if(t===this){return this}var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||typeof r.unsubscribe!=="function"){return r}else if(this.closed){r.unsubscribe();return r}else if(typeof r._addParent!=="function"){var n=r;r=new e;r._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=this._subscriptions||(this._subscriptions=[]);i.push(r);r._addParent(this);return r};e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);if(r!==-1){t.splice(r,1)}}};e.prototype._addParent=function(e){var t=this,r=t._parent,n=t._parents;if(!r||r===e){this._parent=e}else if(!n){this._parents=[e]}else if(n.indexOf(e)===-1){n.push(e)}};e.EMPTY=function(e){e.closed=true;return e}(new e);return e}();t.Subscription=c;function f(e){return e.reduce(function(e,t){return e.concat(t instanceof s.UnsubscriptionError?t.errors:t)},[])}},function(e,t,r){"use strict";t.isArray=Array.isArray||function(e){return e&&typeof e.length==="number"}},function(e,t,r){"use strict";function n(e){return e!=null&&typeof e==="object"}t.isObject=n},function(e,t,r){"use strict";var n=r(112);var i;function o(){try{return i.apply(this,arguments)}catch(e){n.errorObject.e=e;return n.errorObject}}function u(e){i=e;return o}t.tryCatch=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var i=function(e){n(t,e);function t(t){e.call(this);this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError";this.stack=r.stack;this.message=r.message}return t}(Error);t.UnsubscriptionError=i},function(e,t,r){"use strict";var n=r(71);function i(e){var t;var r=e.Symbol;if(typeof r==="function"){if(r.observable){t=r.observable}else{t=r("observable");r.observable=t}}else{t="@@observable"}return t}t.getSymbolObservable=i;t.observable=i(n.root);t.$$observable=t.observable},function(e,t,r){"use strict";var n=r(197);function i(){var e=[];for(var t=0;t<arguments.length;t++){e[t-0]=arguments[t]}return o(e)}t.pipe=i;function o(e){if(!e){return n.noop}if(e.length===1){return e[0]}return function t(r){return e.reduce(function(e,t){return t(e)},r)}}t.pipeFromArray=o},function(e,t,r){"use strict";function n(){}t.noop=n},function(e,t,r){var n=r(23),i=r(13);var o=n(i,"DataView");e.exports=o},function(e,t,r){var n=r(25),i=r(200),o=r(11),u=r(114);var a=/[\\^$.*+?()[\]{}|]/g;var s=/^\[object .+?Constructor\]$/;var c=Function.prototype,f=Object.prototype;var l=c.toString;var h=f.hasOwnProperty;var d=RegExp("^"+l.call(h).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(e){if(!o(e)||i(e)){return false}var t=n(e)?d:s;return t.test(u(e))}e.exports=p},function(e,t,r){var n=r(201);var i=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function o(e){return!!i&&i in e}e.exports=o},function(e,t,r){var n=r(13);var i=n["__core-js_shared__"];e.exports=i},function(e,t){function r(e,t){return e==null?undefined:e[t]}e.exports=r},function(e,t,r){var n=r(23),i=r(13);var o=n(i,"Promise");e.exports=o},function(e,t,r){var n=r(23),i=r(13);var o=n(i,"Set");e.exports=o},function(e,t,r){var n=r(23),i=r(13);var o=n(i,"WeakMap");e.exports=o},function(e,t,r){var n=r(207);function i(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}e.exports=i},function(e,t,r){var n=r(208);var i=1/0,o=1.7976931348623157e308;function u(e){if(!e){return e===0?e:0}e=n(e);if(e===i||e===-i){var t=e<0?-1:1;return t*o}return e===e?e:0}e.exports=u},function(e,t,r){var n=r(11),i=r(45);var o=0/0;var u=/^\s+|\s+$/g;var a=/^[-+]0x[0-9a-f]+$/i;var s=/^0b[01]+$/i;var c=/^0o[0-7]+$/i;var f=parseInt;function l(e){if(typeof e=="number"){return e}if(i(e)){return o}if(n(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=n(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=e.replace(u,"");var r=s.test(e);return r||c.test(e)?f(e.slice(2),r?2:8):a.test(e)?o:+e}e.exports=l},function(e,t){function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}e.exports=r},function(e,t,r){var n=r(211),i=r(116),o=r(44);var u=!i?o:function(e,t){return i(e,"toString",{configurable:true,enumerable:false,value:n(t),writable:true})};e.exports=u},function(e,t){function r(e){return function(){return e}}e.exports=r},function(e,t){var r=800,n=16;var i=Date.now;function o(e){var t=0,o=0;return function(){var u=i(),a=n-(u-o);o=u;if(a>0){if(++t>=r){return arguments[0]}}else{t=0}return e.apply(undefined,arguments)}}e.exports=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="ActiveUserError";this.message=e||"An active user already exists.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.APIVersionNotAvailableError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotAvailableError";this.message=e||"This API version is not available for your app.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.APIVersionNotImplementedError=i;var n=r(0);function i(e,t,r,n){this.name="APIVersionNotImplementedError";this.message=e||"This API version is not implemented.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AppProblemError=i;var n=r(0);function i(e,t,r,n){this.name="AppProblemError";this.message=e||"There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BadRequestError=i;var n=r(0);function i(e,t,r,n){this.name="BadRequestError";this.message=e||"Unable to understand request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BLError=i;var n=r(0);function i(e,t,r,n){this.name="BLError";this.message=e||"The Business Logic script did not complete.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CORSDisabledError=i;var n=r(0);function i(e,t,r,n){this.name="CORSDisabledError";this.message=e||"Cross Origin Support is disabled for this application.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DuplicateEndUsersError=i;var n=r(0);function i(e,t,r,n){this.name="DuplicateEndUsersError";this.message=e||"More than one user registered with this username for this application.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureUnavailableError=i;var n=r(0);function i(e,t,r,n){this.name="FeatureUnavailableError";this.message=e||"Requested functionality is unavailable in this API version.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IncompleteRequestBodyError=i;var n=r(0);function i(e,t,r,n){this.name="IncompleteRequestBodyError";this.message=e||"The request body is either missing or incomplete.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IndirectCollectionAccessDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="IndirectCollectionAccessDisallowedError";this.message=e||"Please use the appropriate API to access this collection for this app backend.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InsufficientCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InsufficientCredentialsError";this.message=e||"The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidCachedQuery=i;var n=r(0);function i(e,t,r,n){this.name="InvalidCachedQuery";this.message=e||"Invalid cached query.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidCredentialsError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidCredentialsError";this.message=e||"Invalid credentials. Please retry your request with correct credentials.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidIdentifierError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidIdentifierError";this.message=e||"One of more identifier names in the request has an invalid format.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.InvalidQuerySyntaxError=i;var n=r(0);function i(e,t,r,n){this.name="InvalidQuerySyntaxError";this.message=e||"The query string in the request has an invalid syntax.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JSONParseError=i;var n=r(0);function i(e,t,r,n){this.name="JSONParseError";this.message=e||"Unable to parse the JSON in the request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyError=i;var n=r(0);function i(e,t,r,n){this.name="KinveyError";this.message=e||"An error occurred.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyInternalErrorRetry=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorRetry";this.message=e||"The Kinvey server encountered an unexpected error. Please retry your request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyInternalErrorStop=i;var n=r(0);function i(e,t,r,n){this.name="KinveyInternalErrorStop";this.message=e||"The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingConfigurationError=i;var n=r(0);function i(e,t,r,n){this.name="MissingConfigurationError";this.message=e||"Missing configuration error.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingQueryError=i;var n=r(0);function i(e,t,r,n){this.name="MissingQueryError";this.message=e||"The request is missing a query string.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingRequestHeaderError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestHeaderError";this.message=e||"The request is missing a required header.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MissingRequestParameterError=i;var n=r(0);function i(e,t,r,n){this.name="MissingRequestParameterError";this.message=e||"A required parameter is missing from the request.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MobileIdentityConnectError=i;var n=r(0);function i(e,t,r,n){this.name="MobileIdentityConnectError";this.message=e||"An error has occurred with Mobile Identity Connect.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetworkConnectionError=i;var n=r(0);function i(e,t,r,n){this.name="NetworkConnectionError";this.message=e||"There was an error connecting to the network.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoActiveUserError=i;var n=r(0);function i(e,t,r,n){this.name="NoActiveUserError";this.message=e||"There is not an active user.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NoResponseError=i;var n=r(0);function i(e,t,r,n){this.name="NoResponseError";this.message=e||"No response was provided.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NotFoundError=i;var n=r(0);function i(e,t,r,n){this.name="NotFoundError";this.message=e||"The entity was not found.";this.debug=t||undefined;this.code=r||404;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParameterValueOutOfRangeError=i;var n=r(0);function i(e,t,r,n){this.name="ParameterValueOutOfRangeError";this.message=e||"The value specified for one of the request parameters is out of range.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PopupError=i;var n=r(0);function i(e,t,r,n){this.name="PopupError";this.message=e||"Unable to open a popup on this platform.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryError=i;var n=r(0);function i(e,t,r,n){this.name="QueryError";this.message=e||"An error occurred with the query.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ResultSetSizeExceededError=i;var n=r(0);function i(e,t,r,n){this.name="ResultSetSizeExceededError";this.message=e||"Result set size exceeded.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServerError=i;var n=r(0);function i(e,t,r,n){this.name="ServerError";this.message=e||"An error occurred on the server.";this.debug=t||undefined;this.code=r||500;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StaleRequestError=i;var n=r(0);function i(e,t,r,n){this.name="StaleRequestError";this.message=e||"The time window for this request has expired.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SyncError=i;var n=r(0);function i(e,t,r,n){this.name="SyncError";this.message=e||"An error occurred during sync.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TimeoutError=i;var n=r(0);function i(e,t,r,n){this.name="TimeoutError";this.message=e||"The request timed out.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UserAlreadyExistsError=i;var n=r(0);function i(e,t,r,n){this.name="UserAlreadyExistsError";this.message=e||"This username is already taken. Please retry your request with a different username.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WritesToCollectionDisallowedError=i;var n=r(0);function i(e,t,r,n){this.name="WritesToCollectionDisallowedError";this.message=e||"This collection is configured to disallow any modifications to an existing entity or creation of new entities.";this.debug=t||undefined;this.code=r||undefined;this.kinveyRequestId=n||undefined;this.stack=(new Error).stack}i.prototype=Object.create(n.BaseError.prototype);i.prototype.constructor=i},function(e,t){(function(){"use strict";function r(e){return typeof e==="function"}function n(e){return Object.prototype.toString.call(e)==="[object Array]"}function i(e){if(e instanceof Date){return e.getTime()}else if(n(e)){return e.map(i)}else if(e&&typeof e.toJSON==="function"){return e.toJSON()}else{return e}}function o(e,t){return r(e.get)?e.get(t):e[t]}function u(e){return function(t,r){if(!n(r)||!r.length){return e(t,r)}for(var i=0,u=r.length;i<u;i++){if(e(t,o(r,i)))return true}return false}}function a(e){return function(t,r){if(!n(r)||!r.length){return e(t,r)}for(var i=0,u=r.length;i<u;i++){if(!e(t,o(r,i)))return false}return true}}function s(e,t,r,n){return e.v(e.a,t,r,n)}var c={$eq:u(function(e,t){return e(t)}),$ne:a(function(e,t){return!e(t)}),$gt:u(function(e,t){return g.compare(i(t),e)>0}),$gte:u(function(e,t){return g.compare(i(t),e)>=0}),$lt:u(function(e,t){return g.compare(i(t),e)<0}),$lte:u(function(e,t){return g.compare(i(t),e)<=0}),$mod:u(function(e,t){return t%e[0]==e[1]}),$in:function(e,t){if(t instanceof Array){for(var r=t.length;r--;){if(~e.indexOf(i(o(t,r)))){return true}}}else{var n=i(t);if(n===t&&typeof t==="object"){for(var r=e.length;r--;){if(String(e[r])===String(t)&&String(t)!=="[object Object]"){return true}}}if(typeof n=="undefined"){for(var r=e.length;r--;){if(e[r]==null){return true}}}for(var r=e.length;r--;){var u=_(o(e,r),undefined);var a=s(u,t,r,e);if(a&&String(a)!=="[object Object]"&&String(t)!=="[object Object]"){return true}}return!!~e.indexOf(n)}return false},$nin:function(e,t,r,n){return!c.$in(e,t,r,n)},$not:function(e,t,r,n){return!s(e,t,r,n)},$type:function(e,t){return t!=void 0?t instanceof e||t.constructor==e:false},$all:function(e,t,r,n){return c.$and(e,t,r,n)},$size:function(e,t){return t?e===t.length:false},$or:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++)if(s(o(e,i),t,r,n))return true;return false},$nor:function(e,t,r,n){return!c.$or(e,t,r,n)},$and:function(e,t,r,n){for(var i=0,u=e.length;i<u;i++){if(!s(o(e,i),t,r,n)){return false}}return true},$regex:u(function(e,t){return typeof t==="string"&&e.test(t)}),$where:function(e,t,r,n){return e.call(t,t,r,n)},$elemMatch:function(e,t,r,i){if(n(t)){return!!~l(t,e)}return s(e,t,r,i)},$exists:function(e,t,r,n){return n.hasOwnProperty(r)===e}};var f={$eq:function(e){if(e instanceof RegExp){return function(t){return typeof t==="string"&&e.test(t)}}else if(e instanceof Function){return e}else if(n(e)&&!e.length){return function(e){return n(e)&&!e.length}}else if(e===null){return function(e){return e==null}}return function(t){return g.compare(i(t),e)===0}},$ne:function(e){return f.$eq(e)},$and:function(e){return e.map(b)},$all:function(e){return f.$and(e)},$or:function(e){return e.map(b)},$nor:function(e){return e.map(b)},$not:function(e){return b(e)},$regex:function(e,t){return new RegExp(e,t.$options)},$where:function(e){return typeof e==="string"?new Function("obj","return "+e):e},$elemMatch:function(e){return b(e)},$exists:function(e){return!!e}};function l(e,t){for(var r=0;r<e.length;r++){var n=o(e,r);if(s(t,o(e,r))){return r}}return-1}function h(e,t){return{a:e,v:t}}function d(e,t){var r=[];p(t,e.k,0,t,r);if(r.length===1){var n=r[0];return s(e.nv,n[0],n[1],n[2])}for(var i=0;i<r.length;i++){var o=r[i];if(s(e.nv,o[0],o[1],o[2])){return true}}return false}function p(e,t,r,i,u){if(r===t.length||e==void 0){u.push([e,t[r-1],i]);return}var a=o(t,r);if(n(e)&&isNaN(Number(a))){for(var s=0,c=e.length;s<c;s++){p(o(e,s),t,r,e,u)}}else{p(o(e,a),t,r+1,e,u)}}function v(e,t){return{a:{k:e,nv:t},v:d}}function y(e){return e&&e.constructor===Object}function b(e){e=i(e);if(!e||!y(e)){e={$eq:e}}var t=[];for(var r in e){var n=e[r];if(r==="$options"){continue}if(c[r]){if(f[r])n=f[r](n,e);t.push(h(i(n),c[r]))}else{if(r.charCodeAt(0)===36){throw new Error("Unknown operation "+r)}t.push(v(r.split("."),b(n)))}}return t.length===1?t[0]:h(t,c.$and)}function _(e,t){var r=b(e);if(t){r={a:r,v:function(e,r,n,i){return s(e,t(r),n,i)}}}return r}function g(e,t,n){if(r(t)){n=t;t=void 0}var i=_(e,n);function o(e,t,r){return s(i,e,t,r)}if(t){return t.filter(o)}return o}g.use=function(e){if(r(e))return e(g);for(var t in e){if(t.charCodeAt(0)===36){c[t]=e[t]}}};g.indexOf=function(e,t,r){return l(t,_(e,r))};g.compare=function(e,t){if(e===t)return 0;if(typeof e===typeof t){if(e>t){return 1}if(e<t){return-1}}};if(typeof e!=="undefined"&&typeof e.exports!=="undefined"){Object.defineProperty(t,"__esModule",{value:true});e.exports=g;t["default"]=e.exports.default=g}if(typeof window!=="undefined"){window.sift=g}})()},function(e,t,r){var n=r(11),i=r(32),o=r(254);var u=Object.prototype;var a=u.hasOwnProperty;function s(e){if(!n(e)){return o(e)}var t=i(e),r=[];for(var u in e){if(!(u=="constructor"&&(t||!a.call(e,u)))){r.push(u)}}return r}e.exports=s},function(e,t){function r(e){var t=[];if(e!=null){for(var r in Object(e)){t.push(r)}}return t}e.exports=r},function(e,t,r){var n,i;(function(o,u){"use strict";if(true){!(n=u,i=typeof n==="function"?n.call(t,r,t,e):n,i!==undefined&&(e.exports=i))}else if(typeof e==="object"&&e.exports){e.exports=u()}else{o.log=u()}})(this,function(){"use strict";var e=function(){};var t="undefined";var r=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if(typeof r.bind==="function"){return r.bind(e)}else{try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}}function i(r){if(r==="debug"){r="log"}if(typeof console===t){return false}else if(console[r]!==undefined){return n(console,r)}else if(console.log!==undefined){return n(console,"log")}else{return e}}function o(t,n){for(var i=0;i<r.length;i++){var o=r[i];this[o]=i<t?e:this.methodFactory(o,t,n)}this.log=this.debug}function u(e,r,n){return function(){if(typeof console!==t){o.call(this,r,n);this[e].apply(this,arguments)}}}function a(e,t,r){return i(e)||u.apply(this,arguments)}function s(e,n,i){var u=this;var s;var c="loglevel";if(e){c+=":"+e}function f(e){var n=(r[e]||"silent").toUpperCase();if(typeof window===t)return;try{window.localStorage[c]=n;return}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}function l(){var e;if(typeof window===t)return;try{e=window.localStorage[c]}catch(e){}if(typeof e===t){try{var r=window.document.cookie;var n=r.indexOf(encodeURIComponent(c)+"=");if(n!==-1){e=/^([^;]+)/.exec(r.slice(n))[1]}}catch(e){}}if(u.levels[e]===undefined){e=undefined}return e}u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};u.methodFactory=i||a;u.getLevel=function(){return s};u.setLevel=function(r,n){if(typeof r==="string"&&u.levels[r.toUpperCase()]!==undefined){r=u.levels[r.toUpperCase()]}if(typeof r==="number"&&r>=0&&r<=u.levels.SILENT){s=r;if(n!==false){f(r)}o.call(u,r,e);if(typeof console===t&&r<u.levels.SILENT){return"No console available for logging"}}else{throw"log.setLevel() called with invalid level: "+r}};u.setDefaultLevel=function(e){if(!l()){u.setLevel(e,false)}};u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)};u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)};var h=l();if(h==null){h=n==null?"WARN":n}u.setLevel(h,false)}var c=new s;var f={};c.getLogger=function e(t){if(typeof t!=="string"||t===""){throw new TypeError("You must supply a name when creating a logger.")}var r=f[t];if(!r){r=f[t]=new s(t,c.getLevel(),c.methodFactory)}return r};var l=typeof window!==t?window.log:undefined;c.noConflict=function(){if(typeof window!==t&&window.log===c){window.log=l}return c};return c})},function(e,t,r){"use strict";function n(){this._cache=i();this._timeouts=i()}n.prototype.get=function(e){return this._cache[e]};n.prototype.set=function(e,t,r){this.delete(e);this._cache[e]=t;if(r){this._timeouts[e]=setTimeout(this.delete.bind(this,e),r*1e3)}};n.prototype.delete=function(e){delete this._cache[e];if(e in this._timeouts){clearTimeout(this._timeouts[e]);delete this._timeouts[e]}};n.prototype.clear=function(){this._cache=i();for(var e in this._timeouts){clearTimeout(this._timeouts[e])}this._timeouts=i()};function i(){return Object.create(null)}e.exports=n},function(e,t,r){var n=r(30);function i(e){return n(e)&&e!=+e}e.exports=i},function(e,t){function r(){this.__data__=[];this.size=0}e.exports=r},function(e,t,r){var n=r(48);var i=Array.prototype;var o=i.splice;function u(e){var t=this.__data__,r=n(t,e);if(r<0){return false}var i=t.length-1;if(r==i){t.pop()}else{o.call(t,r,1)}--this.size;return true}e.exports=u},function(e,t,r){var n=r(48);function i(e){var t=this.__data__,r=n(t,e);return r<0?undefined:t[r][1]}e.exports=i},function(e,t,r){var n=r(48);function i(e){return n(this.__data__,e)>-1}e.exports=i},function(e,t,r){var n=r(48);function i(e,t){var r=this.__data__,i=n(r,e);if(i<0){++this.size;r.push([e,t])}else{r[i][1]=t}return this}e.exports=i},function(e,t,r){var n=r(47);function i(){this.__data__=new n;this.size=0}e.exports=i},function(e,t){function r(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}e.exports=r},function(e,t){function r(e){return this.__data__.get(e)}e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){var n=r(47),i=r(73),o=r(79);var u=200;function a(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!i||a.length<u-1){a.push([e,t]);this.size=++r.size;return this}r=this.__data__=new o(a)}r.set(e,t);this.size=r.size;return this}e.exports=a},function(e,t,r){var n=r(269),i=r(47),o=r(73);function u(){this.size=0;this.__data__={hash:new n,map:new(o||i),string:new n}}e.exports=u},function(e,t,r){var n=r(270),i=r(271),o=r(272),u=r(273),a=r(274);function s(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=n;s.prototype["delete"]=i;s.prototype.get=o;s.prototype.has=u;s.prototype.set=a;e.exports=s},function(e,t,r){var n=r(49);function i(){this.__data__=n?n(null):{};this.size=0}e.exports=i},function(e,t){function r(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}e.exports=r},function(e,t,r){var n=r(49);var i="__lodash_hash_undefined__";var o=Object.prototype;var u=o.hasOwnProperty;function a(e){var t=this.__data__;if(n){var r=t[e];return r===i?undefined:r}return u.call(t,e)?t[e]:undefined}e.exports=a},function(e,t,r){var n=r(49);var i=Object.prototype;var o=i.hasOwnProperty;function u(e){var t=this.__data__;return n?t[e]!==undefined:o.call(t,e)}e.exports=u},function(e,t,r){var n=r(49);var i="__lodash_hash_undefined__";function o(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=n&&t===undefined?i:t;return this}e.exports=o},function(e,t,r){var n=r(50);function i(e){var t=n(this,e)["delete"](e);this.size-=t?1:0;return t}e.exports=i},function(e,t){function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}e.exports=r},function(e,t,r){var n=r(50);function i(e){return n(this,e).get(e)}e.exports=i},function(e,t,r){var n=r(50);function i(e){return n(this,e).has(e)}e.exports=i},function(e,t,r){var n=r(50);function i(e,t){var r=n(this,e),i=r.size;r.set(e,t);this.size+=r.size==i?0:1;return this}e.exports=i},function(e,t,r){var n=r(27),i=r(21);function o(e,t){return e&&n(t,i(t),e)}e.exports=o},function(e,t,r){var n=r(27),i=r(46);function o(e,t){return e&&n(t,i(t),e)}e.exports=o},function(e,t,r){(function(e){var n=r(13);var i=typeof t=="object"&&t&&!t.nodeType&&t;var o=i&&typeof e=="object"&&e&&!e.nodeType&&e;var u=o&&o.exports===i;var a=u?n.Buffer:undefined,s=a?a.allocUnsafe:undefined;function c(e,t){if(t){return e.slice()}var r=e.length,n=s?s(r):new e.constructor(r);e.copy(n);return n}e.exports=c}).call(t,r(41)(e))},function(e,t){function r(e,t){var r=-1,n=e.length;t||(t=Array(n));while(++r<n){t[r]=e[r]}return t}e.exports=r},function(e,t,r){var n=r(27),i=r(80);function o(e,t){return n(e,i(e),t)}e.exports=o},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length,i=0,o=[];while(++r<n){var u=e[r];if(t(u,r,e)){o[i++]=u}}return o}e.exports=r},function(e,t,r){var n=r(27),i=r(122);function o(e,t){return n(e,i(e),t)}e.exports=o},function(e,t,r){var n=r(124),i=r(122),o=r(46);function u(e){return n(e,o,i)}e.exports=u},function(e,t){var r=Object.prototype;var n=r.hasOwnProperty;function i(e){var t=e.length,r=new e.constructor(t);if(t&&typeof e[0]=="string"&&n.call(e,"index")){r.index=e.index;r.input=e.input}return r}e.exports=i},function(e,t,r){var n=r(81),i=r(290),o=r(291),u=r(292),a=r(293);var s="[object Boolean]",c="[object Date]",f="[object Map]",l="[object Number]",h="[object RegExp]",d="[object Set]",p="[object String]",v="[object Symbol]";var y="[object ArrayBuffer]",b="[object DataView]",_="[object Float32Array]",g="[object Float64Array]",m="[object Int8Array]",w="[object Int16Array]",O="[object Int32Array]",k="[object Uint8Array]",P="[object Uint8ClampedArray]",E="[object Uint16Array]",j="[object Uint32Array]";function S(e,t,r){var S=e.constructor;switch(t){case y:return n(e);case s:case c:return new S(+e);case b:return i(e,r);case _:case g:case m:case w:case O:case k:case P:case E:case j:return a(e,r);case f:return new S;case l:case p:return new S(e);case h:return o(e);case d:return new S;case v:return u(e)}}e.exports=S},function(e,t,r){var n=r(81);function i(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}e.exports=i},function(e,t){var r=/\w*$/;function n(e){var t=new e.constructor(e.source,r.exec(e));t.lastIndex=e.lastIndex;return t}e.exports=n},function(e,t,r){var n=r(29);var i=n?n.prototype:undefined,o=i?i.valueOf:undefined;function u(e){return o?Object(o.call(e)):{}}e.exports=u},function(e,t,r){var n=r(81);function i(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}e.exports=i},function(e,t,r){var n=r(295),i=r(70),o=r(32);function u(e){return typeof e.constructor=="function"&&!o(e)?n(i(e)):{}}e.exports=u},function(e,t,r){var n=r(11);var i=Object.create;var o=function(){function e(){}return function(t){if(!n(t)){return{}}if(i){return i(t)}e.prototype=t;var r=new e;e.prototype=undefined;return r}}();e.exports=o},function(e,t,r){var n=r(297),i=r(68),o=r(69);var u=o&&o.isMap;var a=u?i(u):n;e.exports=a},function(e,t,r){var n=r(34),i=r(14);var o="[object Map]";function u(e){return i(e)&&n(e)==o}e.exports=u},function(e,t,r){var n=r(299),i=r(68),o=r(69);var u=o&&o.isSet;var a=u?i(u):n;e.exports=a},function(e,t,r){var n=r(34),i=r(14);var o="[object Set]";function u(e){return i(e)&&n(e)==o}e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(301);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LiveCollectionManager=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();t.getLiveCollectionManager=h;var i=r(2);var o=r(7);var u=r(1);var a=r(9);var s=r(51);function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=t.LiveCollectionManager=function(){function e(t){c(this,e);this._client=t||o.Client.sharedInstance()}n(e,[{key:"subscribeCollection",value:function e(t,r){var n=this;if(!(0,s.isValidChannelName)(t)){return i.Promise.reject(new u.KinveyError("Invalid or missing collection name"))}if(!(0,s.isValidReceiver)(r)){return i.Promise.reject(new u.KinveyError("Invalid or missing receiver"))}return this._makeSubscriptionRequest(t,"_subscribe").then(function(){var e=n._buildChannelName(t);var i=n._buildPersonalChannelName(t);var o=(0,s.getLiveService)();o.subscribeToChannel(e,r);o.subscribeToChannel(i,r)})}},{key:"unsubscribeCollection",value:function e(t){var r=this;if(!(0,s.isValidChannelName)(t)){return i.Promise.reject(new u.KinveyError("Invalid or missing collection name"))}return this._makeSubscriptionRequest(t,"_unsubscribe").then(function(){var e=r._buildChannelName(t);var n=r._buildPersonalChannelName(t);var i=(0,s.getLiveService)();i.unsubscribeFromChannel(e);i.unsubscribeFromChannel(n)})}},{key:"_buildChannelName",value:function e(t){return this._client.appKey+".c-"+t}},{key:"_buildPersonalChannelName",value:function e(t){var r=this._buildChannelName(t);var n=this._client.getActiveUser()._id;return r+".u-"+n}},{key:"_makeSubscriptionRequest",value:function e(t,r){return a.KinveyRequest.execute({method:a.RequestMethod.POST,pathname:"/appdata/"+this._client.appKey+"/"+t+"/"+r,body:{deviceId:this._client.deviceId}})}}]);return e}();var l=void 0;function h(e){if(!l){l=new f(e)}return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(303);var i=l(n);var o=r(332);var u=l(o);var a=r(333);var s=l(a);var c=r(334);var f=r(4);function l(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){p(t,e);function t(e){h(this,t);e.db=new s.default;e.networking=new u.default({del:c.del,get:c.get,post:c.post});e.sdkFamily="NativeScript";return d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return t}(i.default);t.default=v;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(28);var o=pe(i);var u=r(126);var a=pe(u);var s=r(306);var c=pe(s);var f=r(127);var l=pe(f);var h=r(309);var d=pe(h);var p=r(310);var v=de(p);var y=r(311);var b=de(y);var _=r(312);var g=de(_);var m=r(313);var w=de(m);var O=r(314);var k=de(O);var P=r(315);var E=de(P);var j=r(316);var S=de(j);var C=r(317);var M=de(C);var T=r(318);var A=de(T);var x=r(319);var R=de(x);var I=r(320);var N=de(I);var D=r(321);var q=de(D);var U=r(322);var K=de(U);var L=r(323);var F=de(L);var B=r(324);var G=de(B);var H=r(325);var z=de(H);var Q=r(326);var V=de(Q);var $=r(327);var W=de($);var Y=r(328);var J=de(Y);var X=r(329);var Z=de(X);var ee=r(330);var te=de(ee);var re=r(128);var ne=de(re);var ie=r(331);var oe=de(ie);var ue=r(5);var ae=pe(ue);var se=r(52);var ce=pe(se);var fe=r(4);var le=r(82);var he=pe(le);function de(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function pe(e){return e&&e.__esModule?e:{default:e}}function ve(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var ye=function(){function e(t){var r=this;ve(this,e);var n=t.db,i=t.networking;var u=this._config=new o.default({setup:t,db:n});var s=new a.default({config:u});i.init(u);var f={config:u,networking:i,crypto:s};var h=d.default.bind(this,f,ne);var p=d.default.bind(this,f,R);var y=d.default.bind(this,f,q);var _=d.default.bind(this,f,F);var m=d.default.bind(this,f,oe);var O=this._listenerManager=new l.default;var P=new c.default({timeEndpoint:h,leaveEndpoint:p,heartbeatEndpoint:y,setStateEndpoint:_,subscribeEndpoint:m,crypto:f.crypto,config:f.config,listenerManager:O});this.addListener=O.addListener.bind(O);this.removeListener=O.removeListener.bind(O);this.removeAllListeners=O.removeAllListeners.bind(O);this.channelGroups={listGroups:d.default.bind(this,f,w),listChannels:d.default.bind(this,f,k),addChannels:d.default.bind(this,f,v),removeChannels:d.default.bind(this,f,b),deleteGroup:d.default.bind(this,f,g)};this.push={addChannels:d.default.bind(this,f,E),removeChannels:d.default.bind(this,f,S),deleteDevice:d.default.bind(this,f,A),listChannels:d.default.bind(this,f,M)};this.hereNow=d.default.bind(this,f,G);this.whereNow=d.default.bind(this,f,N);this.getState=d.default.bind(this,f,K);this.setState=P.adaptStateChange.bind(P);this.grant=d.default.bind(this,f,V);this.audit=d.default.bind(this,f,z);this.publish=d.default.bind(this,f,W);this.fire=function(e,t){e.replicate=false;e.storeInHistory=false;return r.publish(e,t)};this.history=d.default.bind(this,f,J);this.deleteMessages=d.default.bind(this,f,Z);this.fetchMessages=d.default.bind(this,f,te);this.time=h;this.subscribe=P.adaptSubscribeChange.bind(P);this.presence=P.adaptPresenceChange.bind(P);this.unsubscribe=P.adaptUnsubscribeChange.bind(P);this.disconnect=P.disconnect.bind(P);this.reconnect=P.reconnect.bind(P);this.destroy=function(e){P.unsubscribeAll(e);P.disconnect()};this.stop=this.destroy;this.unsubscribeAll=P.unsubscribeAll.bind(P);this.getSubscribedChannels=P.getSubscribedChannels.bind(P);this.getSubscribedChannelGroups=P.getSubscribedChannelGroups.bind(P);this.encrypt=s.encrypt.bind(s);this.decrypt=s.decrypt.bind(s);this.getAuthKey=f.config.getAuthKey.bind(f.config);this.setAuthKey=f.config.setAuthKey.bind(f.config);this.setCipherKey=f.config.setCipherKey.bind(f.config);this.getUUID=f.config.getUUID.bind(f.config);this.setUUID=f.config.setUUID.bind(f.config);this.getFilterExpression=f.config.getFilterExpression.bind(f.config);this.setFilterExpression=f.config.setFilterExpression.bind(f.config);this.setHeartbeatInterval=f.config.setHeartbeatInterval.bind(f.config);if(i.hasModule("proxy")){this.setProxy=function(e){f.config.setProxy(e);r.reconnect()}}}n(e,[{key:"getVersion",value:function e(){return this._config.getVersion()}},{key:"networkDownDetected",value:function e(){this._listenerManager.announceNetworkDown();if(this._config.restore){this.disconnect()}else{this.destroy(true)}}},{key:"networkUpDetected",value:function e(){this._listenerManager.announceNetworkUp();this.reconnect()}}],[{key:"generateUUID",value:function e(){return he.default.createUUID()}}]);return e}();ye.OPERATIONS=ae.default;ye.CATEGORIES=ce.default;t.default=ye;e.exports=t["default"]},function(e,t,r){var n,i,o;(function(r,u){if(true){!(i=[t],n=u,o=typeof n==="function"?n.apply(t,i):n,o!==undefined&&(e.exports=o))}else if(typeof t==="object"){u(t);if(typeof e==="object"&&e!==null){e.exports=t.uuid}}else{u(r.lil=r.lil||{})}})(this,function(e){var t="0.1.0";var r={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function n(){var e="",t,r;for(t=0;t<32;t++){r=Math.random()*16|0;if(t===8||t===12||t===16||t===20)e+="-";e+=(t===12?4:t===16?r&3|8:r).toString(16)}return e}function i(e,t){var n=r[t||"all"];return n&&n.test(e)||false}n.isUUID=i;n.VERSION=t;e.uuid=n;e.isUUID=i})},function(e,t,r){"use strict";var n=n||function(e,t){var r={},n=r.lib={},i=function e(){},o=n.Base={extend:function e(t){i.prototype=this;var r=new i;t&&r.mixIn(t);r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)});r.init.prototype=r;r.$super=this;return r},create:function e(){var t=this.extend();t.init.apply(t,arguments);return t},init:function e(){},mixIn:function e(t){for(var r in t){t.hasOwnProperty(r)&&(this[r]=t[r])}t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function e(){return this.init.prototype.extend(this)}},u=n.WordArray=o.extend({init:function e(r,n){r=this.words=r||[];this.sigBytes=n!=t?n:4*r.length},toString:function e(t){return(t||s).stringify(this)},concat:function e(t){var r=this.words,n=t.words,i=this.sigBytes;t=t.sigBytes;this.clamp();if(i%4)for(var o=0;o<t;o++){r[i+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((i+o)%4)}else if(65535<n.length)for(o=0;o<t;o+=4){r[i+o>>>2]=n[o>>>2]}else r.push.apply(r,n);this.sigBytes+=t;return this},clamp:function t(){var r=this.words,n=this.sigBytes;r[n>>>2]&=4294967295<<32-8*(n%4);r.length=e.ceil(n/4)},clone:function e(){var t=o.clone.call(this);t.words=this.words.slice(0);return t},random:function t(r){for(var n=[],i=0;i<r;i+=4){n.push(4294967296*e.random()|0)}return new u.init(n,r)}}),a=r.enc={},s=a.Hex={stringify:function e(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var o=r[i>>>2]>>>24-8*(i%4)&255;n.push((o>>>4).toString(16));n.push((o&15).toString(16))}return n.join("")},parse:function e(t){for(var r=t.length,n=[],i=0;i<r;i+=2){n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8)}return new u.init(n,r/2)}},c=a.Latin1={stringify:function e(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){n.push(String.fromCharCode(r[i>>>2]>>>24-8*(i%4)&255))}return n.join("")},parse:function e(t){for(var r=t.length,n=[],i=0;i<r;i++){n[i>>>2]|=(t.charCodeAt(i)&255)<<24-8*(i%4)}return new u.init(n,r)}},f=a.Utf8={stringify:function e(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function e(t){return c.parse(unescape(encodeURIComponent(t)))}},l=n.BufferedBlockAlgorithm=o.extend({reset:function e(){this._data=new u.init;this._nDataBytes=0},_append:function e(t){"string"==typeof t&&(t=f.parse(t));this._data.concat(t);this._nDataBytes+=t.sigBytes},_process:function t(r){var n=this._data,i=n.words,o=n.sigBytes,a=this.blockSize,s=o/(4*a),s=r?e.ceil(s):e.max((s|0)-this._minBufferSize,0);r=s*a;o=e.min(4*r,o);if(r){for(var c=0;c<r;c+=a){this._doProcessBlock(i,c)}c=i.splice(0,r);n.sigBytes-=o}return new u.init(c,o)},clone:function e(){var t=o.clone.call(this);t._data=this._data.clone();return t},_minBufferSize:0});n.Hasher=l.extend({cfg:o.extend(),init:function e(t){this.cfg=this.cfg.extend(t);this.reset()},reset:function e(){l.reset.call(this);this._doReset()},update:function e(t){this._append(t);this._process();return this},finalize:function e(t){t&&this._append(t);return this._doFinalize()},blockSize:16,_createHelper:function e(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function e(t){return function(e,r){return new h.HMAC.init(t,r).finalize(e)}}});var h=r.algo={};return r}(Math);(function(e){for(var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,r=t.algo,u=[],a=[],s=function e(t){return 4294967296*(t-(t|0))|0},c=2,f=0;64>f;){var l;e:{l=c;for(var h=e.sqrt(l),d=2;d<=h;d++){if(!(l%d)){l=!1;break e}}l=!0}l&&(8>f&&(u[f]=s(e.pow(c,.5))),a[f]=s(e.pow(c,1/3)),f++);c++}var p=[],r=r.SHA256=o.extend({_doReset:function e(){this._hash=new i.init(u.slice(0))},_doProcessBlock:function e(t,r){for(var n=this._hash.words,i=n[0],o=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],h=n[7],d=0;64>d;d++){if(16>d)p[d]=t[r+d]|0;else{var v=p[d-15],y=p[d-2];p[d]=((v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3)+p[d-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+p[d-16]}v=h+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&f^~c&l)+a[d]+p[d];y=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&o^i&u^o&u);h=l;l=f;f=c;c=s+v|0;s=u;u=o;o=i;i=v+y|0}n[0]=n[0]+i|0;n[1]=n[1]+o|0;n[2]=n[2]+u|0;n[3]=n[3]+s|0;n[4]=n[4]+c|0;n[5]=n[5]+f|0;n[6]=n[6]+l|0;n[7]=n[7]+h|0},_doFinalize:function t(){var r=this._data,n=r.words,i=8*this._nDataBytes,o=8*r.sigBytes;n[o>>>5]|=128<<24-o%32;n[(o+64>>>9<<4)+14]=e.floor(i/4294967296);n[(o+64>>>9<<4)+15]=i;r.sigBytes=4*n.length;this._process();return this._hash},clone:function e(){var t=o.clone.call(this);t._hash=this._hash.clone();return t}});t.SHA256=o._createHelper(r);t.HmacSHA256=o._createHmacHelper(r)})(Math);(function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function e(r,n){r=this._hasher=new r.init;"string"==typeof n&&(n=t.parse(n));var i=r.blockSize,o=4*i;n.sigBytes>o&&(n=r.finalize(n));n.clamp();for(var u=this._oKey=n.clone(),a=this._iKey=n.clone(),s=u.words,c=a.words,f=0;f<i;f++){s[f]^=1549556828,c[f]^=909522486}u.sigBytes=a.sigBytes=o;this.reset()},reset:function e(){var t=this._hasher;t.reset();t.update(this._iKey)},update:function e(t){this._hasher.update(t);return this},finalize:function e(t){var r=this._hasher;t=r.finalize(t);r.reset();return r.finalize(this._oKey.clone().concat(t))}})})();(function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function e(t){var r=t.words,n=t.sigBytes,i=this._map;t.clamp();t=[];for(var o=0;o<n;o+=3){for(var u=(r[o>>>2]>>>24-8*(o%4)&255)<<16|(r[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|r[o+2>>>2]>>>24-8*((o+2)%4)&255,a=0;4>a&&o+.75*a<n;a++){t.push(i.charAt(u>>>6*(3-a)&63))}}if(r=i.charAt(64))for(;t.length%4;){t.push(r)}return t.join("")},parse:function e(r){var n=r.length,i=this._map,o=i.charAt(64);o&&(o=r.indexOf(o),-1!=o&&(n=o));for(var o=[],u=0,a=0;a<n;a++){if(a%4){var s=i.indexOf(r.charAt(a-1))<<2*(a%4),c=i.indexOf(r.charAt(a))>>>6-2*(a%4);o[u>>>2]|=(s|c)<<24-8*(u%4);u++}}return t.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(e,t,r,n,i,o,u){e=e+(t&r|~t&n)+i+u;return(e<<o|e>>>32-o)+t}function r(e,t,r,n,i,o,u){e=e+(t&n|r&~n)+i+u;return(e<<o|e>>>32-o)+t}function i(e,t,r,n,i,o,u){e=e+(t^r^n)+i+u;return(e<<o|e>>>32-o)+t}function o(e,t,r,n,i,o,u){e=e+(r^(t|~n))+i+u;return(e<<o|e>>>32-o)+t}for(var u=n,a=u.lib,s=a.WordArray,c=a.Hasher,a=u.algo,f=[],l=0;64>l;l++){f[l]=4294967296*e.abs(e.sin(l+1))|0}a=a.MD5=c.extend({_doReset:function e(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function e(n,u){for(var a=0;16>a;a++){var s=u+a,c=n[s];n[s]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}var a=this._hash.words,s=n[u+0],c=n[u+1],l=n[u+2],h=n[u+3],d=n[u+4],p=n[u+5],v=n[u+6],y=n[u+7],b=n[u+8],_=n[u+9],g=n[u+10],m=n[u+11],w=n[u+12],O=n[u+13],k=n[u+14],P=n[u+15],E=a[0],j=a[1],S=a[2],C=a[3],E=t(E,j,S,C,s,7,f[0]),C=t(C,E,j,S,c,12,f[1]),S=t(S,C,E,j,l,17,f[2]),j=t(j,S,C,E,h,22,f[3]),E=t(E,j,S,C,d,7,f[4]),C=t(C,E,j,S,p,12,f[5]),S=t(S,C,E,j,v,17,f[6]),j=t(j,S,C,E,y,22,f[7]),E=t(E,j,S,C,b,7,f[8]),C=t(C,E,j,S,_,12,f[9]),S=t(S,C,E,j,g,17,f[10]),j=t(j,S,C,E,m,22,f[11]),E=t(E,j,S,C,w,7,f[12]),C=t(C,E,j,S,O,12,f[13]),S=t(S,C,E,j,k,17,f[14]),j=t(j,S,C,E,P,22,f[15]),E=r(E,j,S,C,c,5,f[16]),C=r(C,E,j,S,v,9,f[17]),S=r(S,C,E,j,m,14,f[18]),j=r(j,S,C,E,s,20,f[19]),E=r(E,j,S,C,p,5,f[20]),C=r(C,E,j,S,g,9,f[21]),S=r(S,C,E,j,P,14,f[22]),j=r(j,S,C,E,d,20,f[23]),E=r(E,j,S,C,_,5,f[24]),C=r(C,E,j,S,k,9,f[25]),S=r(S,C,E,j,h,14,f[26]),j=r(j,S,C,E,b,20,f[27]),E=r(E,j,S,C,O,5,f[28]),C=r(C,E,j,S,l,9,f[29]),S=r(S,C,E,j,y,14,f[30]),j=r(j,S,C,E,w,20,f[31]),E=i(E,j,S,C,p,4,f[32]),C=i(C,E,j,S,b,11,f[33]),S=i(S,C,E,j,m,16,f[34]),j=i(j,S,C,E,k,23,f[35]),E=i(E,j,S,C,c,4,f[36]),C=i(C,E,j,S,d,11,f[37]),S=i(S,C,E,j,y,16,f[38]),j=i(j,S,C,E,g,23,f[39]),E=i(E,j,S,C,O,4,f[40]),C=i(C,E,j,S,s,11,f[41]),S=i(S,C,E,j,h,16,f[42]),j=i(j,S,C,E,v,23,f[43]),E=i(E,j,S,C,_,4,f[44]),C=i(C,E,j,S,w,11,f[45]),S=i(S,C,E,j,P,16,f[46]),j=i(j,S,C,E,l,23,f[47]),E=o(E,j,S,C,s,6,f[48]),C=o(C,E,j,S,y,10,f[49]),S=o(S,C,E,j,k,15,f[50]),j=o(j,S,C,E,p,21,f[51]),E=o(E,j,S,C,w,6,f[52]),C=o(C,E,j,S,h,10,f[53]),S=o(S,C,E,j,g,15,f[54]),j=o(j,S,C,E,c,21,f[55]),E=o(E,j,S,C,b,6,f[56]),C=o(C,E,j,S,P,10,f[57]),S=o(S,C,E,j,v,15,f[58]),j=o(j,S,C,E,O,21,f[59]),E=o(E,j,S,C,d,6,f[60]),C=o(C,E,j,S,m,10,f[61]),S=o(S,C,E,j,l,15,f[62]),j=o(j,S,C,E,_,21,f[63]);a[0]=a[0]+E|0;a[1]=a[1]+j|0;a[2]=a[2]+S|0;a[3]=a[3]+C|0},_doFinalize:function t(){var r=this._data,n=r.words,i=8*this._nDataBytes,o=8*r.sigBytes;n[o>>>5]|=128<<24-o%32;var u=e.floor(i/4294967296);n[(o+64>>>9<<4)+15]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360;n[(o+64>>>9<<4)+14]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;r.sigBytes=4*(n.length+1);this._process();r=this._hash;n=r.words;for(i=0;4>i;i++){o=n[i],n[i]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360}return r},clone:function e(){var t=c.clone.call(this);t._hash=this._hash.clone();return t}});u.MD5=c._createHelper(a);u.HmacMD5=c._createHmacHelper(a)})(Math);(function(){var e=n,t=e.lib,r=t.Base,i=t.WordArray,t=e.algo,o=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function e(t){this.cfg=this.cfg.extend(t)},compute:function e(t,r){for(var n=this.cfg,o=n.hasher.create(),u=i.create(),a=u.words,s=n.keySize,n=n.iterations;a.length<s;){c&&o.update(c);var c=o.update(t).finalize(r);o.reset();for(var f=1;f<n;f++){c=o.finalize(c),o.reset()}u.concat(c)}u.sigBytes=4*s;return u}});e.EvpKDF=function(e,t,r){return o.create(r).compute(e,t)}})();n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,o=r.WordArray,u=r.BufferedBlockAlgorithm,a=t.enc.Base64,s=t.algo.EvpKDF,c=r.Cipher=u.extend({cfg:i.extend(),createEncryptor:function e(t,r){return this.create(this._ENC_XFORM_MODE,t,r)},createDecryptor:function e(t,r){return this.create(this._DEC_XFORM_MODE,t,r)},init:function e(t,r,n){this.cfg=this.cfg.extend(n);this._xformMode=t;this._key=r;this.reset()},reset:function e(){u.reset.call(this);this._doReset()},process:function e(t){this._append(t);return this._process()},finalize:function e(t){t&&this._append(t);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function e(t){return{encrypt:function e(r,n,i){return("string"==typeof n?v:p).encrypt(t,r,n,i)},decrypt:function e(r,n,i){return("string"==typeof n?v:p).decrypt(t,r,n,i)}}}});r.StreamCipher=c.extend({_doFinalize:function e(){return this._process(!0)},blockSize:1});var f=t.mode={},l=function t(r,n,i){var o=this._iv;o?this._iv=e:o=this._prevBlock;for(var u=0;u<i;u++){r[n+u]^=o[u]}},h=(r.BlockCipherMode=i.extend({createEncryptor:function e(t,r){return this.Encryptor.create(t,r)},createDecryptor:function e(t,r){return this.Decryptor.create(t,r)},init:function e(t,r){this._cipher=t;this._iv=r}})).extend();h.Encryptor=h.extend({processBlock:function e(t,r){var n=this._cipher,i=n.blockSize;l.call(this,t,r,i);n.encryptBlock(t,r);this._prevBlock=t.slice(r,r+i)}});h.Decryptor=h.extend({processBlock:function e(t,r){var n=this._cipher,i=n.blockSize,o=t.slice(r,r+i);n.decryptBlock(t,r);l.call(this,t,r,i);this._prevBlock=o}});f=f.CBC=h;h=(t.pad={}).Pkcs7={pad:function e(t,r){for(var n=4*r,n=n-t.sigBytes%n,i=n<<24|n<<16|n<<8|n,u=[],a=0;a<n;a+=4){u.push(i)}n=o.create(u,n);t.concat(n)},unpad:function e(t){t.sigBytes-=t.words[t.sigBytes-1>>>2]&255}};r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:f,padding:h}),reset:function e(){c.reset.call(this);var t=this.cfg,r=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,r&&r.words)},_doProcessBlock:function e(t,r){this._mode.processBlock(t,r)},_doFinalize:function e(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var r=this._process(!0)}else r=this._process(!0),t.unpad(r);return r},blockSize:4});var d=r.CipherParams=i.extend({init:function e(t){this.mixIn(t)},toString:function e(t){return(t||this.formatter).stringify(this)}}),f=(t.format={}).OpenSSL={stringify:function e(t){var r=t.ciphertext;t=t.salt;return(t?o.create([1398893684,1701076831]).concat(t).concat(r):r).toString(a)},parse:function e(t){t=a.parse(t);var r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=o.create(r.slice(2,4));r.splice(0,4);t.sigBytes-=16}return d.create({ciphertext:t,salt:n})}},p=r.SerializableCipher=i.extend({cfg:i.extend({format:f}),encrypt:function e(t,r,n,i){i=this.cfg.extend(i);var o=t.createEncryptor(n,i);r=o.finalize(r);o=o.cfg;return d.create({ciphertext:r,key:n,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function e(t,r,n,i){i=this.cfg.extend(i);r=this._parse(r,i.format);return t.createDecryptor(n,i).finalize(r.ciphertext)},_parse:function e(t,r){return"string"==typeof t?r.parse(t,this):t}}),t=(t.kdf={}).OpenSSL={execute:function e(t,r,n,i){i||(i=o.random(8));t=s.create({keySize:r+n}).compute(t,i);n=o.create(t.words.slice(r),4*n);t.sigBytes=4*r;return d.create({key:t,iv:n,salt:i})}},v=r.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:t}),encrypt:function e(t,r,n,i){i=this.cfg.extend(i);n=i.kdf.execute(n,t.keySize,t.ivSize);i.iv=n.iv;t=p.encrypt.call(this,t,r,n.key,i);t.mixIn(n);return t},decrypt:function e(t,r,n,i){i=this.cfg.extend(i);r=this._parse(r,i.format);n=i.kdf.execute(n,t.keySize,t.ivSize,r.salt);i.iv=n.iv;return p.decrypt.call(this,t,r,n.key,i)}})}();(function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],o=[],u=[],a=[],s=[],c=[],f=[],l=[],h=[],d=[],p=[],v=0;256>v;v++){p[v]=128>v?v<<1:v<<1^283}for(var y=0,b=0,v=0;256>v;v++){var _=b^b<<1^b<<2^b<<3^b<<4,_=_>>>8^_&255^99;i[y]=_;o[_]=y;var g=p[y],m=p[g],w=p[m],O=257*p[_]^16843008*_;u[y]=O<<24|O>>>8;a[y]=O<<16|O>>>16;s[y]=O<<8|O>>>24;c[y]=O;O=16843009*w^65537*m^257*g^16843008*y;f[_]=O<<24|O>>>8;l[_]=O<<16|O>>>16;h[_]=O<<8|O>>>24;d[_]=O;y?(y=g^p[p[p[w^g]]],b^=p[p[b]]):y=b=1}var k=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function e(){for(var t=this._key,r=t.words,n=t.sigBytes/4,t=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],u=0;u<t;u++){if(u<n)o[u]=r[u];else{var a=o[u-1];u%n?6<n&&4==u%n&&(a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[a&255]):(a=a<<8|a>>>24,a=i[a>>>24]<<24|i[a>>>16&255]<<16|i[a>>>8&255]<<8|i[a&255],a^=k[u/n|0]<<24);o[u]=o[u-n]^a}}r=this._invKeySchedule=[];for(n=0;n<t;n++){u=t-n,a=n%4?o[u]:o[u-4],r[n]=4>n||4>=u?a:f[i[a>>>24]]^l[i[a>>>16&255]]^h[i[a>>>8&255]]^d[i[a&255]]}},encryptBlock:function e(t,r){this._doCryptBlock(t,r,this._keySchedule,u,a,s,c,i)},decryptBlock:function e(t,r){var n=t[r+1];t[r+1]=t[r+3];t[r+3]=n;this._doCryptBlock(t,r,this._invKeySchedule,f,l,h,d,o);n=t[r+1];t[r+1]=t[r+3];t[r+3]=n},_doCryptBlock:function e(t,r,n,i,o,u,a,s){for(var c=this._nRounds,f=t[r]^n[0],l=t[r+1]^n[1],h=t[r+2]^n[2],d=t[r+3]^n[3],p=4,v=1;v<c;v++){var y=i[f>>>24]^o[l>>>16&255]^u[h>>>8&255]^a[d&255]^n[p++],b=i[l>>>24]^o[h>>>16&255]^u[d>>>8&255]^a[f&255]^n[p++],_=i[h>>>24]^o[d>>>16&255]^u[f>>>8&255]^a[l&255]^n[p++],d=i[d>>>24]^o[f>>>16&255]^u[l>>>8&255]^a[h&255]^n[p++],f=y,l=b,h=_}y=(s[f>>>24]<<24|s[l>>>16&255]<<16|s[h>>>8&255]<<8|s[d&255])^n[p++];b=(s[l>>>24]<<24|s[h>>>16&255]<<16|s[d>>>8&255]<<8|s[f&255])^n[p++];_=(s[h>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[l&255])^n[p++];d=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[l>>>8&255]<<8|s[h&255])^n[p++];t[r]=y;t[r+1]=b;t[r+2]=_;t[r+3]=d},keySize:8});e.AES=t._createHelper(r)})();n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:function e(t,r){this._cipher.encryptBlock(t,r)}});e.Decryptor=e.extend({processBlock:function e(t,r){this._cipher.decryptBlock(t,r)}});return e}();e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(126);var o=g(i);var u=r(28);var a=g(u);var s=r(127);var c=g(s);var f=r(307);var l=g(f);var h=r(308);var d=g(h);var p=r(8);var v=g(p);var y=r(4);var b=r(52);var _=g(b);function g(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=function(){function e(t){var r=t.subscribeEndpoint,n=t.leaveEndpoint,i=t.heartbeatEndpoint,o=t.setStateEndpoint,u=t.timeEndpoint,a=t.config,s=t.crypto,c=t.listenerManager;m(this,e);this._listenerManager=c;this._config=a;this._leaveEndpoint=n;this._heartbeatEndpoint=i;this._setStateEndpoint=o;this._subscribeEndpoint=r;this._crypto=s;this._channels={};this._presenceChannels={};this._heartbeatChannels={};this._heartbeatChannelGroups={};this._channelGroups={};this._presenceChannelGroups={};this._pendingChannelSubscriptions=[];this._pendingChannelGroupSubscriptions=[];this._currentTimetoken=0;this._lastTimetoken=0;this._storedTimetoken=null;this._subscriptionStatusAnnounced=false;this._isOnline=true;this._reconnectionManager=new l.default({timeEndpoint:u});this._dedupingManager=new d.default({config:a})}n(e,[{key:"adaptStateChange",value:function e(t,r){var n=this;var i=t.state,o=t.channels,u=o===undefined?[]:o,a=t.channelGroups,s=a===undefined?[]:a;u.forEach(function(e){if(e in n._channels)n._channels[e].state=i});s.forEach(function(e){if(e in n._channelGroups)n._channelGroups[e].state=i});return this._setStateEndpoint({state:i,channels:u,channelGroups:s},r)}},{key:"adaptPresenceChange",value:function e(t){var r=this;var n=t.connected,i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u;if(n){o.forEach(function(e){r._heartbeatChannels[e]={state:{}}});a.forEach(function(e){r._heartbeatChannelGroups[e]={state:{}}})}else{o.forEach(function(e){if(e in r._heartbeatChannels){delete r._heartbeatChannels[e]}});a.forEach(function(e){if(e in r._heartbeatChannelGroups){delete r._heartbeatChannelGroups[e]}});if(this._config.suppressLeaveEvents===false){this._leaveEndpoint({channels:o,channelGroups:a},function(e){r._listenerManager.announceStatus(e)})}}this.reconnect()}},{key:"adaptSubscribeChange",value:function e(t){var r=this;var n=t.timetoken,i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u,s=t.withPresence,c=s===undefined?false:s;if(!this._config.subscribeKey||this._config.subscribeKey===""){if(console&&console.log)console.log("subscribe key missing; aborting subscribe");return}if(n){this._lastTimetoken=this._currentTimetoken;this._currentTimetoken=n}if(this._currentTimetoken!=="0"){this._storedTimetoken=this._currentTimetoken;this._currentTimetoken=0}o.forEach(function(e){r._channels[e]={state:{}};if(c)r._presenceChannels[e]={};r._pendingChannelSubscriptions.push(e)});a.forEach(function(e){r._channelGroups[e]={state:{}};if(c)r._presenceChannelGroups[e]={};r._pendingChannelGroupSubscriptions.push(e)});this._subscriptionStatusAnnounced=false;this.reconnect()}},{key:"adaptUnsubscribeChange",value:function e(t,r){var n=this;var i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u;var s=[];var c=[];o.forEach(function(e){if(e in n._channels){delete n._channels[e];s.push(e)}if(e in n._presenceChannels){delete n._presenceChannels[e];s.push(e)}});a.forEach(function(e){if(e in n._channelGroups){delete n._channelGroups[e];c.push(e)}if(e in n._presenceChannelGroups){delete n._channelGroups[e];c.push(e)}});if(s.length===0&&c.length===0){return}if(this._config.suppressLeaveEvents===false&&!r){this._leaveEndpoint({channels:s,channelGroups:c},function(e){e.affectedChannels=s;e.affectedChannelGroups=c;e.currentTimetoken=n._currentTimetoken;e.lastTimetoken=n._lastTimetoken;n._listenerManager.announceStatus(e)})}if(Object.keys(this._channels).length===0&&Object.keys(this._presenceChannels).length===0&&Object.keys(this._channelGroups).length===0&&Object.keys(this._presenceChannelGroups).length===0){this._lastTimetoken=0;this._currentTimetoken=0;this._storedTimetoken=null;this._region=null;this._reconnectionManager.stopPolling()}this.reconnect()}},{key:"unsubscribeAll",value:function e(t){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},t)}},{key:"getHeartbeatChannels",value:function e(){return Object.keys(this._heartbeatChannels)}},{key:"getHeartbeatChannelGroups",value:function e(){return Object.keys(this._heartbeatChannelGroups)}},{key:"getSubscribedChannels",value:function e(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function e(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function e(){this._startSubscribeLoop();this._registerHeartbeatTimer()}},{key:"disconnect",value:function e(){this._stopSubscribeLoop();this._stopHeartbeatTimer();this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function e(){this._stopHeartbeatTimer();if(this._config.getHeartbeatInterval()===0){return}this._performHeartbeatLoop();this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),this._config.getHeartbeatInterval()*1e3)}},{key:"_stopHeartbeatTimer",value:function e(){if(this._heartbeatTimer){clearInterval(this._heartbeatTimer);this._heartbeatTimer=null}}},{key:"_performHeartbeatLoop",value:function e(){var t=this;var r=[];r=r.concat(this.getHeartbeatChannels());r=r.concat(this.getSubscribedChannels());var n=[];n=n.concat(this.getHeartbeatChannelGroups());n=n.concat(this.getSubscribedChannelGroups());var i={};if(r.length===0&&n.length===0){return}this.getSubscribedChannels().forEach(function(e){var r=t._channels[e].state;if(Object.keys(r).length)i[e]=r});this.getSubscribedChannelGroups().forEach(function(e){var r=t._channelGroups[e].state;if(Object.keys(r).length)i[e]=r});var o=function e(r){if(r.error&&t._config.announceFailedHeartbeats){t._listenerManager.announceStatus(r)}if(r.error&&t._config.autoNetworkDetection&&t._isOnline){t._isOnline=false;t.disconnect();t._listenerManager.announceNetworkDown();t.reconnect()}if(!r.error&&t._config.announceSuccessfulHeartbeats){t._listenerManager.announceStatus(r)}};this._heartbeatEndpoint({channels:r,channelGroups:n,state:i},o.bind(this))}},{key:"_startSubscribeLoop",value:function e(){this._stopSubscribeLoop();var t=[];var r=[];Object.keys(this._channels).forEach(function(e){return t.push(e)});Object.keys(this._presenceChannels).forEach(function(e){return t.push(e+"-pnpres")});Object.keys(this._channelGroups).forEach(function(e){return r.push(e)});Object.keys(this._presenceChannelGroups).forEach(function(e){return r.push(e+"-pnpres")});if(t.length===0&&r.length===0){return}var n={channels:t,channelGroups:r,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}},{key:"_processSubscribeResponse",value:function e(t,r){var n=this;if(t.error){if(t.category===_.default.PNTimeoutCategory){this._startSubscribeLoop()}else if(t.category===_.default.PNNetworkIssuesCategory){this.disconnect();if(t.error&&this._config.autoNetworkDetection&&this._isOnline){this._isOnline=false;this._listenerManager.announceNetworkDown()}this._reconnectionManager.onReconnection(function(){if(n._config.autoNetworkDetection&&!n._isOnline){n._isOnline=true;n._listenerManager.announceNetworkUp()}n.reconnect();n._subscriptionStatusAnnounced=true;var e={category:_.default.PNReconnectedCategory,operation:t.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(e)});this._reconnectionManager.startPolling();this._listenerManager.announceStatus(t)}else if(t.category===_.default.PNBadRequestCategory){this._stopHeartbeatTimer();this._listenerManager.announceStatus(t)}else{this._listenerManager.announceStatus(t)}return}if(this._storedTimetoken){this._currentTimetoken=this._storedTimetoken;this._storedTimetoken=null}else{this._lastTimetoken=this._currentTimetoken;this._currentTimetoken=r.metadata.timetoken}if(!this._subscriptionStatusAnnounced){var i={};i.category=_.default.PNConnectedCategory;i.operation=t.operation;i.affectedChannels=this._pendingChannelSubscriptions;i.subscribedChannels=this.getSubscribedChannels();i.affectedChannelGroups=this._pendingChannelGroupSubscriptions;i.lastTimetoken=this._lastTimetoken;i.currentTimetoken=this._currentTimetoken;this._subscriptionStatusAnnounced=true;this._listenerManager.announceStatus(i);this._pendingChannelSubscriptions=[];this._pendingChannelGroupSubscriptions=[]}var o=r.messages||[];var u=this._config,a=u.requestMessageCountThreshold,s=u.dedupeOnSubscribe;if(a&&o.length>=a){var c={};c.category=_.default.PNRequestMessageCountExceededCategory;c.operation=t.operation;this._listenerManager.announceStatus(c)}o.forEach(function(e){var t=e.channel;var r=e.subscriptionMatch;var i=e.publishMetaData;if(t===r){r=null}if(s){if(n._dedupingManager.isDuplicate(e)){return}else{n._dedupingManager.addEntry(e)}}if(v.default.endsWith(e.channel,"-pnpres")){var o={};o.channel=null;o.subscription=null;o.actualChannel=r!=null?t:null;o.subscribedChannel=r!=null?r:t;if(t){o.channel=t.substring(0,t.lastIndexOf("-pnpres"))}if(r){o.subscription=r.substring(0,r.lastIndexOf("-pnpres"))}o.action=e.payload.action;o.state=e.payload.data;o.timetoken=i.publishTimetoken;o.occupancy=e.payload.occupancy;o.uuid=e.payload.uuid;o.timestamp=e.payload.timestamp;if(e.payload.join){o.join=e.payload.join}if(e.payload.leave){o.leave=e.payload.leave}if(e.payload.timeout){o.timeout=e.payload.timeout}n._listenerManager.announcePresence(o)}else{var u={};u.channel=null;u.subscription=null;u.actualChannel=r!=null?t:null;u.subscribedChannel=r!=null?r:t;u.channel=t;u.subscription=r;u.timetoken=i.publishTimetoken;u.publisher=e.issuingClientId;if(e.userMetadata){u.userMetadata=e.userMetadata}if(n._config.cipherKey){u.message=n._crypto.decrypt(e.payload)}else{u.message=e.payload}n._listenerManager.announceMessage(u)}});this._region=r.metadata.region;this._startSubscribeLoop()}},{key:"_stopSubscribeLoop",value:function e(){if(this._subscribeCall){if(typeof this._subscribeCall.abort==="function"){this._subscribeCall.abort()}this._subscribeCall=null}}}]);return e}();t.default=w;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(128);var o=a(i);var u=r(4);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function(){function e(t){var r=t.timeEndpoint;s(this,e);this._timeEndpoint=r}n(e,[{key:"onReconnection",value:function e(t){this._reconnectionCallback=t}},{key:"startPolling",value:function e(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function e(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function e(){var t=this;this._timeEndpoint(function(e){if(!e.error){clearInterval(t._timeTimer);t._reconnectionCallback()}})}}]);return e}();t.default=c;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(28);var o=a(i);var u=r(4);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var c=function e(t){var r=0;if(t.length===0)return r;for(var n=0;n<t.length;n+=1){var i=t.charCodeAt(n);r=(r<<5)-r+i;r=r&r}return r};var f=function(){function e(t){var r=t.config;s(this,e);this.hashHistory=[];this._config=r}n(e,[{key:"getKey",value:function e(t){var r=c(JSON.stringify(t.payload)).toString();var n=t.publishMetaData.publishTimetoken;return n+"-"+r}},{key:"isDuplicate",value:function e(t){return this.hashHistory.includes(this.getKey(t))}},{key:"addEntry",value:function e(t){if(this.hashHistory.length>=this._config.maximumCacheSize){this.hashHistory.shift()}this.hashHistory.push(this.getKey(t))}},{key:"clearHistory",value:function e(){this.hashHistory=[]}}]);return e}();t.default=f;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e,t){var r=e.networking,n=e.config;var o=null;var u=null;var s={};if(t.getOperation()===l.default.PNTimeOperation||t.getOperation()===l.default.PNChannelGroupsOperation){o=arguments.length<=2?undefined:arguments[2]}else{s=arguments.length<=2?undefined:arguments[2];o=arguments.length<=3?undefined:arguments[3]}if(typeof Promise!=="undefined"&&!o){u=a.default.createPromise()}var c=t.validateParams(e,s);if(c){if(o){return o(_(c))}else if(u){u.reject(new y("Validation failed, check status for details",_(c)));return u.promise}return}var f=t.prepareParams(e,s);var h=g(t,e,s);var d=void 0;var p={url:h,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};f.uuid=n.UUID;f.pnsdk=m(n);if(n.useInstanceId){f.instanceid=n.instanceId}if(n.useRequestId){f.requestid=i.default.createUUID()}if(t.isAuthSupported()&&n.getAuthKey()){f.auth=n.getAuthKey()}if(n.secretKey){w(e,h,f)}var v=function r(n,i){if(n.error){if(o){o(n)}else if(u){u.reject(new y("PubNub call failed, check status for details",n))}return}var a=t.handleResponse(e,i,s);if(o){o(n,a)}else if(u){u.fulfill(a)}};if(t.usePost&&t.usePost(e,s)){var b=t.postPayload(e,s);d=r.POST(f,b,p,v)}else if(t.useDelete&&t.useDelete()){d=r.DELETE(f,p,v)}else{d=r.GET(f,p,v)}if(t.getOperation()===l.default.PNSubscribeOperation){return d}if(u){return u.promise}};var n=r(82);var i=h(n);var o=r(4);var u=r(8);var a=h(u);var s=r(28);var c=h(s);var f=r(5);var l=h(f);function h(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function p(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function v(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var y=function(e){v(t,e);function t(e,r){d(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.name=n.constructor.name;n.status=r;n.message=e;return n}return t}(Error);function b(e,t){e.type=t;e.error=true;return e}function _(e){return b({message:e},"validationError")}function g(e,t,r){if(e.usePost&&e.usePost(t,r)){return e.postURL(t,r)}else{return e.getURL(t,r)}}function m(e){if(e.sdkName){return e.sdkName}var t="PubNub-JS-"+e.sdkFamily;if(e.partnerId){t+="-"+e.partnerId}t+="/"+e.getVersion();return t}function w(e,t,r){var n=e.config,i=e.crypto;r.timestamp=Math.floor((new Date).getTime()/1e3);var o=n.subscribeKey+"\n"+n.publishKey+"\n"+t+"\n";o+=a.default.signPamFromParams(r);var u=i.HMACSHA256(o);u=u.replace(/\+/g,"-");u=u.replace(/\//g,"_");r.signature=u}e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNAddChannelsToGroupOperation}function f(e,t){var r=t.channels,n=t.channelGroup;var i=e.config;if(!n)return"Missing Channel Group";if(!r||r.length===0)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channels,n=r===undefined?[]:r;return{add:n.join(",")}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNRemoveChannelsFromGroupOperation}function f(e,t){var r=t.channels,n=t.channelGroup;var i=e.config;if(!n)return"Missing Channel Group";if(!r||r.length===0)return"Missing Channels";if(!i.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channels,n=r===undefined?[]:r;return{remove:n.join(",")}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.isAuthSupported=h;t.getRequestTimeout=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNRemoveGroupOperation}function f(e,t){var r=t.channelGroup;var n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)+"/remove"}function h(){return true}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return{}}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNChannelGroupsOperation}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e){var t=e.config;return"/v1/channel-registration/sub-key/"+t.subscribeKey+"/channel-group"}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(){return{}}function d(e,t){return{groups:t.payload.groups}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNChannelsForGroupOperation}function f(e,t){var r=t.channelGroup;var n=e.config;if(!r)return"Missing Channel Group";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=t.channelGroup;var n=e.config;return"/v1/channel-registration/sub-key/"+n.subscribeKey+"/channel-group/"+a.default.encodeString(r)}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(){return{}}function v(e,t){return{channels:t.payload.channels}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway,i=t.channels;var o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||i.length===0)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway,n=t.channels,i=n===undefined?[]:n;return{type:r,add:i.join(",")}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway,i=t.channels;var o=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i||i.length===0)return"Missing Channels";if(!o.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway,n=t.channels,i=n===undefined?[]:n;return{type:r,remove:i.join(",")}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNPushNotificationEnabledChannelsOperation}function s(e,t){var r=t.device,n=t.pushGateway;var i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway;return{type:r}}function d(e,t){return{channels:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNRemoveAllPushNotificationsOperation}function s(e,t){var r=t.device,n=t.pushGateway;var i=e.config;if(!r)return"Missing Device ID (device)";if(!n)return"Missing GW Type (pushGateway: gcm or apns)";if(!i.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=t.device;var n=e.config;return"/v1/push/sub-key/"+n.subscribeKey+"/devices/"+r+"/remove"}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(e,t){var r=t.pushGateway;return{type:r}}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNUnsubscribeOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/leave"}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r;var i={};if(n.length>0){i["channel-group"]=n.join(",")}return i}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNWhereNowOperation}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e,t){var r=e.config;var n=t.uuid,i=n===undefined?r.UUID:n;return"/v2/presence/sub-key/"+r.subscribeKey+"/uuid/"+i}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return true}function h(){return{}}function d(e,t){if(!t.payload){return{channels:[]}}return{channels:t.payload.channels}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.isAuthSupported=h;t.getRequestTimeout=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNHeartbeatOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/heartbeat"}function h(){return true}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r,i=t.state,o=i===undefined?{}:i;var u=e.config;var a={};if(n.length>0){a["channel-group"]=n.join(",")}a.state=JSON.stringify(o);a.heartbeat=u.getPresenceTimeout();return a}function v(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNGetStateOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.uuid,i=n===undefined?r.UUID:n,o=t.channels,u=o===undefined?[]:o;var s=u.length>0?u.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(s)+"/uuid/"+i}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r;var i={};if(n.length>0){i["channel-group"]=n.join(",")}return i}function v(e,t,r){var n=r.channels,i=n===undefined?[]:n,o=r.channelGroups,u=o===undefined?[]:o;var a={};if(i.length===1&&u.length===0){a[i[0]]=t.payload}else{a=t.payload}return{channels:a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNSetStateOperation}function f(e,t){var r=e.config;var n=t.state,i=t.channels,o=i===undefined?[]:i,u=t.channelGroups,a=u===undefined?[]:u;if(!n)return"Missing State";if(!r.subscribeKey)return"Missing Subscribe Key";if(o.length===0&&a.length===0)return"Please provide a list of channels and/or channel-groups"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+r.subscribeKey+"/channel/"+a.default.encodeString(o)+"/uuid/"+r.UUID+"/data"}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.state,n=t.channelGroups,i=n===undefined?[]:n;var o={};o.state=JSON.stringify(r);if(i.length>0){o["channel-group"]=i.join(",")}return o}function v(e,t){return{state:t.payload}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNHereNowOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n,o=t.channelGroups,u=o===undefined?[]:o;var s="/v2/presence/sub-key/"+r.subscribeKey;if(i.length>0||u.length>0){var c=i.length>0?i.join(","):",";s+="/channel/"+a.default.encodeString(c)}return s}function h(e){var t=e.config;return t.getTransactionTimeout()}function d(){return true}function p(e,t){var r=t.channelGroups,n=r===undefined?[]:r,i=t.includeUUIDs,o=i===undefined?true:i,u=t.includeState,a=u===undefined?false:u;var s={};if(!o)s.disable_uuids=1;if(a)s.state=1;if(n.length>0){s["channel-group"]=n.join(",")}return s}function v(e,t,r){var n=r.channels,i=n===undefined?[]:n,o=r.channelGroups,u=o===undefined?[]:o,a=r.includeUUIDs,s=a===undefined?true:a,c=r.includeState,f=c===undefined?false:c;var l=function e(){var r={};var n=[];r.totalChannels=1;r.totalOccupancy=t.occupancy;r.channels={};r.channels[i[0]]={occupants:n,name:i[0],occupancy:t.occupancy};if(s&&t.uuids){t.uuids.forEach(function(e){if(f){n.push({state:e.state,uuid:e.uuid})}else{n.push({state:null,uuid:e})}})}return r};var h=function e(){var r={};r.totalChannels=t.payload.total_channels;r.totalOccupancy=t.payload.total_occupancy;r.channels={};Object.keys(t.payload.channels).forEach(function(e){var n=t.payload.channels[e];var i=[];r.channels[e]={occupants:i,name:e,occupancy:n.occupancy};if(s){n.uuids.forEach(function(e){if(f){i.push({state:e.state,uuid:e.uuid})}else{i.push({state:null,uuid:e})}})}return r});return r};var d=void 0;if(i.length>1||u.length>0||u.length===0&&i.length===0){d=h()}else{d=l()}return d}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNAccessManagerAudit}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function c(e){var t=e.config;return"/v2/auth/audit/sub-key/"+t.subscribeKey}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return false}function h(e,t){var r=t.channel,n=t.channelGroup,i=t.authKeys,o=i===undefined?[]:i;var u={};if(r){u.channel=r}if(n){u["channel-group"]=n}if(o.length>0){u.auth=o.join(",")}return u}function d(e,t){return t.payload}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=a;t.validateParams=s;t.getURL=c;t.getRequestTimeout=f;t.isAuthSupported=l;t.prepareParams=h;t.handleResponse=d;var n=r(4);var i=r(5);var o=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function a(){return o.default.PNAccessManagerGrant}function s(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key";if(!t.publishKey)return"Missing Publish Key";if(!t.secretKey)return"Missing Secret Key"}function c(e){var t=e.config;return"/v2/auth/grant/sub-key/"+t.subscribeKey}function f(e){var t=e.config;return t.getTransactionTimeout()}function l(){return false}function h(e,t){var r=t.channels,n=r===undefined?[]:r,i=t.channelGroups,o=i===undefined?[]:i,u=t.ttl,a=t.read,s=a===undefined?false:a,c=t.write,f=c===undefined?false:c,l=t.manage,h=l===undefined?false:l,d=t.authKeys,p=d===undefined?[]:d;var v={};v.r=s?"1":"0";v.w=f?"1":"0";v.m=h?"1":"0";if(n.length>0){v.channel=n.join(",")}if(o.length>0){v["channel-group"]=o.join(",")}if(p.length>0){v.auth=p.join(",")}if(u||u===0){v.ttl=u}return v}function d(){return{}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=l;t.validateParams=h;t.usePost=d;t.getURL=p;t.postURL=v;t.getRequestTimeout=y;t.isAuthSupported=b;t.postPayload=_;t.prepareParams=g;t.handleResponse=m;var i=r(4);var o=r(5);var u=c(o);var a=r(8);var s=c(a);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var r=e.crypto,n=e.config;var i=JSON.stringify(t);if(n.cipherKey){i=r.encrypt(i);i=JSON.stringify(i)}return i}function l(){return u.default.PNPublishOperation}function h(e,t){var r=e.config;var n=t.message,i=t.channel;if(!i)return"Missing Channel";if(!n)return"Missing Message";if(!r.subscribeKey)return"Missing Subscribe Key"}function d(e,t){var r=t.sendByPost,n=r===undefined?false:r;return n}function p(e,t){var r=e.config;var n=t.channel,i=t.message;var o=f(e,i);return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+s.default.encodeString(n)+"/0/"+s.default.encodeString(o)}function v(e,t){var r=e.config;var n=t.channel;return"/publish/"+r.publishKey+"/"+r.subscribeKey+"/0/"+s.default.encodeString(n)+"/0"}function y(e){var t=e.config;return t.getTransactionTimeout()}function b(){return true}function _(e,t){var r=t.message;return f(e,r)}function g(e,t){var r=t.meta,i=t.replicate,o=i===undefined?true:i,u=t.storeInHistory,a=t.ttl;var s={};if(u!=null){if(u){s.store="1"}else{s.store="0"}}if(a){s.ttl=a}if(o===false){s.norep="true"}if(r&&(typeof r==="undefined"?"undefined":n(r))==="object"){s.meta=JSON.stringify(r)}return s}function m(e,t){return{timetoken:t[2]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=f;t.validateParams=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}function f(){return o.default.PNHistoryOperation}function l(e,t){var r=t.channel;var n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"}function h(e,t){var r=t.channel;var n=e.config;return"/v2/history/sub-key/"+n.subscribeKey+"/channel/"+a.default.encodeString(r)}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end,i=t.reverse,o=t.count,u=o===undefined?100:o,a=t.stringifiedTimeToken,s=a===undefined?false:a;var c={include_token:"true"};c.count=u;if(r)c.start=r;if(n)c.end=n;if(s)c.string_message_token="true";if(i!=null)c.reverse=i.toString();return c}function y(e,t){var r={messages:[],startTimeToken:t[1],endTimeToken:t[2]};t[0].forEach(function(t){var n={timetoken:t.timetoken,entry:c(e,t.message)};r.messages.push(n)});return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.useDelete=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNDeleteMessagesOperation}function f(e,t){var r=t.channel;var n=e.config;if(!r)return"Missing channel";if(!n.subscribeKey)return"Missing Subscribe Key"}function l(){return true}function h(e,t){var r=t.channel;var n=e.config;return"/v3/history/sub-key/"+n.subscribeKey+"/channel/"+a.default.encodeString(r)}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end;var i={};if(r)i.start=r;if(n)i.end=n;return i}function y(e,t){return t.payload}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=f;t.validateParams=l;t.getURL=h;t.getRequestTimeout=d;t.isAuthSupported=p;t.prepareParams=v;t.handleResponse=y;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var r=e.config,n=e.crypto;if(!r.cipherKey)return t;try{return n.decrypt(t)}catch(e){return t}}function f(){return o.default.PNFetchMessagesOperation}function l(e,t){var r=t.channels;var n=e.config;if(!r||r.length===0)return"Missing channels";if(!n.subscribeKey)return"Missing Subscribe Key"}function h(e,t){var r=t.channels,n=r===undefined?[]:r;var i=e.config;var o=n.length>0?n.join(","):",";return"/v3/history/sub-key/"+i.subscribeKey+"/channel/"+a.default.encodeString(o)}function d(e){var t=e.config;return t.getTransactionTimeout()}function p(){return true}function v(e,t){var r=t.start,n=t.end,i=t.count;var o={};if(i)o.max=i;if(r)o.start=r;if(n)o.end=n;return o}function y(e,t){var r={channels:{}};Object.keys(t.channels||{}).forEach(function(n){r.channels[n]=[];(t.channels[n]||[]).forEach(function(t){var i={};i.channel=n;i.subscription=null;i.timetoken=t.timetoken;i.message=c(e,t.message);r.channels[n].push(i)})});return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getOperation=c;t.validateParams=f;t.getURL=l;t.getRequestTimeout=h;t.isAuthSupported=d;t.prepareParams=p;t.handleResponse=v;var n=r(4);var i=r(5);var o=s(i);var u=r(8);var a=s(u);function s(e){return e&&e.__esModule?e:{default:e}}function c(){return o.default.PNSubscribeOperation}function f(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function l(e,t){var r=e.config;var n=t.channels,i=n===undefined?[]:n;var o=i.length>0?i.join(","):",";return"/v2/subscribe/"+r.subscribeKey+"/"+a.default.encodeString(o)+"/0"}function h(e){var t=e.config;return t.getSubscribeTimeout()}function d(){return true}function p(e,t){var r=e.config;var n=t.channelGroups,i=n===undefined?[]:n,o=t.timetoken,u=t.filterExpression,a=t.region;var s={heartbeat:r.getPresenceTimeout()};if(i.length>0){s["channel-group"]=i.join(",")}if(u&&u.length>0){s["filter-expr"]=u}if(o){s.tt=o}if(a){s.tr=a}return s}function v(e,t){var r=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r};var n={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};r.push(n)});var n={timetoken:t.t.t,region:t.t.r};return{messages:r,metadata:n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(28);var o=c(i);var u=r(52);var a=c(u);var s=r(4);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function e(t){var r=this;f(this,e);this._modules={};Object.keys(t).forEach(function(e){r._modules[e]=t[e].bind(r)})}n(e,[{key:"init",value:function e(t){this._config=t;this._maxSubDomain=20;this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain);this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin;this._coreParams={};this.shiftStandardOrigin()}},{key:"nextOrigin",value:function e(){if(this._providedFQDN.indexOf("pubsub.")===-1){return this._providedFQDN}var t=void 0;this._currentSubDomain=this._currentSubDomain+1;if(this._currentSubDomain>=this._maxSubDomain){this._currentSubDomain=1}t=this._currentSubDomain.toString();return this._providedFQDN.replace("pubsub","ps"+t)}},{key:"hasModule",value:function e(t){return t in this._modules}},{key:"shiftStandardOrigin",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this._standardOrigin=this.nextOrigin(t);return this._standardOrigin}},{key:"getStandardOrigin",value:function e(){return this._standardOrigin}},{key:"POST",value:function e(t,r,n,i){return this._modules.post(t,r,n,i)}},{key:"GET",value:function e(t,r,n){return this._modules.get(t,r,n)}},{key:"DELETE",value:function e(t,r,n){return this._modules.del(t,r,n)}},{key:"_detectErrorCategory",value:function e(t){if(t.code==="ENOTFOUND")return a.default.PNNetworkIssuesCategory;if(t.code==="ECONNREFUSED")return a.default.PNNetworkIssuesCategory;if(t.code==="ECONNRESET")return a.default.PNNetworkIssuesCategory;if(t.code==="EAI_AGAIN")return a.default.PNNetworkIssuesCategory;if(t.status===0||t.hasOwnProperty("status")&&typeof t.status==="undefined")return a.default.PNNetworkIssuesCategory;if(t.timeout)return a.default.PNTimeoutCategory;if(t.response){if(t.response.badRequest)return a.default.PNBadRequestCategory;if(t.response.forbidden)return a.default.PNAccessDeniedCategory}return a.default.PNUnknownCategory}}]);return e}();t.default=l;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=function(){function e(){i(this,e);this.storage={}}n(e,[{key:"get",value:function e(t){return this.storage[t]}},{key:"set",value:function e(t,r){this.storage[t]=r}}]);return e}();t.default=o;e.exports=t["default"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.get=s;t.post=c;t.del=f;var n=r(160);var i=r(4);var o=r(335);function u(e,t,r){var n=function e(){if(console&&console.log)return console;return console};var i=(new Date).getTime();var o=(new Date).toISOString();var u=n();u.log("<<<<<");u.log("["+o+"]","\n",e,"\n",t);u.log("-----");var a=(new Date).getTime();var s=a-i;var c=(new Date).toISOString();u.log(">>>>>>");u.log("["+c+" / "+s+"]","\n",e,"\n",t,"\n",r);u.log("-----")}function a(e,t,r,i,a,s){var c=this;var f={};f.operation=a.operation;return(0,n.request)({method:e,url:(0,o.buildUrl)(t,r),content:i,timeout:a.timeout}).then(function(e){f.error=false;if(e.statusCode){f.statusCode=e.statusCode}return e.content.toJSON()}).then(function(e){var n=e;if(c._config.logVerbosity){u(t,r,n)}s(f,n)}).catch(function(e){f.error=true;f.errorData=e;f.category=c._detectErrorCategory(e);s(f,null)})}function s(e,t,r){var n=this.getStandardOrigin()+t.url;return a.call(this,"GET",n,e,"",t,r)}function c(e,t,r,n){var i=this.getStandardOrigin()+r.url;return a.call(this,"POST",i,e,t,r,n)}function f(e,t,r){var n=this.getStandardOrigin()+t.url;return a.call(this,"DELETE",n,e,"",t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.encodedKeyValuePair=i;t.buildUrl=o;function i(e,t,r){if(r!=null){if(Array.isArray(r)){r.forEach(function(r){i(e,t,r)})}else if((typeof r==="undefined"?"undefined":n(r))==="object"){Object.keys(r).forEach(function(n){i(e,t+"["+n+"]",r[n])})}else{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}}else if(r===null){e.push(encodeURIComponent(""+encodeURIComponent(t)))}}function o(e,t){var r=[];Object.keys(t).forEach(function(e){i(r,e,t[e])});return e+"?"+r.join("&")}},function(e,t,r){e.exports=r(337)},function(e,t,r){var n=r(27),i=r(117),o=r(46);var u=i(function(e,t){n(t,o(t),e)});e.exports=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Stream=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(1);var u=r(7);var a=r(3);var s=r(51);var c=r(9);var f=r(131);function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=t.Stream=function(){function e(t){l(this,e);this.name=t;this._client=u.Client.sharedInstance();this._liveService=(0,s.getLiveService)(this._client);this._subscribeChannels={};this._publishChannels={}}n(e,[{key:"getSubstreams",value:function e(){return this._makeStreamRequest("_substreams",c.RequestMethod.GET)}},{key:"getACL",value:function e(t){if(!(0,a.isNonemptyString)(t)){return i.Promise.reject(new o.KinveyError("Invalid or missing id"))}return this._makeStreamRequest(t,c.RequestMethod.GET)}},{key:"setACL",value:function e(t,r){if(!(0,a.isNonemptyString)(t)){return i.Promise.reject(new o.KinveyError("Invalid or missing id"))}if(!f.StreamACL.isValidACLObject(r)){return i.Promise.reject(new o.KinveyError("Invalid or missing ACL object"))}if(!(r instanceof f.StreamACL)){r=new f.StreamACL(r)}return this._makeStreamRequest(t,c.RequestMethod.PUT,r.toPlainObject())}},{key:"follow",value:function e(t,r){return this._subscribe(t,r)}},{key:"unfollow",value:function e(t){return this._unsubscribe(t)}},{key:"post",value:function e(t){var r=this._client.getActiveUser()._id;return this._publish(r,t)}},{key:"listen",value:function e(t){var r=this._client.getActiveUser()._id;return this._subscribe(r,t)}},{key:"stopListening",value:function e(){var t=this._client.getActiveUser()._id;return this._unsubscribe(t)}},{key:"send",value:function e(t,r){return this._publish(t,r)}},{key:"_unsubscribeFromSubstream",value:function e(t){var r=t+"/unsubscribe";return this._makeStreamRequest(r,c.RequestMethod.POST,{deviceId:this._client.deviceId})}},{key:"_subscribe",value:function e(t,r){var n=this;return this._requestSubscribeAccess(t).then(function(){var e=n._subscribeChannels[t];n._liveService.subscribeToChannel(e,r)})}},{key:"_unsubscribe",value:function e(t){var r=this;return this._unsubscribeFromSubstream(t).then(function(){var e=r._subscribeChannels[t];r._liveService.unsubscribeFromChannel(e);delete r._subscribeChannels[t]})}},{key:"_publish",value:function e(t,r){if(this._publishChannels[t]){return this._retriablePublish(t,r)}return this._publishWithAccessRequest(t,r)}},{key:"_publishWithAccessRequest",value:function e(t,r){var n=this;return this._requestPublishAccess(t).then(function(){var e=n._publishChannels[t];return n._liveService.publishToChannel(e,r)})}},{key:"_retriablePublish",value:function e(t,r){var n=this;var o=this._publishChannels[t];return this._liveService.publishToChannel(o,r).catch(function(e){var o=i.Promise.reject(e);if(e.statusCode===c.StatusCode.Forbidden){o=n._publishWithAccessRequest(t,r)}return o})}},{key:"_requestPublishAccess",value:function e(t){var r=this;return this._makeStreamRequest(t+"/publish",c.RequestMethod.POST).then(function(e){if(e.substreamChannelName){r._publishChannels[t]=e.substreamChannelName}return e})}},{key:"_requestSubscribeAccess",value:function e(t){var r=this;var n={deviceId:this._client.deviceId};return this._makeStreamRequest(t+"/subscribe",c.RequestMethod.POST,n).then(function(e){r._subscribeChannels[t]=e.substreamChannelName;return e})}},{key:"_makeStreamRequest",value:function e(t,r,n){return c.KinveyRequest.execute({method:r,pathname:"/stream/"+this._client.appKey+"/"+this.name+"/"+t,body:n},this._client)}}],[{key:"StreamACL",get:function e(){return f.StreamACL}}]);return e}()},function(e,t,r){var n=r(340),i=r(341),o=r(64),u=r(6),a=r(76);function s(e,t,r){var s=u(e)?n:i;if(r&&a(e,t,r)){t=undefined}return s(e,o(t,3))}e.exports=s},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(!t(e[r],r,e)){return false}}return true}e.exports=r},function(e,t,r){var n=r(39);function i(e,t){var r=true;n(e,function(e,n,i){r=!!t(e,n,i);return r});return r}e.exports=i},function(e,t,r){var n=r(343),i=r(354),o=r(135);function u(e){var t=i(e);if(t.length==1&&t[0][2]){return o(t[0][0],t[0][1])}return function(r){return r===e||n(r,e,t)}}e.exports=u},function(e,t,r){var n=r(78),i=r(132);var o=1,u=2;function a(e,t,r,a){var s=r.length,c=s,f=!a;if(e==null){return!c}e=Object(e);while(s--){var l=r[s];if(f&&l[2]?l[1]!==e[l[0]]:!(l[0]in e)){return false}}while(++s<c){l=r[s];var h=l[0],d=e[h],p=l[1];if(f&&l[2]){if(d===undefined&&!(h in e)){return false}}else{var v=new n;if(a){var y=a(d,p,h,e,t,v)}if(!(y===undefined?i(p,d,o|u,a,v):y)){return false}}}return true}e.exports=a},function(e,t,r){var n=r(78),i=r(133),o=r(350),u=r(353),a=r(34),s=r(6),c=r(43),f=r(66);var l=1;var h="[object Arguments]",d="[object Array]",p="[object Object]";var v=Object.prototype;var y=v.hasOwnProperty;function b(e,t,r,v,b,_){var g=s(e),m=s(t),w=g?d:a(e),O=m?d:a(t);w=w==h?p:w;O=O==h?p:O;var k=w==p,P=O==p,E=w==O;if(E&&c(e)){if(!c(t)){return false}g=true;k=false}if(E&&!k){_||(_=new n);return g||f(e)?i(e,t,r,v,b,_):o(e,t,w,r,v,b,_)}if(!(r&l)){var j=k&&y.call(e,"__wrapped__"),S=P&&y.call(t,"__wrapped__");if(j||S){var C=j?e.value():e,M=S?t.value():t;_||(_=new n);return b(C,M,r,v,_)}}if(!E){return false}_||(_=new n);return u(e,t,r,v,b,_)}e.exports=b},function(e,t,r){var n=r(79),i=r(346),o=r(347);function u(e){var t=-1,r=e==null?0:e.length;this.__data__=new n;while(++t<r){this.add(e[t])}}u.prototype.add=u.prototype.push=i;u.prototype.has=o;e.exports=u},function(e,t){var r="__lodash_hash_undefined__";function n(e){this.__data__.set(e,r);return this}e.exports=n},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t){function r(e,t){var r=-1,n=e==null?0:e.length;while(++r<n){if(t(e[r],r,e)){return true}}return false}e.exports=r},function(e,t){function r(e,t){return e.has(t)}e.exports=r},function(e,t,r){var n=r(29),i=r(125),o=r(35),u=r(133),a=r(351),s=r(352);var c=1,f=2;var l="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Map]",v="[object Number]",y="[object RegExp]",b="[object Set]",_="[object String]",g="[object Symbol]";var m="[object ArrayBuffer]",w="[object DataView]";var O=n?n.prototype:undefined,k=O?O.valueOf:undefined;function P(e,t,r,n,O,P,E){switch(r){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case m:if(e.byteLength!=t.byteLength||!P(new i(e),new i(t))){return false}return true;case l:case h:case v:return o(+e,+t);case d:return e.name==t.name&&e.message==t.message;case y:case _:return e==t+"";case p:var j=a;case b:var S=n&c;j||(j=s);if(e.size!=t.size&&!S){return false}var C=E.get(e);if(C){return C==t}n|=f;E.set(e,t);var M=u(j(e),j(t),n,O,P,E);E["delete"](e);return M;case g:if(k){return k.call(e)==k.call(t)}}return false}e.exports=P},function(e,t){function r(e){var t=-1,r=Array(e.size);e.forEach(function(e,n){r[++t]=[n,e]});return r}e.exports=r},function(e,t){function r(e){var t=-1,r=Array(e.size);e.forEach(function(e){r[++t]=e});return r}e.exports=r},function(e,t,r){var n=r(123);var i=1;var o=Object.prototype;var u=o.hasOwnProperty;function a(e,t,r,o,a,s){var c=r&i,f=n(e),l=f.length,h=n(t),d=h.length;if(l!=d&&!c){return false}var p=l;while(p--){var v=f[p];if(!(c?v in t:u.call(t,v))){return false}}var y=s.get(e);if(y&&s.get(t)){return y==t}var b=true;s.set(e,t);s.set(t,e);var _=c;while(++p<l){v=f[p];var g=e[v],m=t[v];if(o){var w=c?o(m,g,v,t,e,s):o(g,m,v,e,t,s)}if(!(w===undefined?g===m||a(g,m,r,o,s):w)){b=false;break}_||(_=v=="constructor")}if(b&&!_){var O=e.constructor,k=t.constructor;if(O!=k&&("constructor"in e&&"constructor"in t)&&!(typeof O=="function"&&O instanceof O&&typeof k=="function"&&k instanceof k)){b=false}}s["delete"](e);s["delete"](t);return b}e.exports=a},function(e,t,r){var n=r(134),i=r(21);function o(e){var t=i(e),r=t.length;while(r--){var o=t[r],u=e[o];t[r]=[o,u,n(u)]}return t}e.exports=o},function(e,t,r){var n=r(132),i=r(356),o=r(161),u=r(85),a=r(134),s=r(135),c=r(40);var f=1,l=2;function h(e,t){if(u(e)&&a(t)){return s(c(e),t)}return function(r){var u=i(r,e);return u===undefined&&u===t?o(r,e):n(t,u,f|l)}}e.exports=h},function(e,t,r){var n=r(93);function i(e,t,r){var i=e==null?undefined:n(e,t);return i===undefined?r:i}e.exports=i},function(e,t,r){var n=r(358);var i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var o=/\\(\\)?/g;var u=n(function(e){var t=[];if(e.charCodeAt(0)===46){t.push("")}e.replace(i,function(e,r,n,i){t.push(n?i.replace(o,"$1"):r||e)});return t});e.exports=u},function(e,t,r){var n=r(359);var i=500;function o(e){var t=n(e,function(e){if(r.size===i){r.clear()}return e});var r=t.cache;return t}e.exports=o},function(e,t,r){var n=r(79);var i="Expected a function";function o(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new TypeError(i)}var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i)){return o.get(i)}var u=e.apply(this,n);r.cache=o.set(i,u)||o;return u};r.cache=new(o.Cache||n);return r}o.Cache=n;e.exports=o},function(e,t,r){var n=r(361);function i(e){return e==null?"":n(e)}e.exports=i},function(e,t,r){var n=r(29),i=r(94),o=r(6),u=r(45);var a=1/0;var s=n?n.prototype:undefined,c=s?s.toString:undefined;function f(e){if(typeof e=="string"){return e}if(o(e)){return i(e,f)+""}if(u(e)){return c?c.call(e):""}var t=e+"";return t=="0"&&1/e==-a?"-0":t}e.exports=f},function(e,t){function r(e,t){return e!=null&&t in Object(e)}e.exports=r},function(e,t,r){var n=r(84),i=r(59),o=r(6),u=r(60),a=r(67),s=r(40);function c(e,t,r){t=n(t,e);var c=-1,f=t.length,l=false;while(++c<f){var h=s(t[c]);if(!(l=e!=null&&r(e,h))){break}e=e[h]}if(l||++c!=f){return l}f=e==null?0:e.length;return!!f&&a(f)&&u(h,f)&&(o(e)||i(e))}e.exports=c},function(e,t,r){var n=r(365),i=r(366),o=r(85),u=r(40);function a(e){return o(e)?n(u(e)):i(e)}e.exports=a},function(e,t){function r(e){return function(t){return t==null?undefined:t[e]}}e.exports=r},function(e,t,r){var n=r(93);function i(e){return function(t){return n(t,e)}}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LiveServiceFacade=undefined;var n=r(7);var i=r(130);var o=r(51);function u(){var e=n.Client.sharedInstance();return(0,o.getLiveService)(e)}function a(e){u().onConnectionStatusUpdates(e)}function s(e){u().offConnectionStatusUpdates(e)}function c(){return u().isInitialized()}var f=t.LiveServiceFacade={Stream:i.Stream,onConnectionStatusUpdates:a,offConnectionStatusUpdates:s,isInitialized:c}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=t.Operation=function(){function e(t,r,n,o,u){i(this,e);this.type=t;this.collection=r;if(n){this.query=n}if(o){this.data=o}if(u){this.entityId=u}}n(e,[{key:"clone",value:function t(){return new e(this.type,this.collection,this.query,this.data,this.entityId)}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.OperationType={Create:"create",Read:"read",ReadById:"readById",Update:"update",Delete:"delete",DeleteById:"deleteById",Count:"count",Clear:"clear",Group:"group"}},function(e,t,r){var n=r(75),i=r(371);var o=i(function(e,t,r){n(e,r,t)});e.exports=o},function(e,t,r){var n=r(372),i=r(373),o=r(64),u=r(6);function a(e,t){return function(r,a){var s=u(r)?n:i,c=t?t():{};return s(r,e,o(a,2),c)}}e.exports=a},function(e,t){function r(e,t,r,n){var i=-1,o=e==null?0:e.length;while(++i<o){var u=e[i];t(n,u,r(u),e)}return n}e.exports=r},function(e,t,r){var n=r(39);function i(e,t,r,i){n(e,function(e,n,o){t(i,e,r(e),o)});return i}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.buildCollectionUrl=t.dataStoreTagSeparator=undefined;var n=r(54);Object.defineProperty(t,"buildCollectionUrl",{enumerable:true,get:function e(){return n.buildCollectionUrl}});t.getEntitiesPendingPushError=f;t.generateEntityId=l;t.isNotEmpty=h;t.isEmpty=d;t.isLocalEntity=p;t.isValidDataStoreTag=v;t.collectionHasTag=y;t.formTaggedCollectionName=b;t.stripTagFromCollectionName=_;t.getTagFromCollectionName=g;var i=r(26);var o=s(i);var u=r(1);var a=r(3);function s(e){return e&&e.__esModule?e:{default:e}}var c=t.dataStoreTagSeparator=".";function f(e,t){var r="are "+e+" entities, matching the provided query";if(e===1){r="is "+e+" entity, matching the provided query or id"}var n="Unable to "+t+" on the backend. There "+r+", pending push to the backend. The result will overwrite your local changes.";return new u.KinveyError(n)}function l(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:24;var t="abcdef0123456789";var r="";for(var n=0,i=t.length;n<e;n+=1){var o=Math.floor(Math.random()*i);r+=t.substring(o,o+1)}return r}function h(e){return!(0,o.default)(e)}function d(e){return(0,o.default)(e)}function p(e){return!!e&&!!e._kmd&&e._kmd.local===true}function v(e){var t=/^[a-z0-9-]+$/i;return(0,a.isNonemptyString)(e)&&t.test(e)}function y(e){return e.indexOf(c)>=0}function b(e,t){if(t){return""+e+c+t}return e}function _(e){return e.split(c)[0]}function g(e){return e.split(c)[1]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PromiseQueueByKey=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(3);function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=t.PromiseQueueByKey=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;o(this,e);this._queuesByKey={};this._simultaneousOpsCount=t;this._maxQueueLength=r}n(e,[{key:"enqueue",value:function e(t,r){if(!this._queuesByKey[t]){this._queuesByKey[t]=new i.PromiseQueue(this._simultaneousOpsCount,this._maxQueueLength)}return this._queuesByKey[t].enqueue(r)}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KeyValueStoreOfflineRepository=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(1);var o=r(139);var u=r(65);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var f=t.KeyValueStoreOfflineRepository=function(e){c(t,e);function t(e,r){a(this,t);if(!(e instanceof u.KeyValueStorePersister)){throw new i.KinveyError("KeyValueStoreOfflineRepository only works with an instance of KeyValueStorePersister")}return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}n(t,[{key:"create",value:function e(t,r){return this._batchUpsert(t,r)}},{key:"update",value:function e(t,r){return this._batchUpsert(t,r)}},{key:"readById",value:function e(t,r){return this._persister.readEntity(t,r)}},{key:"deleteById",value:function e(t,r){return this._persister.deleteEntity(t,r).then(function(e){return e?1:0})}},{key:"_formCollectionKey",value:function e(t){return t}},{key:"_getAllCollections",value:function e(){return this._persister.getKeys()}},{key:"_batchUpsert",value:function e(t,r){return this._persister.writeEntities(t,r).then(function(){return r})}}]);return t}(o.InmemoryOfflineRepository)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MemoryKeyValuePersister=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(55);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c={};var f=t.MemoryKeyValuePersister=function(e){s(t,e);function t(){u(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"getKeys",value:function e(){return i.Promise.resolve(Object.keys(c))}},{key:"_readFromPersistance",value:function e(t){var r=c[t]||[];return i.Promise.resolve(r.slice(0))}},{key:"_writeToPersistance",value:function e(t,r){c[t]=r.slice(0);return i.Promise.resolve(true)}},{key:"_deleteFromPersistance",value:function e(t){delete c[t];return i.Promise.resolve(true)}}]);return t}(o.KeyValuePersister)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(379);Object.keys(n).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return n[e]}})});var i=r(380);Object.keys(i).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return i[e]}})});var o=r(381);Object.keys(o).forEach(function(e){if(e==="default"||e==="__esModule")return;Object.defineProperty(t,e,{enumerable:true,get:function t(){return o[e]}})})},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.WebSqlSqlModule=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(1);var u=r(38);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s={};var c=t.WebSqlSqlModule=function(){function t(e){a(this,t);this._databaseName=e}n(t,[{key:"openTransaction",value:function t(r,n,a){var c=this;var f=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var l=s[this._databaseName];var h='"'+r+'"';var d=r===u.webSqlCollectionsMaster;var p=Array.isArray(n);n=p?n:[[n,a]];return new i.Promise(function(t,i){try{if(!l){l=e.openDatabase(c._databaseName,1,"Kinvey Cache",u.webSqlDatabaseSize);s[c._databaseName]=l}var a=f||typeof l.readTransaction!=="function";l[a?"transaction":"readTransaction"](function(e){if(f&&!d){e.executeSql("CREATE TABLE IF NOT EXISTS "+h+" "+"(key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)")}var r=n.length;var i=[];if(r===0){t(p?i:i.shift())}else{n.forEach(function(n){var o=n[0].replace("#{collection}",h);e.executeSql(o,n[1],function(e,n){var o=[];if(n.rows.length>0){for(var u=0,a=n.rows.length;u<a;u+=1){try{var s=n.rows.item(u).value;var c=d?s:JSON.parse(s);o.push(c)}catch(e){}}}else{o=n.rowsAffected}i.push(o);r-=1;if(r===0){t(p?i:i.shift())}})})}},function(e){e=typeof e==="string"?e:e.message;if(e&&e.indexOf("no such table")===-1){return t([])}var n="SELECT name AS value from #{collection} WHERE type = ? AND name = ?";var a=["table",r];return c.openTransaction(u.webSqlCollectionsMaster,n,a).then(function(e){if(e===0){return t([])}return i(new o.KinveyError("Unable to open a transaction for the "+r+(" collection on the "+c._databaseName+" WebSQL database.")))}).catch(i)})}catch(e){i(e)}})}}]);return t}()}).call(t,r(18))},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.IndexedDbKeyValueStorePersister=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(1);var u=r(88);var a=r(3);var s=r(38);function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h={};var d=t.IndexedDbKeyValueStorePersister=function(t){l(r,t);function r(){c(this,r);var e=f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));e.inTransaction=false;e.queue=[];return e}n(r,[{key:"getKeys",value:function e(){return this._getDb().then(function(e){return(0,s.domStringListToStringArray)(e.objectStoreNames)})}},{key:"_readFromPersistance",value:function e(t){var r=this;return new i.Promise(function(e,n){r._openTransaction(t,false,function(r){var i=r.objectStore(t);var o=i.openCursor();var u=[];o.onsuccess=function(t){var r=t.target.result;if((0,a.isDefined)(r)){u.push(r.value);return r.continue()}return e(u)};o.onerror=function(e){n(e.target.error)}},function(t){if(t instanceof o.NotFoundError){e([])}n(t)})})}},{key:"_writeToPersistance",value:function e(t,r){var n=this;if(!r){return i.Promise.reject(new o.KinveyError("Invalid or missing entities array"))}return this._deleteFromPersistance(t).then(function(){return n._upsertEntities(t,r)})}},{key:"_deleteFromPersistance",value:function e(t){var r=this;return new i.Promise(function(e,n){r._openTransaction(t,true,function(r){var i=r.objectStore(t);i.clear();r.oncomplete=function(t){return e(t)};r.onerror=function(e){return n(e)}},n)})}},{key:"_readEntityFromPersistance",value:function e(t,r){var n=this;return new i.Promise(function(e,i){n._openTransaction(t,false,function(n){var o=n.objectStore(t);var u=o.get(r);u.onsuccess=function(t){var r=t.target.result;e(r)};u.onerror=i},i)})}},{key:"_writeEntitiesToPersistance",value:function e(t,r){return this._upsertEntities(t,r)}},{key:"_deleteEntityFromPersistance",value:function e(t,r){var n=this;return new i.Promise(function(e,i){n._openTransaction(t,true,function(o){var u=o.objectStore(t);var s=u.get(r);u.delete(r);o.oncomplete=function(){var o=s.result;if((0,a.isDefined)(o)){e({count:1})}else{i(n._getEntityNotFoundError(t,r))}};o.onerror=function(){i(n._getEntityNotFoundError(t,r))}},i)})}},{key:"_openTransaction",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var n=arguments[2];var i=this;var u=arguments[3];var c=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var f=h[this._storeName];if((0,a.isDefined)(f)){var l=typeof f.objectStoreNames.contains==="function"?f.objectStoreNames.contains(t):f.objectStoreNames.indexOf(t)!==-1;if(l){try{var d=r?s.inedxedDbTransctionMode.readWrite:s.inedxedDbTransctionMode.readOnly;var p=f.transaction(t,d);if((0,a.isDefined)(p)){return n(p)}throw new o.KinveyError("Unable to open a transaction for "+t+(" collection on the "+this._storeName+" IndexedDB database."))}catch(e){return u(e)}}else if(r===false){return u(new o.NotFoundError("The "+t+" collection was not found on"+(" the "+this._storeName+" IndexedDB database.")))}}if(c===false&&this.inTransaction){return this.queue.push(function(){i._openTransaction(t,r,n,u)})}this.inTransaction=true;var v=void 0;try{v=this._openDb()}catch(e){u(e)}v.onupgradeneeded=function(e){f=e.target.result;h[i._storeName]=f;if(r===true){f.createObjectStore(t,{keyPath:"_id"})}};v.onsuccess=function(e){f=e.target.result;h[i._storeName]=f;f.onversionchange=function(){if((0,a.isDefined)(f)){f.close();f=null;h[i._storeName]=null}};var o=function e(t){var r=function e(r){t(r);i.inTransaction=false;if(i.queue.length>0){var n=i.queue;i.queue=[];n.forEach(function(e){e.call(i)})}};return r};return i._openTransaction(t,r,o(n),o(u),true)};v.onblocked=function(){};v.onerror=function(e){u(new Error("Unable to open the "+i._storeName+" IndexedDB database."+(" "+e.target.error.message+".")))};return v}},{key:"_upsertEntities",value:function e(t,r){var n=this;var u=!Array.isArray(r);r=(0,a.ensureArray)(r);if(r.length===0){return i.Promise.resolve(null)}return new i.Promise(function(e,i){n._openTransaction(t,true,function(a){var s=a.objectStore(t);r.forEach(function(e){s.put(e)});a.oncomplete=function(){e(u?r[0]:r)};a.onerror=function(e){i(new o.KinveyError("An error occurred while saving the entities to the "+t+(" collection on the "+n._storeName+" IndexedDB database. "+e.target.error.message+".")))}},i)})}},{key:"_getIndexedDbObj",value:function t(){return e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.msIndexedDB}},{key:"_openDb",value:function e(){var t=h[this._storeName];var r=this._getIndexedDbObj();if((0,a.isDefined)(t)){var n=t.version+1;t.close();return r.open(this._storeName,n)}return r.open(this._storeName)}},{key:"_getDb",value:function e(){var t=this;var r=h[this._storeName];if(r){return i.Promise.resolve(r)}return new i.Promise(function(e,r){var n=function t(r){var n=r.target.result;e(n)};var i=t._openDb();i.onupgradeneeded=n;i.onsuccess=n;i.onerror=function(e){return r(e)}})}}]);return r}(u.KeyValueStorePersister)}).call(t,r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BrowserKeyValuePersister=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(7);var u=r(55);var a=r(38);function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var l=t.BrowserKeyValuePersister=function(e){f(t,e);function t(e,r,n){s(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n));i._store=e;return i}n(t,[{key:"getKeys",value:function e(){return i.Promise.resolve(Object.keys(this._store))}},{key:"_readFromPersistance",value:function e(t){var r=this._store.getItem(t);return this._deserialize(r)}},{key:"_writeToPersistance",value:function e(t,r){var n=this;return this._ensureCollectionExists(t).then(function(){return n._serializeAndSet(t,r)})}},{key:"_deleteFromPersistance",value:function e(t){this._store.removeItem(t);return i.Promise.resolve()}},{key:"_buildMasterCollectionName",value:function e(){return o.Client.sharedInstance().appKey+"."+a.browserStorageCollectionsMaster}},{key:"_ensureCollectionExists",value:function e(t){var r=this;var n=this._buildMasterCollectionName();return this._readFromPersistance(n).then(function(e){e=e||[];var o=e.find(function(e){return e===t});if(o){return i.Promise.resolve()}e.push(t);return r._serializeAndSet(n,e)})}},{key:"_serializeAndSet",value:function e(t,r){var n=this;return this._serialize(r).then(function(e){return n._store.setItem(t,e)})}},{key:"_serialize",value:function e(t){try{return i.Promise.resolve(JSON.stringify(t))}catch(e){return i.Promise.reject(e)}}},{key:"_deserialize",value:function e(t){try{var r=JSON.parse(t);return i.Promise.resolve(r)}catch(e){return i.Promise.reject(e)}}}]);return t}(u.KeyValuePersister)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SqlKeyValueStorePersister=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=r(1);var u=r(88);var a=r(38);var s=r(3);function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.SqlKeyValueStorePersister=function(e){l(t,e);function t(e,r,n){c(this,t);var i=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n));i._sqlModule=e;return i}n(t,[{key:"getKeys",value:function e(){var t="SELECT name AS value FROM #{collection} WHERE type = ?";return this._sqlModule.openTransaction(a.sqliteCollectionsMaster,t,["table"],false).then(function(e){return e.filter(function(e){if(e==="_QueryCache"||e==="__testSupport__"){return true}return/^[a-zA-Z0-9-]{1,128}/.test(e)})})}},{key:"_readFromPersistance",value:function e(t){var r="SELECT value FROM #{collection}";return this._sqlModule.openTransaction(t,r,[]).catch(function(){return[]})}},{key:"_writeToPersistance",value:function e(t,r){var n=this;if(!r){return i.Promise.reject(new o.KinveyError("Invalid or missing entities array"))}return this._deleteFromPersistance(t).then(function(){return n._upsertEntities(t,r)})}},{key:"_deleteFromPersistance",value:function e(t){return this._sqlModule.openTransaction(t,"DELETE FROM #{collection}",undefined,true).then(function(e){return{count:e}})}},{key:"_readEntityFromPersistance",value:function e(t,r){var n="SELECT value FROM #{collection} WHERE key = ?";return this._sqlModule.openTransaction(t,n,[r]).then(function(e){return e[0]})}},{key:"_writeEntitiesToPersistance",value:function e(t,r){return this._upsertEntities(t,(0,s.ensureArray)(r))}},{key:"_deleteEntityFromPersistance",value:function e(t,r){var n="DELETE FROM #{collection} WHERE key = ?";return this._sqlModule.openTransaction(t,n,[r],true)}},{key:"_upsertEntities",value:function e(t,r){var n=!Array.isArray(r);r=(0,s.ensureArray)(r);if(r.length===0){return i.Promise.resolve(null)}var o=r.map(function(e){return["REPLACE INTO #{collection} (key, value) VALUES (?, ?)",[e._id,JSON.stringify(e)]]});return this._sqlModule.openTransaction(t,o,null,true).then(function(){return n?r[0]:r})}}]);return t}(u.KeyValueStorePersister)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.repositoryProvider=undefined;var n=r(2);var i=r(21);var o=v(i);var u=r(7);var a=r(1);var s=r(138);var c=r(141);var f=r(137);var l=r(3);var h=r(16);var d=r(65);var p=r(54);function v(e){return e&&e.__esModule?e:{default:e}}function y(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var b=function e(t){var r=new d.MemoryKeyValuePersister;return new s.InmemoryOfflineRepository(r,t)};var _=new h.PromiseQueueByKey;var g=void 0;var m=y({},f.StorageProvider.Memory,b);function w(){return u.Client.sharedInstance().storage}function O(e){return e.create(p.testSupportCollection,{_id:"1"})}function k(e){var t=m[e];if(!t){var r='The requested storage provider "'+e+'" is not available in this environment';throw new a.KinveyError(r)}return t(_)}function P(e){return e.reduce(function(e,t){return e.catch(function(){var e=k(t);return O(e).then(function(){return e})})},n.Promise.reject())}function E(){var e=(0,l.ensureArray)(w());return P(e).catch(function(){var e="None of the selected storage providers are supported in this environment.";return n.Promise.reject(new a.KinveyError(e))})}function j(){if(!g){g=E()}return g}function S(){return new c.NetworkRepository}function C(e){m=e}function M(){return(0,o.default)(m)}var T=t.repositoryProvider={getNetworkRepository:S,getOfflineRepository:j,setSupportedRepoBuilders:C,getSupportedStorages:M}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.processorFactory=undefined;var n=r(17);var i=r(86);var o=r(144);var u=r(136);var a=r(57);function s(){var e=a.syncManagerProvider.getSyncManager();return new i.OfflineDataProcessor(e)}function c(){return new o.NetworkDataProcessor}function f(){var e=n.repositoryProvider.getNetworkRepository();var t=a.syncManagerProvider.getSyncManager();return new u.CacheOfflineDataProcessor(t,e)}var l=t.processorFactory={getOfflineProcessor:s,getNetworkProcessor:c,getCacheOfflineDataProcessor:f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getPlatformConfig=c;t.setPlatformConfig=f;var n=r(12);var i=a(n);var o=r(22);var u=r(386);function a(e){return e&&e.__esModule?e:{default:e}}var s=void 0;function c(){if(!s){o.Log.debug("getPlatformConfig() called before setPlatformConfig()");return u.platformConfigs.base}return s}function f(e){s=(0,i.default)(u.platformConfigs.base,u.platformConfigs[e]||{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.platformConfigs=undefined;var n;var i=r(146);function o(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var u=2;var a=t.platformConfigs=(n={base:{maxConcurrentPushRequests:100,maxConcurrentPullRequests:32}},o(n,i.platformName.nativeScript,{maxConcurrentPullRequests:u}),o(n,i.platformName.phoneGap,{maxConcurrentPullRequests:u}),n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.syncManagerProvider=undefined;var n=r(145);var i=r(17);var o=r(149);function u(){return new o.SyncStateManager}function a(){var e=i.repositoryProvider.getNetworkRepository();var t=u();return new n.SyncManager(e,t)}var s=t.syncManagerProvider={getSyncManager:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DataStore=t.DataStoreType=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(10);var o=p(i);var u=r(1);var a=r(3);var s=r(77);var c=r(74);var f=r(150);var l=r(37);var h=r(17);var d=r(16);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var y=t.DataStoreType={Cache:"Cache",Network:"Network",Sync:"Sync"};Object.freeze(y);var b=function(){function e(){v(this,e);throw new u.KinveyError("Not allowed to construct a DataStore instance."+" Please use the collection() function to get a DataStore instance.")}n(e,null,[{key:"collection",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:y.Cache;var n=arguments[2];var i=void 0;var h=n&&"tag"in n;if((0,a.isDefined)(t)===false||(0,o.default)(t)===false){throw new u.KinveyError("A collection is required and must be a string.")}if(h&&!(0,d.isValidDataStoreTag)(n.tag)){throw new u.KinveyError("Please provide a valid data store tag.")}switch(r){case y.Network:{if(h){throw new u.KinveyError('The tagged option is not valid for data stores of type "Network"')}var p=l.processorFactory.getNetworkProcessor();i=new s.NetworkStore(t,p,n);break}case y.Sync:{var v=l.processorFactory.getOfflineProcessor();i=new f.SyncStore(t,v,n);break}case y.Cache:default:{var b=l.processorFactory.getCacheOfflineDataProcessor();i=new c.CacheStore(t,b,n)}}return i}},{key:"getInstance",value:function e(t,r,n){return this.collection(t,r,n)}},{key:"clearCache",value:function e(){return h.repositoryProvider.getOfflineRepository().then(function(e){return e.clear()}).then(function(){return null})}}]);return e}();t.DataStore=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.randomString=i;t.isNonemptyString=o;t.uuidv4=u;function n(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;var t="";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<e;n+=1){t+=r.charAt(Math.floor(Math.random()*r.length))}return t}function i(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:18;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";return""+t+n(e)}function o(e){return typeof e==="string"&&e!==""}function u(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return""+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.appendQuery=m;var n=r(20);var i=_(n);var o=r(89);var u=_(o);var a=r(12);var s=_(a);var c=r(6);var f=_(c);var l=r(33);var h=_(l);var d=r(10);var p=_(d);var v=r(26);var y=_(v);var b=r(106);function _(e){return e&&e.__esModule?e:{default:e}}function g(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments[2];var n=[];var i=false;if((0,f.default)(e)&&(0,b.isDefined)(r)){i=true}Object.keys(e).forEach(function(o){var u=void 0;var a=e[o];var s=r?r+"["+(i?"":o)+"]":o;if((0,b.isDefined)(a)===false){if(t.removeNull===true){return}u=t.encodeComponents===true?encodeURIComponent(s):s}else if((0,h.default)(a)){u=g(a,t,s)}else{u=t.encodeComponents?encodeURIComponent(s)+"="+encodeURIComponent(a):s+"="+a}n.push(u)});return n.join("&")}function m(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=i.default.parse(e,true);var o=(0,p.default)(t)?u.default.parse(t):t;var a=(0,s.default)({},n.query,o);r=(0,s.default)({encodeComponents:true,removeNull:false},r);n.query=null;var c=g(a,r);n.search=(0,b.isDefined)(c)&&(0,y.default)(c)===false?"?"+c:null;return i.default.format(n)}},function(e,t,r){"use strict";var n=r(151);var i=r(152);var o={brackets:function e(t){return t+"[]"},indices:function e(t,r){return t+"["+r+"]"},repeat:function e(t){return t}};var u=Date.prototype.toISOString;var a={delimiter:"&",encode:true,encoder:n.encode,encodeValuesOnly:false,serializeDate:function e(t){return u.call(t)},skipNulls:false,strictNullHandling:false};var s=function e(t,r,i,o,u,s,c,f,l,h,d,p){var v=t;if(typeof c==="function"){v=c(r,v)}else if(v instanceof Date){v=h(v)}else if(v===null){if(o){return s&&!p?s(r,a.encoder):r}v=""}if(typeof v==="string"||typeof v==="number"||typeof v==="boolean"||n.isBuffer(v)){if(s){var y=p?r:s(r,a.encoder);return[d(y)+"="+d(s(v,a.encoder))]}return[d(r)+"="+d(String(v))]}var b=[];if(typeof v==="undefined"){return b}var _;if(Array.isArray(c)){_=c}else{var g=Object.keys(v);_=f?g.sort(f):g}for(var m=0;m<_.length;++m){var w=_[m];if(u&&v[w]===null){continue}if(Array.isArray(v)){b=b.concat(e(v[w],i(r,w),i,o,u,s,c,f,l,h,d,p))}else{b=b.concat(e(v[w],r+(l?"."+w:"["+w+"]"),i,o,u,s,c,f,l,h,d,p))}}return b};e.exports=function(e,t){var r=e;var u=t?n.assign({},t):{};if(u.encoder!==null&&u.encoder!==undefined&&typeof u.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var c=typeof u.delimiter==="undefined"?a.delimiter:u.delimiter;var f=typeof u.strictNullHandling==="boolean"?u.strictNullHandling:a.strictNullHandling;var l=typeof u.skipNulls==="boolean"?u.skipNulls:a.skipNulls;var h=typeof u.encode==="boolean"?u.encode:a.encode;var d=typeof u.encoder==="function"?u.encoder:a.encoder;var p=typeof u.sort==="function"?u.sort:null;var v=typeof u.allowDots==="undefined"?false:u.allowDots;var y=typeof u.serializeDate==="function"?u.serializeDate:a.serializeDate;var b=typeof u.encodeValuesOnly==="boolean"?u.encodeValuesOnly:a.encodeValuesOnly;if(typeof u.format==="undefined"){u.format=i["default"]}else if(!Object.prototype.hasOwnProperty.call(i.formatters,u.format)){throw new TypeError("Unknown format option provided.")}var _=i.formatters[u.format];var g;var m;if(typeof u.filter==="function"){m=u.filter;r=m("",r)}else if(Array.isArray(u.filter)){m=u.filter;g=m}var w=[];if(typeof r!=="object"||r===null){return""}var O;if(u.arrayFormat in o){O=u.arrayFormat}else if("indices"in u){O=u.indices?"indices":"repeat"}else{O="indices"}var k=o[O];if(!g){g=Object.keys(r)}if(p){g.sort(p)}for(var P=0;P<g.length;++P){var E=g[P];if(l&&r[E]===null){continue}w=w.concat(s(r[E],E,k,f,l,h?d:null,m,p,v,y,_,b))}var j=w.join(c);var S=u.addQueryPrefix===true?"?":"";return j.length>0?S+j:""}},function(e,t,r){"use strict";var n=r(151);var i=Object.prototype.hasOwnProperty;var o={allowDots:false,allowPrototypes:false,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:false,strictNullHandling:false};var u=function e(t,r){var n={};var u=r.ignoreQueryPrefix?t.replace(/^\?/,""):t;var a=r.parameterLimit===Infinity?undefined:r.parameterLimit;var s=u.split(r.delimiter,a);for(var c=0;c<s.length;++c){var f=s[c];var l=f.indexOf("]=");var h=l===-1?f.indexOf("="):l+1;var d,p;if(h===-1){d=r.decoder(f,o.decoder);p=r.strictNullHandling?null:""}else{d=r.decoder(f.slice(0,h),o.decoder);p=r.decoder(f.slice(h+1),o.decoder)}if(i.call(n,d)){n[d]=[].concat(n[d]).concat(p)}else{n[d]=p}}return n};var a=function(e,t,r){var n=t;for(var i=e.length-1;i>=0;--i){var o;var u=e[i];if(u==="[]"){o=[];o=o.concat(n)}else{o=r.plainObjects?Object.create(null):{};var a=u.charAt(0)==="["&&u.charAt(u.length-1)==="]"?u.slice(1,-1):u;var s=parseInt(a,10);if(!isNaN(s)&&u!==a&&String(s)===a&&s>=0&&(r.parseArrays&&s<=r.arrayLimit)){o=[];o[s]=n}else{o[a]=n}}n=o}return n};var s=function e(t,r,n){if(!t){return}var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t;var u=/(\[[^[\]]*])/;var s=/(\[[^[\]]*])/g;var c=u.exec(o);var f=c?o.slice(0,c.index):o;var l=[];if(f){if(!n.plainObjects&&i.call(Object.prototype,f)){if(!n.allowPrototypes){return}}l.push(f)}var h=0;while((c=s.exec(o))!==null&&h<n.depth){h+=1;if(!n.plainObjects&&i.call(Object.prototype,c[1].slice(1,-1))){if(!n.allowPrototypes){return}}l.push(c[1])}if(c){l.push("["+o.slice(c.index)+"]")}return a(l,r,n)};e.exports=function(e,t){var r=t?n.assign({},t):{};if(r.decoder!==null&&r.decoder!==undefined&&typeof r.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}r.ignoreQueryPrefix=r.ignoreQueryPrefix===true;r.delimiter=typeof r.delimiter==="string"||n.isRegExp(r.delimiter)?r.delimiter:o.delimiter;r.depth=typeof r.depth==="number"?r.depth:o.depth;r.arrayLimit=typeof r.arrayLimit==="number"?r.arrayLimit:o.arrayLimit;r.parseArrays=r.parseArrays!==false;r.decoder=typeof r.decoder==="function"?r.decoder:o.decoder;r.allowDots=typeof r.allowDots==="boolean"?r.allowDots:o.allowDots;r.plainObjects=typeof r.plainObjects==="boolean"?r.plainObjects:o.plainObjects;r.allowPrototypes=typeof r.allowPrototypes==="boolean"?r.allowPrototypes:o.allowPrototypes;r.parameterLimit=typeof r.parameterLimit==="number"?r.parameterLimit:o.parameterLimit;r.strictNullHandling=typeof r.strictNullHandling==="boolean"?r.strictNullHandling:o.strictNullHandling;if(e===""||e===null||typeof e==="undefined"){return r.plainObjects?Object.create(null):{}}var i=typeof e==="string"?u(e,r):e;var a=r.plainObjects?Object.create(null):{};var c=Object.keys(i);for(var f=0;f<c.length;++f){var l=c[f];var h=s(l,i[l],r);a=n.merge(a,h,r)}return n.compact(a)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KinveyRequest=t.Properties=t.AuthType=t.NetworkRequest=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=function e(t,r,n,i){var o=Object.getOwnPropertyDescriptor(t,r);if(o===undefined){var u=Object.getPrototypeOf(t);if(u!==null){e(u,r,n,i)}}else if("value"in o&&o.writable){o.value=n}else{var a=o.set;if(a!==undefined){a.call(i,n)}}return n};var o=function e(t,r,n){if(t===null)t=Function.prototype;var i=Object.getOwnPropertyDescriptor(t,r);if(i===undefined){var o=Object.getPrototypeOf(t);if(o===null){return undefined}else{return e(o,r,n)}}else if("value"in i){return i.value}else{var u=i.get;if(u===undefined){return undefined}return u.call(n)}};var u=r(2);var a=T(u);var s=r(394);var c=r(89);var f=T(c);var l=r(12);var h=T(l);var d=r(119);var p=T(d);var v=r(26);var y=T(v);var b=r(20);var _=T(b);var g=r(10);var m=T(g);var w=r(7);var O=r(15);var k=r(63);var P=r(3);var E=r(1);var j=r(153);var S=r(42);var C=r(154);var M=r(90);function T(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function x(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function R(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var I=t.NetworkRequest=function(e){R(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};A(this,t);var r=x(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.rack=C.NetworkRack;return r}return t}(j.Request);var N=t.AuthType={All:"All",App:"App",Basic:"Basic",Default:"Default",Master:"Master",None:"None",Session:"Session",Client:"Client"};Object.freeze(N);var D={all:function e(t){return D.session(t).catch(function(){return D.basic(t)})},app:function e(t){if(!t.appKey||!t.appSecret){return a.default.reject(new Error("Missing client appKey and/or appSecret."+" Use Kinvey.initialize() to set the appKey and appSecret for the client."))}return a.default.resolve({scheme:"Basic",username:t.appKey,password:t.appSecret})},basic:function e(t){return D.master(t).catch(function(){return D.app(t)})},client:function e(t,r){if(!t.appKey||!t.appSecret){return a.default.reject(new Error("Missing client appKey and/or appSecret"+" Use Kinvey.initialize() to set the appKey and appSecret for the client."))}if(!r){r=t.appKey}return a.default.resolve({scheme:"Basic",username:r,password:t.appSecret})},master:function e(t){if(!t.appKey||!t.masterSecret){return a.default.reject(new Error("Missing client appKey and/or masterSecret."+" Use Kinvey.initialize() to set the appKey and masterSecret for the client."))}return a.default.resolve({scheme:"Basic",username:t.appKey,password:t.masterSecret})},none:function e(){return a.default.resolve(null)},session:function e(t){var r=t.getActiveUser();if(!(0,P.isDefined)(r)){return a.default.reject(new E.NoActiveUserError("There is not an active user. Please login a user and retry the request."))}return a.default.resolve({scheme:"Kinvey",credentials:r._kmd.authtoken})}};function q(e){if(e){var t=0;var r=e.length;e=String(e||"");for(var n=0;n<r;n+=1){var i=encodeURI(e[n]).split("%").length;t+=i===1?1:i-1}return t}return 0}var U=t.Properties=function(e){R(t,e);function t(){A(this,t);return x(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(S.Headers);var K=t.KinveyRequest=function(e){R(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};A(this,t);var r=x(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));e=(0,h.default)({skipBL:false,trace:false},e);r.authType=e.authType||N.None;r.query=e.query;r.aggregation=e.aggregation;r.properties=e.properties||new U;r.skipBL=e.skipBL===true;r.trace=e.trace===true;r.clientId=e.clientId;r.kinveyFileTTL=e.kinveyFileTTL;r.kinveyFileTLS=e.kinveyFileTLS;return r}n(t,[{key:"getAuthorizationHeader",value:function e(){var t=this;var r=a.default.resolve(undefined);if(this.authType){switch(this.authType){case N.All:r=D.all(this.client);break;case N.App:r=D.app(this.client);break;case N.Basic:r=D.basic(this.client);break;case N.Client:r=D.client(this.client,this.clientId);break;case N.Master:r=D.master(this.client);break;case N.None:r=D.none(this.client);break;case N.Session:r=D.session(this.client);break;default:r=D.session(this.client).catch(function(e){return D.master(t.client).catch(function(){throw e})})}}return r.then(function(e){if((0,P.isDefined)(e)){var t=e.credentials;if(e.username){t=new s.Buffer(e.username+":"+e.password).toString("base64")}return e.scheme+" "+t}return undefined})}},{key:"execute",value:function e(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return this.getAuthorizationHeader().then(function(e){if((0,P.isDefined)(e)){r.headers.set("Authorization",e)}else{r.headers.remove("Authorization")}}).then(function(){return o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"execute",r).call(r)}).then(function(e){if(e instanceof M.KinveyResponse===false){e=new M.KinveyResponse({statusCode:e.statusCode,headers:e.headers,data:e.data})}if(n===false&&e.isSuccess()===false){throw e.error}return e}).catch(function(e){if(i&&e instanceof E.InvalidCredentialsError){var o=r.client.getActiveUser();if((0,P.isDefined)(o)){var u=(0,P.isDefined)(o._socialIdentity)?o._socialIdentity:{};var s=Object.keys(u).find(function(e){return u[e].identity==="kinveyAuth"});var c=u[s];if((0,P.isDefined)(c)){var f=new t({method:j.RequestMethod.POST,headers:{"Content-Type":"application/x-www-form-urlencoded"},authType:N.App,url:_.default.format({protocol:r.client.micProtocol,host:r.client.micHost,pathname:"/oauth/token"}),body:{grant_type:"refresh_token",client_id:c.client_id,redirect_uri:c.redirect_uri,refresh_token:c.refresh_token},properties:r.properties,timeout:r.timeout});return f.execute().then(function(e){return e.data}).then(function(e){e.identity=c.identity;e.client_id=c.client_id;e.redirect_uri=c.redirect_uri;e.protocol=r.client.micProtocol;e.host=r.client.micHost;return e}).then(function(e){var n={};u[e.identity]=e;n._socialIdentity=u;var i=new t({method:j.RequestMethod.POST,authType:N.App,url:_.default.format({protocol:r.client.apiProtocol,host:r.client.apiHost,pathname:"/user/"+r.client.appKey+"/login"}),properties:r.properties,body:n,timeout:r.timeout,client:r.client});return i.execute().then(function(e){return e.data}).then(function(t){t._socialIdentity[e.identity]=(0,p.default)(t._socialIdentity[e.identity],e);return r.client.setActiveUser(t)})}).then(function(){return r.execute(n,false)}).catch(function(){return a.default.reject(e)})}}}return a.default.reject(e)})}},{key:"appVersion",get:function e(){return this.client.appVersion}},{key:"query",get:function e(){return this._query},set:function e(t){if((0,P.isDefined)(t)&&!(t instanceof O.Query)){throw new E.KinveyError("Invalid query. It must be an instance of the Query class.")}this._query=t}},{key:"aggregation",get:function e(){return this._aggregation},set:function e(t){if((0,P.isDefined)(t)&&!(t instanceof k.Aggregation)){throw new E.KinveyError("Invalid aggregation. It must be an instance of the Aggregation class.")}if((0,P.isDefined)(t)){this.body=t.toPlainObject()}this._aggregation=t}},{key:"headers",get:function e(){var r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",this);if(!r.has("Accept")){r.set("Accept","application/json; charset=utf-8")}if(!r.has("Content-Type")){r.set("Content-Type","application/json; charset=utf-8")}if(!r.has("X-Kinvey-Api-Version")){r.set("X-Kinvey-Api-Version",4)}if(this.skipBL===true){r.set("X-Kinvey-Skip-Business-Logic",true)}else{r.remove("X-Kinvey-Skip-Business-Logic")}if(this.trace===true){r.set("X-Kinvey-Include-Headers-In-Response","X-Kinvey-Request-Id");r.set("X-Kinvey-ResponseWrapper",true)}else{r.remove("X-Kinvey-Include-Headers-In-Response");r.remove("X-Kinvey-ResponseWrapper")}if(this.appVersion){r.set("X-Kinvey-Client-App-Version",this.appVersion)}else{r.remove("X-Kinvey-Client-App-Version")}if(this.properties){var n=this.properties.toString();if(!(0,y.default)(n)){var i=q(n);if(i>=2e3){throw new Error("The custom properties are "+i+" bytes."+"It must be less then 2000 bytes.","Please remove some custom properties.")}r.set("X-Kinvey-Custom-Request-Properties",n)}else{r.remove("X-Kinvey-Custom-Request-Properties")}}else{r.remove("X-Kinvey-Custom-Request-Properties")}return r},set:function e(r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"headers",r,this)}},{key:"url",get:function e(){var r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",this);var n={kinveyfile_ttl:this.kinveyFileTTL,kinveyfile_tls:this.kinveyFileTLS};if(this.query){n=Object.assign({},n,this.query.toQueryString())}if((0,y.default)(n)){return r}return(0,P.appendQuery)(r,f.default.stringify(n))},set:function e(r){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"url",r,this)}},{key:"properties",get:function e(){return this._properties},set:function e(t){if(t&&t instanceof U===false){t=new U(t)}this._properties=t}}],[{key:"execute",value:function e(r,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var o=(0,h.default)({method:j.RequestMethod.GET,authType:N.Default},r);n=n||w.Client.sharedInstance();if(!o.url&&(0,m.default)(o.pathname)&&n){o.url=_.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:o.pathname})}var u=new t(o).execute();if(i){u=u.then(function(e){return e.data})}return u}}]);return t}(I)},function(e,t,r){"use strict";(function(e){var n=r(395);var i=r(396);var o=r(397);t.Buffer=c;t.SlowBuffer=g;t.INSPECT_MAX_BYTES=50;c.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==undefined?e.TYPED_ARRAY_SUPPORT:u();t.kMaxLength=a();function u(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42&&typeof e.subarray==="function"&&e.subarray(1,1).byteLength===0}catch(e){return false}}function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t){throw new RangeError("Invalid typed array length")}if(c.TYPED_ARRAY_SUPPORT){e=new Uint8Array(t);e.__proto__=c.prototype}else{if(e===null){e=new c(t)}e.length=t}return e}function c(e,t,r){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c)){return new c(e,t,r)}if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return d(this,e)}return f(this,e,t,r)}c.poolSize=8192;c._augment=function(e){e.__proto__=c.prototype;return e};function f(e,t,r,n){if(typeof t==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&t instanceof ArrayBuffer){return y(e,t,r,n)}if(typeof t==="string"){return p(e,t,r)}return b(e,t)}c.from=function(e,t,r){return f(null,e,t,r)};if(c.TYPED_ARRAY_SUPPORT){c.prototype.__proto__=Uint8Array.prototype;c.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&c[Symbol.species]===c){Object.defineProperty(c,Symbol.species,{value:null,configurable:true})}}function l(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be a number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function h(e,t,r,n){l(t);if(t<=0){return s(e,t)}if(r!==undefined){return typeof n==="string"?s(e,t).fill(r,n):s(e,t).fill(r)}return s(e,t)}c.alloc=function(e,t,r){return h(null,e,t,r)};function d(e,t){l(t);e=s(e,t<0?0:_(t)|0);if(!c.TYPED_ARRAY_SUPPORT){for(var r=0;r<t;++r){e[r]=0}}return e}c.allocUnsafe=function(e){return d(null,e)};c.allocUnsafeSlow=function(e){return d(null,e)};function p(e,t,r){if(typeof r!=="string"||r===""){r="utf8"}if(!c.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=m(t,r)|0;e=s(e,n);var i=e.write(t,r);if(i!==n){e=e.slice(0,i)}return e}function v(e,t){var r=t.length<0?0:_(t.length)|0;e=s(e,r);for(var n=0;n<r;n+=1){e[n]=t[n]&255}return e}function y(e,t,r,n){t.byteLength;if(r<0||t.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(t.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){t=new Uint8Array(t)}else if(n===undefined){t=new Uint8Array(t,r)}else{t=new Uint8Array(t,r,n)}if(c.TYPED_ARRAY_SUPPORT){e=t;e.__proto__=c.prototype}else{e=v(e,t)}return e}function b(e,t){if(c.isBuffer(t)){var r=_(t.length)|0;e=s(e,r);if(e.length===0){return e}t.copy(e,0,0,r);return e}if(t){if(typeof ArrayBuffer!=="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t){if(typeof t.length!=="number"||te(t.length)){return s(e,0)}return v(e,t)}if(t.type==="Buffer"&&o(t.data)){return v(e,t.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(e){if(e>=a()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+a().toString(16)+" bytes")}return e|0}function g(e){if(+e!=e){e=0}return c.alloc(+e)}c.isBuffer=function e(t){return!!(t!=null&&t._isBuffer)};c.compare=function e(t,r){if(!c.isBuffer(t)||!c.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var i=r.length;for(var o=0,u=Math.min(n,i);o<u;++o){if(t[o]!==r[o]){n=t[o];i=r[o];break}}if(n<i)return-1;if(i<n)return 1;return 0};c.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};c.concat=function e(t,r){if(!o(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return c.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=c.allocUnsafe(r);var u=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a)){throw new TypeError('"list" argument must be an Array of Buffers')}a.copy(i,u);u+=a.length}return i};function m(e,t){if(c.isBuffer(e)){return e.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Z(e).length;default:if(n)return Y(e).length;t=(""+t).toLowerCase();n=true}}}c.byteLength=m;function w(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return q(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return N(this,t,r);case"latin1":case"binary":return D(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}c.prototype._isBuffer=true;function O(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}c.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){O(this,r,r+1)}return this};c.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){O(this,r,r+3);O(this,r+1,r+2)}return this};c.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){O(this,r,r+7);O(this,r+1,r+6);O(this,r+2,r+5);O(this,r+3,r+4)}return this};c.prototype.toString=function e(){var t=this.length|0;if(t===0)return"";if(arguments.length===0)return x(this,0,t);return w.apply(this,arguments)};c.prototype.equals=function e(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return c.compare(this,t)===0};c.prototype.inspect=function e(){var r="";var n=t.INSPECT_MAX_BYTES;if(this.length>0){r=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)r+=" ... "}return"<Buffer "+r+">"};c.prototype.compare=function e(t,r,n,i,o){if(!c.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(o===undefined){o=this.length}if(r<0||n>t.length||i<0||o>this.length){throw new RangeError("out of range index")}if(i>=o&&r>=n){return 0}if(i>=o){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;o>>>=0;if(this===t)return 0;var u=o-i;var a=n-r;var s=Math.min(u,a);var f=this.slice(i,o);var l=t.slice(r,n);for(var h=0;h<s;++h){if(f[h]!==l[h]){u=f[h];a=l[h];break}}if(u<a)return-1;if(a<u)return 1;return 0};function k(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=c.from(t,n)}if(c.isBuffer(t)){if(t.length===0){return-1}return P(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(c.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return P(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function P(e,t,r,n,i){var o=1;var u=e.length;var a=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}o=2;u/=2;a/=2;r/=2}}function s(e,t){if(o===1){return e[t]}else{return e.readUInt16BE(t*o)}}var c;if(i){var f=-1;for(c=r;c<u;c++){if(s(e,c)===s(t,f===-1?0:c-f)){if(f===-1)f=c;if(c-f+1===a)return f*o}else{if(f!==-1)c-=c-f;f=-1}}}else{if(r+a>u)r=u-a;for(c=r;c>=0;c--){var l=true;for(var h=0;h<a;h++){if(s(e,c+h)!==s(t,h)){l=false;break}}if(l)return c}}return-1}c.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};c.prototype.indexOf=function e(t,r,n){return k(this,t,r,n,true)};c.prototype.lastIndexOf=function e(t,r,n){return k(this,t,r,n,false)};function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");if(n>o/2){n=o/2}for(var u=0;u<n;++u){var a=parseInt(t.substr(u*2,2),16);if(isNaN(a))return u;e[r+u]=a}return u}function j(e,t,r,n){return ee(Y(t,e.length-r),e,r,n)}function S(e,t,r,n){return ee(J(t),e,r,n)}function C(e,t,r,n){return S(e,t,r,n)}function M(e,t,r,n){return ee(Z(t),e,r,n)}function T(e,t,r,n){return ee(X(t,e.length-r),e,r,n)}c.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var o=this.length-r;if(n===undefined||n>o)n=o;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var u=false;for(;;){switch(i){case"hex":return E(this,t,r,n);case"utf8":case"utf-8":return j(this,t,r,n);case"ascii":return S(this,t,r,n);case"latin1":case"binary":return C(this,t,r,n);case"base64":return M(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,r,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();u=true}}};c.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function x(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var u=null;var a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var s,c,f,l;switch(a){case 1:if(o<128){u=o}break;case 2:s=e[i+1];if((s&192)===128){l=(o&31)<<6|s&63;if(l>127){u=l}}break;case 3:s=e[i+1];c=e[i+2];if((s&192)===128&&(c&192)===128){l=(o&15)<<12|(s&63)<<6|c&63;if(l>2047&&(l<55296||l>57343)){u=l}}break;case 4:s=e[i+1];c=e[i+2];f=e[i+3];if((s&192)===128&&(c&192)===128&&(f&192)===128){l=(o&15)<<18|(s&63)<<12|(c&63)<<6|f&63;if(l>65535&&l<1114112){u=l}}}}if(u===null){u=65533;a=1}else if(u>65535){u-=65536;n.push(u>>>10&1023|55296);u=56320|u&1023}n.push(u);i+=a}return I(n)}var R=4096;function I(e){var t=e.length;if(t<=R){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=R))}return r}function N(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function q(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;++o){i+=W(e[o])}return i}function U(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}c.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i;if(c.TYPED_ARRAY_SUPPORT){i=this.subarray(t,r);i.__proto__=c.prototype}else{var o=r-t;i=new c(o,undefined);for(var u=0;u<o;++u){i[u]=this[u+t]}}return i};function K(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)K(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}return i};c.prototype.readUIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n){K(t,r,this.length)}var i=this[t+--r];var o=1;while(r>0&&(o*=256)){i+=this[t+--r]*o}return i};c.prototype.readUInt8=function e(t,r){if(!r)K(t,1,this.length);return this[t]};c.prototype.readUInt16LE=function e(t,r){if(!r)K(t,2,this.length);return this[t]|this[t+1]<<8};c.prototype.readUInt16BE=function e(t,r){if(!r)K(t,2,this.length);return this[t]<<8|this[t+1]};c.prototype.readUInt32LE=function e(t,r){if(!r)K(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};c.prototype.readUInt32BE=function e(t,r){if(!r)K(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};c.prototype.readIntLE=function e(t,r,n){t=t|0;r=r|0;if(!n)K(t,r,this.length);var i=this[t];var o=1;var u=0;while(++u<r&&(o*=256)){i+=this[t+u]*o}o*=128;if(i>=o)i-=Math.pow(2,8*r);return i};c.prototype.readIntBE=function e(t,r,n){t=t|0;r=r|0;if(!n)K(t,r,this.length);var i=r;var o=1;var u=this[t+--i];while(i>0&&(o*=256)){u+=this[t+--i]*o}o*=128;if(u>=o)u-=Math.pow(2,8*r);return u};c.prototype.readInt8=function e(t,r){if(!r)K(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};c.prototype.readInt16LE=function e(t,r){if(!r)K(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};c.prototype.readInt16BE=function e(t,r){if(!r)K(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};c.prototype.readInt32LE=function e(t,r){if(!r)K(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};c.prototype.readInt32BE=function e(t,r){if(!r)K(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};c.prototype.readFloatLE=function e(t,r){if(!r)K(t,4,this.length);return i.read(this,t,true,23,4)};c.prototype.readFloatBE=function e(t,r){if(!r)K(t,4,this.length);return i.read(this,t,false,23,4)};c.prototype.readDoubleLE=function e(t,r){if(!r)K(t,8,this.length);return i.read(this,t,true,52,8)};c.prototype.readDoubleBE=function e(t,r){if(!r)K(t,8,this.length);return i.read(this,t,false,52,8)};function L(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var o=Math.pow(2,8*n)-1;L(this,t,r,n,o,0)}var u=1;var a=0;this[r]=t&255;while(++a<n&&(u*=256)){this[r+a]=t/u&255}return r+n};c.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r|0;n=n|0;if(!i){var o=Math.pow(2,8*n)-1;L(this,t,r,n,o,0)}var u=n-1;var a=1;this[r+u]=t&255;while(--u>=0&&(a*=256)){this[r+u]=t/a&255}return r+n};c.prototype.writeUInt8=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,1,255,0);if(!c.TYPED_ARRAY_SUPPORT)t=Math.floor(t);this[r]=t&255;return r+1};function F(e,t,r,n){if(t<0)t=65535+t+1;for(var i=0,o=Math.min(e.length-r,2);i<o;++i){e[r+i]=(t&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}}c.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{F(this,t,r,true)}return r+2};c.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,65535,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{F(this,t,r,false)}return r+2};function B(e,t,r,n){if(t<0)t=4294967295+t+1;for(var i=0,o=Math.min(e.length-r,4);i<o;++i){e[r+i]=t>>>(n?i:3-i)*8&255}}c.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255}else{B(this,t,r,true)}return r+4};c.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,4294967295,0);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{B(this,t,r,false)}return r+4};c.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var o=Math.pow(2,8*n-1);L(this,t,r,n,o-1,-o)}var u=0;var a=1;var s=0;this[r]=t&255;while(++u<n&&(a*=256)){if(t<0&&s===0&&this[r+u-1]!==0){s=1}this[r+u]=(t/a>>0)-s&255}return r+n};c.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r|0;if(!i){var o=Math.pow(2,8*n-1);L(this,t,r,n,o-1,-o)}var u=n-1;var a=1;var s=0;this[r+u]=t&255;while(--u>=0&&(a*=256)){if(t<0&&s===0&&this[r+u+1]!==0){s=1}this[r+u]=(t/a>>0)-s&255}return r+n};c.prototype.writeInt8=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,1,127,-128);if(!c.TYPED_ARRAY_SUPPORT)t=Math.floor(t);if(t<0)t=255+t+1;this[r]=t&255;return r+1};c.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8}else{F(this,t,r,true)}return r+2};c.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,2,32767,-32768);if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>8;this[r+1]=t&255}else{F(this,t,r,false)}return r+2};c.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,2147483647,-2147483648);if(c.TYPED_ARRAY_SUPPORT){this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24}else{B(this,t,r,true)}return r+4};c.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r|0;if(!n)L(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;if(c.TYPED_ARRAY_SUPPORT){this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255}else{B(this,t,r,false)}return r+4};function G(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(e,t,r,n,o){if(!o){G(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}i.write(e,t,r,n,23,4);return r+4}c.prototype.writeFloatLE=function e(t,r,n){return H(this,t,r,true,n)};c.prototype.writeFloatBE=function e(t,r,n){return H(this,t,r,false,n)};function z(e,t,r,n,o){if(!o){G(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}i.write(e,t,r,n,52,8);return r+8}c.prototype.writeDoubleLE=function e(t,r,n){return z(this,t,r,true,n)};c.prototype.writeDoubleBE=function e(t,r,n){return z(this,t,r,false,n)};c.prototype.copy=function e(t,r,n,i){if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var o=i-n;var u;if(this===t&&n<r&&r<i){for(u=o-1;u>=0;--u){t[u+r]=this[u+n]}}else if(o<1e3||!c.TYPED_ARRAY_SUPPORT){for(u=0;u<o;++u){t[u+r]=this[u+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,n+o),r)}return o};c.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(t.length===1){var o=t.charCodeAt(0);if(o<256){t=o}}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!c.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var u;if(typeof t==="number"){for(u=r;u<n;++u){this[u]=t}}else{var a=c.isBuffer(t)?t:Y(new c(t,i).toString());var s=a.length;for(u=0;u<n-r;++u){this[u+r]=a[u%s]}}return this};var Q=/[^+\/0-9A-Za-z-_]/g;function V(e){e=$(e).replace(Q,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function $(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function W(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function Y(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var u=0;u<n;++u){r=e.charCodeAt(u);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(u+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function J(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function X(e,t){var r,n,i;var o=[];for(var u=0;u<e.length;++u){if((t-=2)<0)break;r=e.charCodeAt(u);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function Z(e){return n.toByteArray(V(e))}function ee(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function te(e){return e!==e}}).call(t,r(18))},function(e,t,r){"use strict";t.byteLength=f;t.toByteArray=l;t.fromByteArray=p;var n=[];var i=[];var o=typeof Uint8Array!=="undefined"?Uint8Array:Array;var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var a=0,s=u.length;a<s;++a){n[a]=u[a];i[u.charCodeAt(a)]=a}i["-".charCodeAt(0)]=62;i["_".charCodeAt(0)]=63;function c(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return e[t-2]==="="?2:e[t-1]==="="?1:0}function f(e){return e.length*3/4-c(e)}function l(e){var t,r,n,u,a;var s=e.length;u=c(e);a=new o(s*3/4-u);r=u>0?s-4:s;var f=0;for(t=0;t<r;t+=4){n=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)];a[f++]=n>>16&255;a[f++]=n>>8&255;a[f++]=n&255}if(u===2){n=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4;a[f++]=n&255}else if(u===1){n=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2;a[f++]=n>>8&255;a[f++]=n&255}return a}function h(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function d(e,t,r){var n;var i=[];for(var o=t;o<r;o+=3){n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255);i.push(h(n))}return i.join("")}function p(e){var t;var r=e.length;var i=r%3;var o="";var u=[];var a=16383;for(var s=0,c=r-i;s<c;s+=a){u.push(d(e,s,s+a>c?c:s+a))}if(i===1){t=e[r-1];o+=n[t>>2];o+=n[t<<4&63];o+="=="}else if(i===2){t=(e[r-2]<<8)+e[r-1];o+=n[t>>10];o+=n[t>>4&63];o+=n[t<<2&63];o+="="}u.push(o);return u.join("")}},function(e,t){t.read=function(e,t,r,n,i){var o,u;var a=i*8-n-1;var s=(1<<a)-1;var c=s>>1;var f=-7;var l=r?i-1:0;var h=r?-1:1;var d=e[t+l];l+=h;o=d&(1<<-f)-1;d>>=-f;f+=a;for(;f>0;o=o*256+e[t+l],l+=h,f-=8){}u=o&(1<<-f)-1;o>>=-f;f+=n;for(;f>0;u=u*256+e[t+l],l+=h,f-=8){}if(o===0){o=1-c}else if(o===s){return u?NaN:(d?-1:1)*Infinity}else{u=u+Math.pow(2,n);o=o-c}return(d?-1:1)*u*Math.pow(2,o-n)};t.write=function(e,t,r,n,i,o){var u,a,s;var c=o*8-i-1;var f=(1<<c)-1;var l=f>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:o-1;var p=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){a=isNaN(t)?1:0;u=f}else{u=Math.floor(Math.log(t)/Math.LN2);if(t*(s=Math.pow(2,-u))<1){u--;s*=2}if(u+l>=1){t+=h/s}else{t+=h*Math.pow(2,1-l)}if(t*s>=2){u++;s/=2}if(u+l>=f){a=0;u=f}else if(u+l>=1){a=(t*s-1)*Math.pow(2,i);u=u+l}else{a=t*Math.pow(2,l-1)*Math.pow(2,i);u=0}}for(;i>=8;e[r+d]=a&255,d+=p,a/=256,i-=8){}u=u<<i|a;c+=i;for(;c>0;e[r+d]=u&255,d+=p,u/=256,c-=8){}e[r+d-p]|=v*128}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return r.call(e)=="[object Array]"}},function(e,t,r){var n=r(399),i=r(39),o=r(64),u=r(400),a=r(6);function s(e,t,r){var s=a(e)?n:u,c=arguments.length<3;return s(e,o(t,4),r,c,i)}e.exports=s},function(e,t){function r(e,t,r,n){var i=-1,o=e==null?0:e.length;if(n&&o){r=e[++i]}while(++i<o){r=t(r,e[i],i,e)}return r}e.exports=r},function(e,t){function r(e,t,r,n,i){i(e,function(e,i,o){r=n?(n=false,e):t(r,e,i,o)});return r}e.exports=r},function(e,t,r){var n=r(402),i=r(21);function o(e){return e==null?[]:n(e,i(e))}e.exports=o},function(e,t,r){var n=r(94);function i(e,t){return n(t,function(t){return e[t]})}e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.HttpMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=s(i);var u=r(1);var a=r(58);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.HttpMiddleware=function(e){l(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Http Middleware";c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}n(t,[{key:"handle",value:function e(){return o.default.reject(new u.KinveyError("Unable to send network request.","Please override the core HttpMiddleware."))}},{key:"cancel",value:function e(){return o.default.resolve()}}]);return t}(a.Middleware)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=[];var u=String.fromCharCode(9500);var a=String.fromCharCode(9472);var s=String.fromCharCode(9492);var c=String.fromCharCode(9474);function f(e,t){if(e.level===0){return e.value}var r="\r\n";var n=t?s:u;for(var i=1;i<e.level;i+=1){r=""+r+(o[i]?" ":c);r=r+"  "}return""+r+n+a+" "+e.value}var l=t.AsciiTree=function(){function e(){i(this,e)}n(e,null,[{key:"generate",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments[1];var i=f(r,n);if(r.nodes.length>0){var u=r.nodes.length-1;r.nodes.forEach(function(e,r){o[e.level]=r===u;i+=t.generate(e,r===u)})}return i}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ParseMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=s(i);var u=r(3);var a=r(58);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.ParseMiddleware=function(e){l(t,e);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Parse Middleware";c(this,t);return f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}n(t,[{key:"handle",value:function e(t,r){if((0,u.isDefined)(r)&&(0,u.isDefined)(r.data)){var n=r.headers["content-type"]||r.headers["Content-Type"];if(n){if(n.indexOf("application/json")===0){try{r.data=JSON.parse(r.data)}catch(e){}}}}return o.default.resolve({response:r})}}]);return t}(a.Middleware)},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:true});t.SerializeMiddleware=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=s(i);var u=r(3);var a=r(58);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function l(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var h=t.SerializeMiddleware=function(t){l(r,t);function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"Serialize Middleware";c(this,r);return f(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}n(r,[{key:"handle",value:function t(r){if((0,u.isDefined)(r)&&(0,u.isDefined)(r.body)){var n=r.headers["content-type"]||r.headers["Content-Type"];if((0,u.isDefined)(n)){if(n.indexOf("application/json")===0){r.body=JSON.stringify(r.body)}else if(n.indexOf("application/x-www-form-urlencoded")===0){var i=r.body;var a=[];Object.keys(i).forEach(function(t){a.push(e.encodeURIComponent(t)+"="+e.encodeURIComponent(i[t]))});r.body=a.join("&")}}}return o.default.resolve({request:r})}}]);return r}(a.Middleware)}).call(t,r(18))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Popup=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(83);var o=r(1);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function s(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var c=t.Popup=function(e){s(t,e);function t(){u(this,t);return a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}n(t,[{key:"open",value:function e(){throw new o.PopupError("Unable to open a popup on this platform.")}},{key:"close",value:function e(){return this}}],[{key:"isSupported",value:function e(){return false}}]);return t}(i.EventEmitter)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Identity=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(7);var o=r(1);function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=t.Identity=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};u(this,e);this.client=t.client||i.Client.sharedInstance()}n(e,[{key:"isSupported",value:function e(){return false}},{key:"isOnline",value:function e(t){var r=(new Date).getTime()/1e3;return t&&t.access_token&&t.expires>r}},{key:"identity",get:function e(){throw new o.KinveyError("A subclass must override this property.")}}],[{key:"isSupported",value:function e(){return false}},{key:"identity",get:function e(){throw new o.KinveyError("A subclass must override this property.")}}]);return e}()},function(e,t){e.exports=require("platform")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.User=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=S(i);var u=r(12);var a=S(u);var s=r(10);var c=S(s);var f=r(11);var l=S(f);var h=r(26);var d=S(h);var p=r(20);var v=S(p);var y=r(7);var b=r(9);var _=r(1);var g=r(31);var m=r(96);var w=r(22);var O=r(3);var k=r(164);var P=r(165);var E=r(92);var j=r(411);function S(e){return e&&e.__esModule?e:{default:e}}function C(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var M=t.User=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};C(this,e);this.data=t;this.client=r.client||y.Client.sharedInstance()}n(e,[{key:"isActive",value:function t(){var r=e.getActiveUser(this.client);if((0,O.isDefined)(r)&&r._id===this._id){return true}return false}},{key:"isEmailVerified",value:function e(){var t=this.metadata.emailVerification;return t==="confirmed"}},{key:"login",value:function t(r,n){var i=this;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=r;var c=this.isActive();var f=e.getActiveUser(this.client);if(c===true){return o.default.reject(new _.ActiveUserError("This user is already the active user."))}if((0,O.isDefined)(f)){return o.default.reject(new _.ActiveUserError("An active user already exists. Please logout the active user before you login."))}if((0,l.default)(s)){u=n||{}}else{s={username:r,password:n}}if((0,O.isDefined)(s.username)){s.username=String(s.username).trim()}if((0,O.isDefined)(s.password)){s.password=String(s.password).trim()}if((!(0,O.isDefined)(s.username)||s.username===""||!(0,O.isDefined)(s.password)||s.password==="")&&!(0,O.isDefined)(s._socialIdentity)){return o.default.reject(new _.KinveyError("Username and/or password missing. Please provide both a username and password to login."))}var h=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/login"}),body:s,properties:u.properties,timeout:u.timeout,client:this.client});return h.execute().then(function(e){return e.data}).then(function(e){if((0,O.isDefined)(s._socialIdentity)&&(0,O.isDefined)(e._socialIdentity)){var t=Object.keys(e._socialIdentity);t.forEach(function(t){e._socialIdentity[t]=(0,a.default)({},s._socialIdentity[t],e._socialIdentity[t])});e._socialIdentity=(0,a.default)({},s._socialIdentity,e._socialIdentity)}delete e.password;return i.client.setActiveUser(e)}).then(function(e){i.data=e;return i})}},{key:"loginWithMIC",value:function t(r,n){var i=this;var u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var a=this.isActive();var s=e.getActiveUser(this.client);if(a){return o.default.reject(new _.ActiveUserError("This user is already the active user."))}if((0,O.isDefined)(s)){return o.default.reject(new _.ActiveUserError("An active user already exists. Please logout the active user before you login."))}var c=new m.MobileIdentityConnect({client:this.client});return c.login(r,n,u).then(function(e){return i.connectIdentity(m.MobileIdentityConnect.identity,e,u)})}},{key:"connectIdentity",value:function e(t,r){var n=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var o=this.isActive();var u={};var a=u._socialIdentity||{};a[t]=r;u._socialIdentity=a;if(o){return this.update(u,i)}return this.login(u,i).catch(function(e){if(e instanceof _.NotFoundError){return n.signup(u,i).then(function(){return n.connectIdentity(t,r,i)})}throw e})}},{key:"disconnectIdentity",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=o.default.resolve();if(t===m.MobileIdentityConnect.identity){i=m.MobileIdentityConnect.logout(this,n)}return i.catch(function(e){w.Log.error(e)}).then(function(){var e=r.data;var i=e._socialIdentity||{};delete i[t];e._socialIdentity=i;r.data=e;if(!r._id){return r}return r.update(e,n)}).then(function(){return r})}},{key:"logout",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.Session,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_logout"}),properties:r.properties,timeout:r.timeout,client:this.client});return this.unregisterFromLiveService().then(function(){return n.execute()}).catch(function(e){w.Log.error(e);return null}).then(function(){return t.client.setActiveUser(null)}).catch(function(e){w.Log.error(e);return null}).then(function(){return g.DataStore.clearCache({client:t.client})}).catch(function(e){w.Log.error(e);return null}).then(function(){return t})}},{key:"signup",value:function t(r){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var o=e.getActiveUser(this.client);i=(0,a.default)({state:true},i);if(i.state===true&&(0,O.isDefined)(o)){throw new _.ActiveUserError("An active user already exists. Please logout the active user before you login.")}if(r instanceof e){r=r.data}r=(0,a.default)(this.data,r);var u=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname}),body:(0,d.default)(r)?null:r,properties:i.properties,timeout:i.timeout,client:this.client});return u.execute().then(function(e){return e.data}).then(function(e){if(i.state===true){return n.client.setActiveUser(e)}return e}).then(function(e){n.data=e;return n})}},{key:"signupWithIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i={};i._socialIdentity={};i._socialIdentity[t]=r;return this.signup(i,n)}},{key:"update",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t=(0,a.default)(this.data,t);var i=new j.UserStore;return i.update(t,n).then(function(e){if(r.isActive()){return r.client.setActiveUser(e)}return e}).then(function(e){r.data=e;return r})}},{key:"me",value:function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=new b.KinveyRequest({method:b.RequestMethod.GET,authType:b.AuthType.Session,url:v.default.format({protocol:this.client.apiProtocol,host:this.client.apiHost,pathname:this.pathname+"/_me"}),properties:r.properties,timeout:r.timeout});return n.execute().then(function(e){return e.data}).then(function(e){e=(0,a.default)(t.data,e);delete e.password;if(t.isActive()){return t.client.setActiveUser(e)}return e}).then(function(e){t.data=e;return t})}},{key:"registerForLiveService",value:function e(){var t=(0,E.getLiveService)(this.client);var r=o.default.resolve();if(!t.isInitialized()){r=t.fullInitialization(this)}return r}},{key:"unregisterFromLiveService",value:function e(){var t=(0,E.getLiveService)(this.client);var r=o.default.resolve();if(t.isInitialized()){r=t.fullUninitialization()}return r}},{key:"_id",get:function e(){return this.data._id}},{key:"_acl",get:function e(){return new k.Acl(this.data)}},{key:"metadata",get:function e(){return new P.Metadata(this.data)}},{key:"_kmd",get:function e(){return this.metadata}},{key:"_socialIdentity",get:function e(){return this.data._socialIdentity}},{key:"authtoken",get:function e(){return this.metadata.authtoken}},{key:"username",get:function e(){return this.data.username}},{key:"email",get:function e(){return this.data.email}},{key:"pathname",get:function e(){return"/user/"+this.client.appKey}}],[{key:"login",value:function t(r,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var o=new e({},i);return o.login(r,n,i)}},{key:"loginWithMIC",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.loginWithMIC(t,r,n)}},{key:"connectIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.connectIdentity(t,r,n)}},{key:"logout",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=e.getActiveUser(r.client);if((0,O.isDefined)(n)){return n.logout(r)}return o.default.resolve(null)}},{key:"signup",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new this({},r);return n.signup(t,r)}},{key:"signupWithIdentity",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var i=new this({},n);return i.signupWithIdentity(t,r,n)}},{key:"update",value:function t(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=e.getActiveUser(n.client);if((0,O.isDefined)(i)){return i.update(r,n)}return o.default.resolve(null)}},{key:"registerForLiveService",value:function t(){var r=e.getActiveUser();if(r){return r.registerForLiveService()}return o.default.reject(new _.ActiveUserError("There is no active user"))}},{key:"unregisterFromLiveService",value:function t(){var r=e.getActiveUser();if(r){return r.unregisterFromLiveService()}return o.default.reject(new _.ActiveUserError("There is no active user"))}},{key:"me",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=e.getActiveUser(r.client);if(n){return n.me(r)}return o.default.resolve(null)}},{key:"getActiveUser",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:y.Client.sharedInstance();var r=t.getActiveUser();if((0,O.isDefined)(r)){return new this(r,{client:t})}return null}},{key:"verifyEmail",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new _.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."))}if(!(0,c.default)(t)){return o.default.reject(new _.KinveyError("The provided username is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+t+"/user-email-verification-initiate"}),properties:r.properties,timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"forgotUsername",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new _.KinveyError("An email was not provided.","Please provide an email for the user that you would like to retrieve their username."))}if(!(0,c.default)(t)){return o.default.reject(new _.KinveyError("The provided email is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/user-forgot-username"}),properties:r.properties,data:{email:t},timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"resetPassword",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new _.KinveyError("A username was not provided.","Please provide a username for the user that you would like to verify their email."))}if(!(0,c.default)(t)){return o.default.reject(new _.KinveyError("The provided username is not a string."))}var n=r.client||y.Client.sharedInstance();var i=new b.KinveyRequest({method:b.RequestMethod.POST,authType:b.AuthType.App,url:v.default.format({protocol:n.apiProtocol,host:n.apiHost,pathname:"/rpc/"+n.appKey+"/"+t+"/user-password-reset-initiate"}),properties:r.properties,timeout:r.timeout,client:n});return i.execute().then(function(e){return e.data})}},{key:"lookup",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.lookup(t,r)}},{key:"exists",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.exists(t,r)}},{key:"remove",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new j.UserStore;return n.removeById(t,r)}},{key:"restore",value:function e(){return o.default.reject(new _.KinveyError("This function requires a master secret to be provided for your application."+" We strongly advise not to do this."))}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.UserStore=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(2);var o=_(i);var u=r(6);var a=_(u);var s=r(10);var c=_(s);var f=r(20);var l=_(f);var h=r(7);var d=r(9);var p=r(1);var v=r(62);var y=r(3);var b=r(15);function _(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var m=t.UserStore=function(){function e(){g(this,e);this._client=h.Client.sharedInstance()}n(e,[{key:"lookup",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if((0,y.isDefined)(t)&&!(t instanceof b.Query)){var n="Invalid query. It must be an instance of the Query class.";return(0,v.wrapInObservable)(o.default.reject(new p.KinveyError(n)))}var i=new d.KinveyRequest({method:d.RequestMethod.POST,authType:d.AuthType.Default,url:l.default.format({protocol:this._client.apiProtocol,host:this._client.apiHost,pathname:this.pathname+"/_lookup"}),properties:r.properties,body:(0,y.isDefined)(t)?t.toPlainObject().filter:null,timeout:r.timeout,client:this._client});var u=i.execute().then(function(e){return e.data});return(0,v.wrapInObservable)(u)}},{key:"create",value:function e(){return o.default.reject(new p.KinveyError("Please use `User.signup()` to create a user."))}},{key:"update",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!t){return o.default.reject(new p.KinveyError("No user was provided to be updated."))}if((0,a.default)(t)){return o.default.reject(new p.KinveyError("Only one user can be updated at one time.",t))}if(!t._id){return o.default.reject(new p.KinveyError("User must have an _id."))}if((0,y.isDefined)(t)===false){return o.default.resolve(null)}var n=new d.KinveyRequest({method:d.RequestMethod.PUT,authType:d.AuthType.Default,url:l.default.format({protocol:this._client.apiProtocol,host:this._client.apiHost,pathname:this.pathname+"/"+t._id}),properties:r.properties,data:t,timeout:r.timeout,client:this._client});return n.execute().then(function(e){return e.data})}},{key:"exists",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=new d.KinveyRequest({method:d.RequestMethod.POST,authType:d.AuthType.App,url:l.default.format({protocol:this._client.apiProtocol,host:this._client.apiHost,pathname:"/rpc/"+this._client.appKey+"/check-username-exists"}),properties:r.properties,data:{username:t},timeout:r.timeout,client:this._client});return n.execute().then(function(e){return e.data}).then(function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return e.usernameExists===true})}},{key:"removeById",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=v.KinveyObservable.create(function(e){if((0,y.isDefined)(t)===false){return e.error(new p.KinveyError("An id was not provided.","Please provide a valid id for a user that you would like to remove."))}if((0,c.default)(t)===false){return e.error(new p.KinveyError("The id provided is not a string.","Please provide a valid id for a user that you would like to remove."))}var i=new d.KinveyRequest({method:d.RequestMethod.DELETE,authType:d.AuthType.Default,url:l.default.format({protocol:r._client.apiProtocol,host:r._client.apiHost,pathname:r.pathname+"/"+t,query:n.hard===true?{hard:true}:undefined}),properties:n.properties,timeout:n.timeout});return i.execute().then(function(e){return e.data}).then(function(t){return e.next(t)}).then(function(){return e.complete()}).catch(function(t){return e.error(t)})});return i.toPromise()}},{key:"pathname",get:function e(){return"/user/"+this._client.appKey}}]);return e}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(493);t.Push=n.Push},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=r(3);var o=r(1);var u=r(494);var a;try{a=r(495)}catch(e){}var s=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype._registerWithPushPlugin=function(e){var t=this;if(e===void 0){e={}}var r=e.android||{};return new n.Promise(function(e,n){if(i.isDefined(a)===false){return n(new o.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with"+" setting up your project."))}var u=r.notificationCallbackAndroid;r.notificationCallbackAndroid=function(e,r){if(typeof u==="function"){u(e,r)}t.emit("notification",JSON.parse(e))};a.register(r,e,n)})};t.prototype._unregisterWithPushPlugin=function(e){if(e===void 0){e={}}var t=e.android||{};return new n.Promise(function(e,r){if(i.isDefined(a)===false){return r(new o.KinveyError("NativeScript Push Plugin is not installed.","Please refer to http://devcenter.kinvey.com/nativescript/guides/push#ProjectSetUp for help with"+" setting up your project."))}a.unregister(e,r,t)})};return t}(u.PushCommon);var c=new s;t.Push=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(2);var i=r(83);var o=r(409);var u=r(7);var a=r(1);var s=r(3);var c=r(163);var f=r(9);var l=r(31);var h="__device";var d=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"client",{get:function(){if(s.isDefined(this._client)===false){return u.Client.sharedInstance()}return this._client},set:function(e){if(s.isDefined(e)&&e instanceof u.Client===false){throw new Error("client must be an instance of Client.")}this._client=e},enumerable:true,configurable:true});t.prototype.onNotification=function(e){return this.on("notification",e)};t.prototype.onceNotification=function(e){return this.once("notification",e)};t.prototype.register=function(e){var t=this;if(e===void 0){e={}}return this._registerWithPushPlugin(e).then(function(r){if(s.isDefined(r)===false){throw new a.KinveyError("Unable to retrieve the device token to register this device for push notifications.")}return t._registerWithKinvey(r,e)}).then(function(e){return t._saveTokenToCache(e)})};t.prototype.unregister=function(e){var t=this;if(e===void 0){e={}}return this._unregisterWithPushPlugin(e).then(function(){return t._getTokenFromCache()}).then(function(r){if(s.isDefined(r)===false){throw new a.KinveyError("Unable to retrieve the device token to unregister this device for push notifications.")}return t._unregisterWithKinvey(r,e)}).then(function(){return t._deleteTokenFromCache()})};t.prototype._registerWithPushPlugin=function(e){if(e===void 0){e={}}return n.Promise.reject(new a.KinveyError("Unable to register for push notifications."))};t.prototype._unregisterWithPushPlugin=function(e){if(e===void 0){e={}}return n.Promise.reject(new a.KinveyError("Unable to unregister for push notifications."))};t.prototype._registerWithKinvey=function(e,t){if(t===void 0){t={}}var r=c.User.getActiveUser(this.client);if(s.isDefined(r)===false){return n.Promise.reject(new a.KinveyError("Unable to register this device for push notifications.","You must login a user."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/register-device",authType:r?f.AuthType.Session:f.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client});return i.execute().then(function(){return e})};t.prototype._unregisterWithKinvey=function(e,t){if(t===void 0){t={}}var r=c.User.getActiveUser(this.client);if(s.isDefined(r)===false){return n.Promise.reject(new a.KinveyError("Unable to unregister this device for push notifications.","You must login a user."))}var i=new f.KinveyRequest({method:f.RequestMethod.POST,url:this.client.apiHostname+"/push/"+this.client.appKey+"/unregister-device",authType:s.isDefined(r)?f.AuthType.Session:f.AuthType.Master,data:{platform:o.device.os.toLowerCase(),framework:"nativescript",deviceId:e},timeout:t.timeout,client:this.client});return i.execute().then(function(e){return e.data})};t.prototype._getTokenFromCache=function(){var e=c.User.getActiveUser(this.client);if(s.isDefined(e)===false){throw new a.KinveyError("Unable to retrieve device token.","You must login a user.")}return this._getOfflineRepo().then(function(t){return t.readById(h,e._id)}).catch(function(e){if(e instanceof a.NotFoundError){return{}}throw e}).then(function(e){if(s.isDefined(e)){return e.token}return null})};t.prototype._saveTokenToCache=function(e){var t=c.User.getActiveUser(this.client);if(s.isDefined(t)===false){throw new a.KinveyError("Unable to save device token.","You must login a user.")}var r={_id:t._id,userId:t._id,token:e};return this._getOfflineRepo().then(function(e){return e.update(h,r)}).then(function(){return e})};t.prototype._deleteTokenFromCache=function(){var e=c.User.getActiveUser(this.client);if(s.isDefined(e)===false){throw new a.KinveyError("Unable to delete device token.","You must login a user.")}return this._getOfflineRepo().then(function(t){return t.deleteById(h,e._id)}).then(function(){return null})};t.prototype._getOfflineRepo=function(){if(!this._offlineRepoPromise){this._offlineRepoPromise=l.repositoryProvider.getOfflineRepository()}return this._offlineRepoPromise};return t}(i.EventEmitter);t.PushCommon=d},function(e,t){e.exports=require("nativescript-push-notifications")}]);
//# sourceMappingURL=push.android.js.map